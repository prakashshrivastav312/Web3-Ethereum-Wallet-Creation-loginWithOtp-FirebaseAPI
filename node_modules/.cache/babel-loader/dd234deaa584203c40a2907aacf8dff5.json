{"ast":null,"code":"\"use strict\";\n\nvar __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  Object.defineProperty(o, k2, {\n    enumerable: true,\n    get: function () {\n      return m[k];\n    }\n  });\n} : function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\n\nvar __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {\n  Object.defineProperty(o, \"default\", {\n    enumerable: true,\n    value: v\n  });\n} : function (o, v) {\n  o[\"default\"] = v;\n});\n\nvar __importStar = this && this.__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (k !== \"default\" && Object.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n\n  __setModuleDefault(result, mod);\n\n  return result;\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nconst utils = __importStar(require(\"./utils\"));\n\nconst offerFlags = utils.common.txFlags.OfferCreate;\n\nconst common_1 = require(\"../common\");\n\nfunction createOrderTransaction(account, order) {\n  const takerPays = common_1.toRippledAmount(order.direction === 'buy' ? order.quantity : order.totalPrice);\n  const takerGets = common_1.toRippledAmount(order.direction === 'buy' ? order.totalPrice : order.quantity);\n  const txJSON = {\n    TransactionType: 'OfferCreate',\n    Account: account,\n    TakerGets: takerGets,\n    TakerPays: takerPays,\n    Flags: 0\n  };\n\n  if (order.direction === 'sell') {\n    txJSON.Flags |= offerFlags.Sell;\n  }\n\n  if (order.passive === true) {\n    txJSON.Flags |= offerFlags.Passive;\n  }\n\n  if (order.immediateOrCancel === true) {\n    txJSON.Flags |= offerFlags.ImmediateOrCancel;\n  }\n\n  if (order.fillOrKill === true) {\n    txJSON.Flags |= offerFlags.FillOrKill;\n  }\n\n  if (order.expirationTime != null) {\n    txJSON.Expiration = common_1.iso8601ToRippleTime(order.expirationTime);\n  }\n\n  if (order.orderToReplace != null) {\n    txJSON.OfferSequence = order.orderToReplace;\n  }\n\n  if (order.memos != null) {\n    txJSON.Memos = order.memos.map(utils.convertMemo);\n  }\n\n  return txJSON;\n}\n\nfunction prepareOrder(address, order) {\n  let instructions = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n  try {\n    common_1.validate.prepareOrder({\n      address,\n      order,\n      instructions\n    });\n    const txJSON = createOrderTransaction(address, order);\n    return utils.prepareTransaction(txJSON, this, instructions);\n  } catch (e) {\n    return Promise.reject(e);\n  }\n}\n\nexports.default = prepareOrder;","map":{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;AACA,MAAMA,UAAU,GAAGC,KAAK,CAACC,MAAN,CAAaC,OAAb,CAAqBC,WAAxC;;AACA;;AAKA,SAASC,sBAAT,CACEC,OADF,EAEEC,KAFF,EAEoC;EAElC,MAAMC,SAAS,GAAGC,yBAChBF,KAAK,CAACG,SAAN,KAAoB,KAApB,GAA4BH,KAAK,CAACI,QAAlC,GAA6CJ,KAAK,CAACK,UADnC,CAAlB;EAGA,MAAMC,SAAS,GAAGJ,yBAChBF,KAAK,CAACG,SAAN,KAAoB,KAApB,GAA4BH,KAAK,CAACK,UAAlC,GAA+CL,KAAK,CAACI,QADrC,CAAlB;EAIA,MAAMG,MAAM,GAAoC;IAC9CC,eAAe,EAAE,aAD6B;IAE9CC,OAAO,EAAEV,OAFqC;IAG9CW,SAAS,EAAEJ,SAHmC;IAI9CK,SAAS,EAAEV,SAJmC;IAK9CW,KAAK,EAAE;EALuC,CAAhD;;EAOA,IAAIZ,KAAK,CAACG,SAAN,KAAoB,MAAxB,EAAgC;IAC9BI,MAAM,CAACK,KAAP,IAAgBnB,UAAU,CAACoB,IAA3B;EACD;;EACD,IAAIb,KAAK,CAACc,OAAN,KAAkB,IAAtB,EAA4B;IAC1BP,MAAM,CAACK,KAAP,IAAgBnB,UAAU,CAACsB,OAA3B;EACD;;EACD,IAAIf,KAAK,CAACgB,iBAAN,KAA4B,IAAhC,EAAsC;IACpCT,MAAM,CAACK,KAAP,IAAgBnB,UAAU,CAACwB,iBAA3B;EACD;;EACD,IAAIjB,KAAK,CAACkB,UAAN,KAAqB,IAAzB,EAA+B;IAC7BX,MAAM,CAACK,KAAP,IAAgBnB,UAAU,CAAC0B,UAA3B;EACD;;EACD,IAAInB,KAAK,CAACoB,cAAN,IAAwB,IAA5B,EAAkC;IAChCb,MAAM,CAACc,UAAP,GAAoBnB,6BAAoBF,KAAK,CAACoB,cAA1B,CAApB;EACD;;EACD,IAAIpB,KAAK,CAACsB,cAAN,IAAwB,IAA5B,EAAkC;IAChCf,MAAM,CAACgB,aAAP,GAAuBvB,KAAK,CAACsB,cAA7B;EACD;;EACD,IAAItB,KAAK,CAACwB,KAAN,IAAe,IAAnB,EAAyB;IACvBjB,MAAM,CAACkB,KAAP,GAAezB,KAAK,CAACwB,KAAN,CAAYE,GAAZ,CAAgBhC,KAAK,CAACiC,WAAtB,CAAf;EACD;;EACD,OAAOpB,MAAP;AACD;;AAED,SAASqB,YAAT,CAEEC,OAFF,EAGE7B,KAHF,EAIiC;EAAA,IAA/B8B,YAA+B,uEAAF,EAAE;;EAE/B,IAAI;IACF5B,kBAAS0B,YAAT,CAAsB;MAACC,OAAD;MAAU7B,KAAV;MAAiB8B;IAAjB,CAAtB;IACA,MAAMvB,MAAM,GAAGT,sBAAsB,CAAC+B,OAAD,EAAU7B,KAAV,CAArC;IACA,OAAON,KAAK,CAACqC,kBAAN,CAAyBxB,MAAzB,EAAiC,IAAjC,EAAuCuB,YAAvC,CAAP;EACD,CAJD,CAIE,OAAOE,CAAP,EAAU;IACV,OAAOC,OAAO,CAACC,MAAR,CAAeF,CAAf,CAAP;EACD;AACF;;AAEDG,kBAAeP,YAAf","names":["offerFlags","utils","common","txFlags","OfferCreate","createOrderTransaction","account","order","takerPays","common_1","direction","quantity","totalPrice","takerGets","txJSON","TransactionType","Account","TakerGets","TakerPays","Flags","Sell","passive","Passive","immediateOrCancel","ImmediateOrCancel","fillOrKill","FillOrKill","expirationTime","Expiration","orderToReplace","OfferSequence","memos","Memos","map","convertMemo","prepareOrder","address","instructions","prepareTransaction","e","Promise","reject","exports"],"sourceRoot":"","sources":["../../../src/transaction/order.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}