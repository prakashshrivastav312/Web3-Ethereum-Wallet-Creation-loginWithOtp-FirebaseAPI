{"ast":null,"code":"\"use strict\";\n\nvar __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  Object.defineProperty(o, k2, {\n    enumerable: true,\n    get: function () {\n      return m[k];\n    }\n  });\n} : function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\n\nvar __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {\n  Object.defineProperty(o, \"default\", {\n    enumerable: true,\n    value: v\n  });\n} : function (o, v) {\n  o[\"default\"] = v;\n});\n\nvar __importStar = this && this.__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (k !== \"default\" && Object.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n\n  __setModuleDefault(result, mod);\n\n  return result;\n};\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.parseOrderbookOrder = void 0;\n\nconst _ = __importStar(require(\"lodash\"));\n\nconst utils_1 = require(\"./utils\");\n\nconst common_1 = require(\"../../common\");\n\nconst flags_1 = require(\"./flags\");\n\nconst amount_1 = __importDefault(require(\"./amount\"));\n\nfunction parseOrderbookOrder(data) {\n  const direction = (data.Flags & flags_1.orderFlags.Sell) === 0 ? 'buy' : 'sell';\n  const takerGetsAmount = amount_1.default(data.TakerGets);\n  const takerPaysAmount = amount_1.default(data.TakerPays);\n  const quantity = direction === 'buy' ? takerPaysAmount : takerGetsAmount;\n  const totalPrice = direction === 'buy' ? takerGetsAmount : takerPaysAmount;\n  const specification = common_1.removeUndefined({\n    direction: direction,\n    quantity: quantity,\n    totalPrice: totalPrice,\n    passive: (data.Flags & flags_1.orderFlags.Passive) !== 0 || undefined,\n    expirationTime: utils_1.parseTimestamp(data.Expiration)\n  });\n  const properties = {\n    maker: data.Account,\n    sequence: data.Sequence,\n    makerExchangeRate: utils_1.adjustQualityForXRP(data.quality, takerGetsAmount.currency, takerPaysAmount.currency)\n  };\n  const takerGetsFunded = data.taker_gets_funded ? amount_1.default(data.taker_gets_funded) : undefined;\n  const takerPaysFunded = data.taker_pays_funded ? amount_1.default(data.taker_pays_funded) : undefined;\n  const available = common_1.removeUndefined({\n    fundedAmount: takerGetsFunded,\n    priceOfFundedAmount: takerPaysFunded\n  });\n  const state = _.isEmpty(available) ? undefined : available;\n  return common_1.removeUndefined({\n    specification,\n    properties,\n    state,\n    data\n  });\n}\n\nexports.parseOrderbookOrder = parseOrderbookOrder;","map":{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;AACA;;AACA;;AAEA;;AACA;;AAkBA,SAAgBA,mBAAhB,CAAoCC,IAApC,EAAmD;EACjD,MAAMC,SAAS,GAAG,CAACD,IAAI,CAACE,KAAL,GAAaC,mBAAWC,IAAzB,MAAmC,CAAnC,GAAuC,KAAvC,GAA+C,MAAjE;EACA,MAAMC,eAAe,GAAGC,iBAAYN,IAAI,CAACO,SAAjB,CAAxB;EACA,MAAMC,eAAe,GAAGF,iBAAYN,IAAI,CAACS,SAAjB,CAAxB;EACA,MAAMC,QAAQ,GAAGT,SAAS,KAAK,KAAd,GAAsBO,eAAtB,GAAwCH,eAAzD;EACA,MAAMM,UAAU,GAAGV,SAAS,KAAK,KAAd,GAAsBI,eAAtB,GAAwCG,eAA3D;EAIA,MAAMI,aAAa,GAAgCC,yBAAgB;IACjEZ,SAAS,EAAEA,SADsD;IAEjES,QAAQ,EAAEA,QAFuD;IAGjEC,UAAU,EAAEA,UAHqD;IAIjEG,OAAO,EAAE,CAACd,IAAI,CAACE,KAAL,GAAaC,mBAAWY,OAAzB,MAAsC,CAAtC,IAA2CC,SAJa;IAKjEC,cAAc,EAAEC,uBAAelB,IAAI,CAACmB,UAApB;EALiD,CAAhB,CAAnD;EAQA,MAAMC,UAAU,GAAG;IACjBC,KAAK,EAAErB,IAAI,CAACsB,OADK;IAEjBC,QAAQ,EAAEvB,IAAI,CAACwB,QAFE;IAGjBC,iBAAiB,EAAEP,4BACjBlB,IAAI,CAAC0B,OADY,EAEjBrB,eAAe,CAACsB,QAFC,EAGjBnB,eAAe,CAACmB,QAHC;EAHF,CAAnB;EAUA,MAAMC,eAAe,GAAG5B,IAAI,CAAC6B,iBAAL,GACpBvB,iBAAYN,IAAI,CAAC6B,iBAAjB,CADoB,GAEpBb,SAFJ;EAGA,MAAMc,eAAe,GAAG9B,IAAI,CAAC+B,iBAAL,GACpBzB,iBAAYN,IAAI,CAAC+B,iBAAjB,CADoB,GAEpBf,SAFJ;EAGA,MAAMgB,SAAS,GAAGnB,yBAAgB;IAChCoB,YAAY,EAAEL,eADkB;IAEhCM,mBAAmB,EAAEJ;EAFW,CAAhB,CAAlB;EAIA,MAAMK,KAAK,GAAGC,CAAC,CAACC,OAAF,CAAUL,SAAV,IAAuBhB,SAAvB,GAAmCgB,SAAjD;EACA,OAAOnB,yBAAgB;IAACD,aAAD;IAAgBQ,UAAhB;IAA4Be,KAA5B;IAAmCnC;EAAnC,CAAhB,CAAP;AACD;;AAvCDsC","names":["parseOrderbookOrder","data","direction","Flags","flags_1","Sell","takerGetsAmount","amount_1","TakerGets","takerPaysAmount","TakerPays","quantity","totalPrice","specification","common_1","passive","Passive","undefined","expirationTime","utils_1","Expiration","properties","maker","Account","sequence","Sequence","makerExchangeRate","quality","currency","takerGetsFunded","taker_gets_funded","takerPaysFunded","taker_pays_funded","available","fundedAmount","priceOfFundedAmount","state","_","isEmpty","exports"],"sourceRoot":"","sources":["../../../../src/ledger/parse/orderbook-order.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}