{"ast":null,"code":"/*\n    Copyright 2021 The caver-js Authors\n    This file is part of the caver-js library.\n\n    The caver-js library is free software: you can redistribute it and/or modify\n    it under the terms of the GNU Lesser General Public License as published by\n    the Free Software Foundation, either version 3 of the License, or\n    (at your option) any later version.\n\n    The caver-js library is distributed in the hope that it will be useful,\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\n    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n    GNU Lesser General Public License for more details.\n\n    You should have received a copy of the GNU Lesser General Public License\n    along with the caver-js. If not, see <http://www.gnu.org/licenses/>.\n*/\nconst _ = require('lodash');\n\nconst Contract = require('../../caver-contract');\n\nconst {\n  kip13JsonInterface,\n  interfaceIds\n} = require('./kctHelper');\n\nconst {\n  isAddress\n} = require('../../caver-utils');\n/**\n * The KIP13 class allows you to easily check whether a SmartContract implements the KIP-13 standard.\n * It also provides the ability to query whether an interface id is implemented as a parameter.\n *\n * @class\n */\n\n\nclass KIP13 extends Contract {\n  /**\n   * Checks if the contract implements the KIP-13 standard.\n   *\n   * @example\n   * const isImplemented = await caver.kct.kip13.isImplementedKIP13Interface('0x{address in hex}')\n   *\n   * @param {string} contractAddress The address of the contract to check.\n   * @return {Promise<boolean>}\n   */\n  static async isImplementedKIP13Interface(contractAddress) {\n    const kip13 = new KIP13(contractAddress);\n    const isTrue = await kip13.sendQuery(interfaceIds.preCondition.true);\n    const isFalse = await kip13.sendQuery(interfaceIds.preCondition.false);\n    return isTrue && !isFalse;\n  }\n  /**\n   * KIP13 class represents the KIP-13 contract.\n   *\n   * @example\n   * const kip13 = new caver.kct.kip13('0x{address in hex}')\n   *\n   * @constructor\n   * @param {string} [contractAddress] - The smart contract address.\n   * @param {Array} [abi] - The Contract Application Binary Interface (ABI) of the KIP-13.\n   */\n\n\n  constructor(contractAddress) {\n    let abi = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : kip13JsonInterface;\n\n    if (contractAddress) {\n      if (_.isString(contractAddress)) {\n        if (!isAddress(contractAddress)) throw new Error(`Invalid contract address ${contractAddress}`);\n      } else {\n        abi = contractAddress;\n        contractAddress = undefined;\n      }\n    }\n\n    super(abi, contractAddress);\n  }\n  /**\n   * Sends query to check whether the interface is supported or not.\n   * Using `supportsInterface` method supported in the each KCT class is recommended to use instead of the `kip13.sendQuery`.\n   *\n   * @example\n   * const isImplemented = await kip13.sendQuery('0x{interface id}')\n   *\n   * @param {string} interfaceId The interface id to check.\n   * @return {Promise<boolean>}\n   */\n\n\n  async sendQuery(interfaceId) {\n    const supported = await this.methods.supportsInterface(interfaceId).call();\n    return supported;\n  }\n\n}\n\nmodule.exports = KIP13;","map":{"version":3,"names":["_","require","Contract","kip13JsonInterface","interfaceIds","isAddress","KIP13","isImplementedKIP13Interface","contractAddress","kip13","isTrue","sendQuery","preCondition","true","isFalse","false","constructor","abi","isString","Error","undefined","interfaceId","supported","methods","supportsInterface","call","module","exports"],"sources":["C:/Users/acer/node_modules/caver-js/packages/caver-kct/src/kip13.js"],"sourcesContent":["/*\n    Copyright 2021 The caver-js Authors\n    This file is part of the caver-js library.\n\n    The caver-js library is free software: you can redistribute it and/or modify\n    it under the terms of the GNU Lesser General Public License as published by\n    the Free Software Foundation, either version 3 of the License, or\n    (at your option) any later version.\n\n    The caver-js library is distributed in the hope that it will be useful,\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\n    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n    GNU Lesser General Public License for more details.\n\n    You should have received a copy of the GNU Lesser General Public License\n    along with the caver-js. If not, see <http://www.gnu.org/licenses/>.\n*/\n\nconst _ = require('lodash')\n\nconst Contract = require('../../caver-contract')\nconst { kip13JsonInterface, interfaceIds } = require('./kctHelper')\nconst { isAddress } = require('../../caver-utils')\n\n/**\n * The KIP13 class allows you to easily check whether a SmartContract implements the KIP-13 standard.\n * It also provides the ability to query whether an interface id is implemented as a parameter.\n *\n * @class\n */\nclass KIP13 extends Contract {\n    /**\n     * Checks if the contract implements the KIP-13 standard.\n     *\n     * @example\n     * const isImplemented = await caver.kct.kip13.isImplementedKIP13Interface('0x{address in hex}')\n     *\n     * @param {string} contractAddress The address of the contract to check.\n     * @return {Promise<boolean>}\n     */\n    static async isImplementedKIP13Interface(contractAddress) {\n        const kip13 = new KIP13(contractAddress)\n        const isTrue = await kip13.sendQuery(interfaceIds.preCondition.true)\n        const isFalse = await kip13.sendQuery(interfaceIds.preCondition.false)\n        return isTrue && !isFalse\n    }\n\n    /**\n     * KIP13 class represents the KIP-13 contract.\n     *\n     * @example\n     * const kip13 = new caver.kct.kip13('0x{address in hex}')\n     *\n     * @constructor\n     * @param {string} [contractAddress] - The smart contract address.\n     * @param {Array} [abi] - The Contract Application Binary Interface (ABI) of the KIP-13.\n     */\n    constructor(contractAddress, abi = kip13JsonInterface) {\n        if (contractAddress) {\n            if (_.isString(contractAddress)) {\n                if (!isAddress(contractAddress)) throw new Error(`Invalid contract address ${contractAddress}`)\n            } else {\n                abi = contractAddress\n                contractAddress = undefined\n            }\n        }\n\n        super(abi, contractAddress)\n    }\n\n    /**\n     * Sends query to check whether the interface is supported or not.\n     * Using `supportsInterface` method supported in the each KCT class is recommended to use instead of the `kip13.sendQuery`.\n     *\n     * @example\n     * const isImplemented = await kip13.sendQuery('0x{interface id}')\n     *\n     * @param {string} interfaceId The interface id to check.\n     * @return {Promise<boolean>}\n     */\n    async sendQuery(interfaceId) {\n        const supported = await this.methods.supportsInterface(interfaceId).call()\n        return supported\n    }\n}\n\nmodule.exports = KIP13\n"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA,MAAMA,CAAC,GAAGC,OAAO,CAAC,QAAD,CAAjB;;AAEA,MAAMC,QAAQ,GAAGD,OAAO,CAAC,sBAAD,CAAxB;;AACA,MAAM;EAAEE,kBAAF;EAAsBC;AAAtB,IAAuCH,OAAO,CAAC,aAAD,CAApD;;AACA,MAAM;EAAEI;AAAF,IAAgBJ,OAAO,CAAC,mBAAD,CAA7B;AAEA;AACA;AACA;AACA;AACA;AACA;;;AACA,MAAMK,KAAN,SAAoBJ,QAApB,CAA6B;EACzB;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EAC4C,aAA3BK,2BAA2B,CAACC,eAAD,EAAkB;IACtD,MAAMC,KAAK,GAAG,IAAIH,KAAJ,CAAUE,eAAV,CAAd;IACA,MAAME,MAAM,GAAG,MAAMD,KAAK,CAACE,SAAN,CAAgBP,YAAY,CAACQ,YAAb,CAA0BC,IAA1C,CAArB;IACA,MAAMC,OAAO,GAAG,MAAML,KAAK,CAACE,SAAN,CAAgBP,YAAY,CAACQ,YAAb,CAA0BG,KAA1C,CAAtB;IACA,OAAOL,MAAM,IAAI,CAACI,OAAlB;EACH;EAED;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;EACIE,WAAW,CAACR,eAAD,EAA4C;IAAA,IAA1BS,GAA0B,uEAApBd,kBAAoB;;IACnD,IAAIK,eAAJ,EAAqB;MACjB,IAAIR,CAAC,CAACkB,QAAF,CAAWV,eAAX,CAAJ,EAAiC;QAC7B,IAAI,CAACH,SAAS,CAACG,eAAD,CAAd,EAAiC,MAAM,IAAIW,KAAJ,CAAW,4BAA2BX,eAAgB,EAAtD,CAAN;MACpC,CAFD,MAEO;QACHS,GAAG,GAAGT,eAAN;QACAA,eAAe,GAAGY,SAAlB;MACH;IACJ;;IAED,MAAMH,GAAN,EAAWT,eAAX;EACH;EAED;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;EACmB,MAATG,SAAS,CAACU,WAAD,EAAc;IACzB,MAAMC,SAAS,GAAG,MAAM,KAAKC,OAAL,CAAaC,iBAAb,CAA+BH,WAA/B,EAA4CI,IAA5C,EAAxB;IACA,OAAOH,SAAP;EACH;;AArDwB;;AAwD7BI,MAAM,CAACC,OAAP,GAAiBrB,KAAjB"},"metadata":{},"sourceType":"script"}