{"ast":null,"code":"\"use strict\";\n/**\n * @packageDocumentation\n * @module harmony-crypto\n * @hidden\n */\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.decode = exports.encode = void 0; // this file is ported from https://github.com/ethers-io/ethers.js/blob/master/src.ts/utils/rlp.ts\n// and done some fixes\n\nvar bytes_1 = require(\"./bytes\");\n\nfunction arrayifyInteger(value) {\n  var result = [];\n\n  while (value) {\n    result.unshift(value & 0xff);\n    value >>= 8;\n  }\n\n  return result;\n}\n\nfunction unarrayifyInteger(data, offset, length) {\n  var result = 0;\n\n  for (var i = 0; i < length; i++) {\n    result = result * 256 + data[offset + i];\n  }\n\n  return result;\n}\n\nfunction _encode(object) {\n  if (Array.isArray(object)) {\n    var payload_1 = [];\n    object.forEach(function (child) {\n      payload_1 = payload_1.concat(_encode(child));\n    });\n\n    if (payload_1.length <= 55) {\n      payload_1.unshift(0xc0 + payload_1.length);\n      return payload_1;\n    } // tslint:disable-next-line: no-shadowed-variable\n\n\n    var length_1 = arrayifyInteger(payload_1.length);\n    length_1.unshift(0xf7 + length_1.length);\n    return length_1.concat(payload_1);\n  }\n\n  var data = Array.prototype.slice.call(bytes_1.arrayify(object));\n\n  if (data.length === 1 && data[0] <= 0x7f) {\n    return data;\n  } else if (data.length <= 55) {\n    data.unshift(0x80 + data.length);\n    return data;\n  }\n\n  var length = arrayifyInteger(data.length);\n  length.unshift(0xb7 + length.length);\n  return length.concat(data);\n}\n\nfunction encode(object) {\n  return bytes_1.hexlify(_encode(object));\n}\n\nexports.encode = encode;\n\nfunction _decodeChildren(data, offset, childOffset, length) {\n  var result = [];\n\n  while (childOffset < offset + 1 + length) {\n    var decoded = _decode(data, childOffset);\n\n    result.push(decoded.result);\n    childOffset += decoded.consumed;\n\n    if (childOffset > offset + 1 + length) {\n      throw new Error('invalid rlp');\n    }\n  }\n\n  return {\n    consumed: 1 + length,\n    result: result\n  };\n} // returns { consumed: number, result: Object }\n\n\nfunction _decode(data, offset) {\n  if (data.length === 0) {\n    throw new Error('invalid rlp data');\n  } // Array with extra length prefix\n\n\n  if (data[offset] >= 0xf8) {\n    var lengthLength = data[offset] - 0xf7;\n\n    if (offset + 1 + lengthLength > data.length) {\n      throw new Error('too short');\n    }\n\n    var length_2 = unarrayifyInteger(data, offset + 1, lengthLength);\n\n    if (offset + 1 + lengthLength + length_2 > data.length) {\n      throw new Error('to short');\n    }\n\n    return _decodeChildren(data, offset, offset + 1 + lengthLength, lengthLength + length_2);\n  } else if (data[offset] >= 0xc0) {\n    var length_3 = data[offset] - 0xc0;\n\n    if (offset + 1 + length_3 > data.length) {\n      throw new Error('invalid rlp data');\n    }\n\n    return _decodeChildren(data, offset, offset + 1, length_3);\n  } else if (data[offset] >= 0xb8) {\n    var lengthLength = data[offset] - 0xb7;\n\n    if (offset + 1 + lengthLength > data.length) {\n      throw new Error('invalid rlp data');\n    }\n\n    var length_4 = unarrayifyInteger(data, offset + 1, lengthLength);\n\n    if (offset + 1 + lengthLength + length_4 > data.length) {\n      throw new Error('invalid rlp data');\n    }\n\n    var result = bytes_1.hexlify(data.slice(offset + 1 + lengthLength, offset + 1 + lengthLength + length_4));\n    return {\n      consumed: 1 + lengthLength + length_4,\n      result: result\n    };\n  } else if (data[offset] >= 0x80) {\n    var length_5 = data[offset] - 0x80;\n\n    if (offset + 1 + length_5 > data.length) {\n      throw new Error('invlaid rlp data');\n    }\n\n    var result = bytes_1.hexlify(data.slice(offset + 1, offset + 1 + length_5));\n    return {\n      consumed: 1 + length_5,\n      result: result\n    };\n  }\n\n  return {\n    consumed: 1,\n    result: bytes_1.hexlify(data[offset])\n  };\n}\n\nfunction decode(data) {\n  var bytes = bytes_1.arrayify(data) || new Uint8Array();\n\n  var decoded = _decode(bytes, 0);\n\n  if (decoded.consumed !== bytes.length) {\n    throw new Error('invalid rlp data');\n  }\n\n  return decoded.result;\n}\n\nexports.decode = decode;","map":{"version":3,"mappings":"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","names":["arrayifyInteger","value","result","unshift","unarrayifyInteger","data","offset","length","i","_encode","object","Array","isArray","payload_1","forEach","child","concat","length_1","prototype","slice","call","bytes_1","encode","exports","_decodeChildren","childOffset","decoded","_decode","push","consumed","Error","lengthLength","length_2","length_3","length_4","length_5","decode","bytes","Uint8Array"],"sourceRoot":"","sources":["../src/rlp.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}