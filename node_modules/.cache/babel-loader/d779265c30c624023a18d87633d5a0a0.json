{"ast":null,"code":"var parse = require('url').parse;\n\nvar events = require('events');\n\nvar https = require('https');\n\nvar http = require('http');\n\nvar util = require('util');\n\nvar httpsOptions = ['pfx', 'key', 'passphrase', 'cert', 'ca', 'ciphers', 'rejectUnauthorized', 'secureProtocol', 'servername', 'checkServerIdentity'];\nvar bom = [239, 187, 191];\nvar colon = 58;\nvar space = 32;\nvar lineFeed = 10;\nvar carriageReturn = 13;\n\nfunction hasBom(buf) {\n  return bom.every(function (charCode, index) {\n    return buf[index] === charCode;\n  });\n}\n/**\n * Creates a new EventSource object\n *\n * @param {String} url the URL to which to connect\n * @param {Object} [eventSourceInitDict] extra init params. See README for details.\n * @api public\n **/\n\n\nfunction EventSource(url, eventSourceInitDict) {\n  var readyState = EventSource.CONNECTING;\n  var headers = eventSourceInitDict && eventSourceInitDict.headers;\n  var hasNewOrigin = false;\n  Object.defineProperty(this, 'readyState', {\n    get: function () {\n      return readyState;\n    }\n  });\n  Object.defineProperty(this, 'url', {\n    get: function () {\n      return url;\n    }\n  });\n  var self = this;\n  self.reconnectInterval = 1000;\n  self.connectionInProgress = false;\n\n  function onConnectionClosed(message) {\n    if (readyState === EventSource.CLOSED) return;\n    readyState = EventSource.CONNECTING;\n\n    _emit('error', new Event('error', {\n      message: message\n    })); // The url may have been changed by a temporary redirect. If that's the case,\n    // revert it now, and flag that we are no longer pointing to a new origin\n\n\n    if (reconnectUrl) {\n      url = reconnectUrl;\n      reconnectUrl = null;\n      hasNewOrigin = false;\n    }\n\n    setTimeout(function () {\n      if (readyState !== EventSource.CONNECTING || self.connectionInProgress) {\n        return;\n      }\n\n      self.connectionInProgress = true;\n      connect();\n    }, self.reconnectInterval);\n  }\n\n  var req;\n  var lastEventId = '';\n\n  if (headers && headers['Last-Event-ID']) {\n    lastEventId = headers['Last-Event-ID'];\n    delete headers['Last-Event-ID'];\n  }\n\n  var discardTrailingNewline = false;\n  var data = '';\n  var eventName = '';\n  var reconnectUrl = null;\n\n  function connect() {\n    var options = parse(url);\n    var isSecure = options.protocol === 'https:';\n    options.headers = {\n      'Cache-Control': 'no-cache',\n      'Accept': 'text/event-stream'\n    };\n    if (lastEventId) options.headers['Last-Event-ID'] = lastEventId;\n\n    if (headers) {\n      var reqHeaders = hasNewOrigin ? removeUnsafeHeaders(headers) : headers;\n\n      for (var i in reqHeaders) {\n        var header = reqHeaders[i];\n\n        if (header) {\n          options.headers[i] = header;\n        }\n      }\n    } // Legacy: this should be specified as `eventSourceInitDict.https.rejectUnauthorized`,\n    // but for now exists as a backwards-compatibility layer\n\n\n    options.rejectUnauthorized = !(eventSourceInitDict && !eventSourceInitDict.rejectUnauthorized);\n\n    if (eventSourceInitDict && eventSourceInitDict.createConnection !== undefined) {\n      options.createConnection = eventSourceInitDict.createConnection;\n    } // If specify http proxy, make the request to sent to the proxy server,\n    // and include the original url in path and Host headers\n\n\n    var useProxy = eventSourceInitDict && eventSourceInitDict.proxy;\n\n    if (useProxy) {\n      var proxy = parse(eventSourceInitDict.proxy);\n      isSecure = proxy.protocol === 'https:';\n      options.protocol = isSecure ? 'https:' : 'http:';\n      options.path = url;\n      options.headers.Host = options.host;\n      options.hostname = proxy.hostname;\n      options.host = proxy.host;\n      options.port = proxy.port;\n    } // If https options are specified, merge them into the request options\n\n\n    if (eventSourceInitDict && eventSourceInitDict.https) {\n      for (var optName in eventSourceInitDict.https) {\n        if (httpsOptions.indexOf(optName) === -1) {\n          continue;\n        }\n\n        var option = eventSourceInitDict.https[optName];\n\n        if (option !== undefined) {\n          options[optName] = option;\n        }\n      }\n    } // Pass this on to the XHR\n\n\n    if (eventSourceInitDict && eventSourceInitDict.withCredentials !== undefined) {\n      options.withCredentials = eventSourceInitDict.withCredentials;\n    }\n\n    req = (isSecure ? https : http).request(options, function (res) {\n      self.connectionInProgress = false; // Handle HTTP errors\n\n      if (res.statusCode === 500 || res.statusCode === 502 || res.statusCode === 503 || res.statusCode === 504) {\n        _emit('error', new Event('error', {\n          status: res.statusCode,\n          message: res.statusMessage\n        }));\n\n        onConnectionClosed();\n        return;\n      } // Handle HTTP redirects\n\n\n      if (res.statusCode === 301 || res.statusCode === 302 || res.statusCode === 307) {\n        var location = res.headers.location;\n\n        if (!location) {\n          // Server sent redirect response without Location header.\n          _emit('error', new Event('error', {\n            status: res.statusCode,\n            message: res.statusMessage\n          }));\n\n          return;\n        }\n\n        var prevOrigin = getOrigin(url);\n        var nextOrigin = getOrigin(location);\n        hasNewOrigin = prevOrigin !== nextOrigin;\n        if (res.statusCode === 307) reconnectUrl = url;\n        url = location;\n        process.nextTick(connect);\n        return;\n      }\n\n      if (res.statusCode !== 200) {\n        _emit('error', new Event('error', {\n          status: res.statusCode,\n          message: res.statusMessage\n        }));\n\n        return self.close();\n      }\n\n      readyState = EventSource.OPEN;\n      res.on('close', function () {\n        res.removeAllListeners('close');\n        res.removeAllListeners('end');\n        onConnectionClosed();\n      });\n      res.on('end', function () {\n        res.removeAllListeners('close');\n        res.removeAllListeners('end');\n        onConnectionClosed();\n      });\n\n      _emit('open', new Event('open')); // text/event-stream parser adapted from webkit's\n      // Source/WebCore/page/EventSource.cpp\n\n\n      var isFirst = true;\n      var buf;\n      var startingPos = 0;\n      var startingFieldLength = -1;\n      res.on('data', function (chunk) {\n        buf = buf ? Buffer.concat([buf, chunk]) : chunk;\n\n        if (isFirst && hasBom(buf)) {\n          buf = buf.slice(bom.length);\n        }\n\n        isFirst = false;\n        var pos = 0;\n        var length = buf.length;\n\n        while (pos < length) {\n          if (discardTrailingNewline) {\n            if (buf[pos] === lineFeed) {\n              ++pos;\n            }\n\n            discardTrailingNewline = false;\n          }\n\n          var lineLength = -1;\n          var fieldLength = startingFieldLength;\n          var c;\n\n          for (var i = startingPos; lineLength < 0 && i < length; ++i) {\n            c = buf[i];\n\n            if (c === colon) {\n              if (fieldLength < 0) {\n                fieldLength = i - pos;\n              }\n            } else if (c === carriageReturn) {\n              discardTrailingNewline = true;\n              lineLength = i - pos;\n            } else if (c === lineFeed) {\n              lineLength = i - pos;\n            }\n          }\n\n          if (lineLength < 0) {\n            startingPos = length - pos;\n            startingFieldLength = fieldLength;\n            break;\n          } else {\n            startingPos = 0;\n            startingFieldLength = -1;\n          }\n\n          parseEventStreamLine(buf, pos, fieldLength, lineLength);\n          pos += lineLength + 1;\n        }\n\n        if (pos === length) {\n          buf = void 0;\n        } else if (pos > 0) {\n          buf = buf.slice(pos);\n        }\n      });\n    });\n    req.on('error', function (err) {\n      self.connectionInProgress = false;\n      onConnectionClosed(err.message);\n    });\n    if (req.setNoDelay) req.setNoDelay(true);\n    req.end();\n  }\n\n  connect();\n\n  function _emit() {\n    if (self.listeners(arguments[0]).length > 0) {\n      self.emit.apply(self, arguments);\n    }\n  }\n\n  this._close = function () {\n    if (readyState === EventSource.CLOSED) return;\n    readyState = EventSource.CLOSED;\n    if (req.abort) req.abort();\n    if (req.xhr && req.xhr.abort) req.xhr.abort();\n  };\n\n  function parseEventStreamLine(buf, pos, fieldLength, lineLength) {\n    if (lineLength === 0) {\n      if (data.length > 0) {\n        var type = eventName || 'message';\n\n        _emit(type, new MessageEvent(type, {\n          data: data.slice(0, -1),\n          // remove trailing newline\n          lastEventId: lastEventId,\n          origin: getOrigin(url)\n        }));\n\n        data = '';\n      }\n\n      eventName = void 0;\n    } else if (fieldLength > 0) {\n      var noValue = fieldLength < 0;\n      var step = 0;\n      var field = buf.slice(pos, pos + (noValue ? lineLength : fieldLength)).toString();\n\n      if (noValue) {\n        step = lineLength;\n      } else if (buf[pos + fieldLength + 1] !== space) {\n        step = fieldLength + 1;\n      } else {\n        step = fieldLength + 2;\n      }\n\n      pos += step;\n      var valueLength = lineLength - step;\n      var value = buf.slice(pos, pos + valueLength).toString();\n\n      if (field === 'data') {\n        data += value + '\\n';\n      } else if (field === 'event') {\n        eventName = value;\n      } else if (field === 'id') {\n        lastEventId = value;\n      } else if (field === 'retry') {\n        var retry = parseInt(value, 10);\n\n        if (!Number.isNaN(retry)) {\n          self.reconnectInterval = retry;\n        }\n      }\n    }\n  }\n}\n\nmodule.exports = EventSource;\nutil.inherits(EventSource, events.EventEmitter);\nEventSource.prototype.constructor = EventSource; // make stacktraces readable\n\n['open', 'error', 'message'].forEach(function (method) {\n  Object.defineProperty(EventSource.prototype, 'on' + method, {\n    /**\n     * Returns the current listener\n     *\n     * @return {Mixed} the set function or undefined\n     * @api private\n     */\n    get: function get() {\n      var listener = this.listeners(method)[0];\n      return listener ? listener._listener ? listener._listener : listener : undefined;\n    },\n\n    /**\n     * Start listening for events\n     *\n     * @param {Function} listener the listener\n     * @return {Mixed} the set function or undefined\n     * @api private\n     */\n    set: function set(listener) {\n      this.removeAllListeners(method);\n      this.addEventListener(method, listener);\n    }\n  });\n});\n/**\n * Ready states\n */\n\nObject.defineProperty(EventSource, 'CONNECTING', {\n  enumerable: true,\n  value: 0\n});\nObject.defineProperty(EventSource, 'OPEN', {\n  enumerable: true,\n  value: 1\n});\nObject.defineProperty(EventSource, 'CLOSED', {\n  enumerable: true,\n  value: 2\n});\nEventSource.prototype.CONNECTING = 0;\nEventSource.prototype.OPEN = 1;\nEventSource.prototype.CLOSED = 2;\n/**\n * Closes the connection, if one is made, and sets the readyState attribute to 2 (closed)\n *\n * @see https://developer.mozilla.org/en-US/docs/Web/API/EventSource/close\n * @api public\n */\n\nEventSource.prototype.close = function () {\n  this._close();\n};\n/**\n * Emulates the W3C Browser based WebSocket interface using addEventListener.\n *\n * @param {String} type A string representing the event type to listen out for\n * @param {Function} listener callback\n * @see https://developer.mozilla.org/en/DOM/element.addEventListener\n * @see http://dev.w3.org/html5/websockets/#the-websocket-interface\n * @api public\n */\n\n\nEventSource.prototype.addEventListener = function addEventListener(type, listener) {\n  if (typeof listener === 'function') {\n    // store a reference so we can return the original function again\n    listener._listener = listener;\n    this.on(type, listener);\n  }\n};\n/**\n * Emulates the W3C Browser based WebSocket interface using dispatchEvent.\n *\n * @param {Event} event An event to be dispatched\n * @see https://developer.mozilla.org/en-US/docs/Web/API/EventTarget/dispatchEvent\n * @api public\n */\n\n\nEventSource.prototype.dispatchEvent = function dispatchEvent(event) {\n  if (!event.type) {\n    throw new Error('UNSPECIFIED_EVENT_TYPE_ERR');\n  } // if event is instance of an CustomEvent (or has 'details' property),\n  // send the detail object as the payload for the event\n\n\n  this.emit(event.type, event.detail);\n};\n/**\n * Emulates the W3C Browser based WebSocket interface using removeEventListener.\n *\n * @param {String} type A string representing the event type to remove\n * @param {Function} listener callback\n * @see https://developer.mozilla.org/en/DOM/element.removeEventListener\n * @see http://dev.w3.org/html5/websockets/#the-websocket-interface\n * @api public\n */\n\n\nEventSource.prototype.removeEventListener = function removeEventListener(type, listener) {\n  if (typeof listener === 'function') {\n    listener._listener = undefined;\n    this.removeListener(type, listener);\n  }\n};\n/**\n * W3C Event\n *\n * @see http://www.w3.org/TR/DOM-Level-3-Events/#interface-Event\n * @api private\n */\n\n\nfunction Event(type, optionalProperties) {\n  Object.defineProperty(this, 'type', {\n    writable: false,\n    value: type,\n    enumerable: true\n  });\n\n  if (optionalProperties) {\n    for (var f in optionalProperties) {\n      if (optionalProperties.hasOwnProperty(f)) {\n        Object.defineProperty(this, f, {\n          writable: false,\n          value: optionalProperties[f],\n          enumerable: true\n        });\n      }\n    }\n  }\n}\n/**\n * W3C MessageEvent\n *\n * @see http://www.w3.org/TR/webmessaging/#event-definitions\n * @api private\n */\n\n\nfunction MessageEvent(type, eventInitDict) {\n  Object.defineProperty(this, 'type', {\n    writable: false,\n    value: type,\n    enumerable: true\n  });\n\n  for (var f in eventInitDict) {\n    if (eventInitDict.hasOwnProperty(f)) {\n      Object.defineProperty(this, f, {\n        writable: false,\n        value: eventInitDict[f],\n        enumerable: true\n      });\n    }\n  }\n}\n/**\n * Returns a new object of headers that does not include any authorization and cookie headers\n *\n * @param {Object} headers An object of headers ({[headerName]: headerValue})\n * @return {Object} a new object of headers\n * @api private\n */\n\n\nfunction removeUnsafeHeaders(headers) {\n  var safe = {};\n\n  for (var key in headers) {\n    if (/^(cookie|authorization)$/i.test(key)) {\n      continue;\n    }\n\n    safe[key] = headers[key];\n  }\n\n  return safe;\n}\n/**\n * Transform an URL to a valid origin value.\n *\n * @param {String|Object} url URL to transform to it's origin.\n * @returns {String} The origin.\n * @api private\n */\n\n\nfunction getOrigin(url) {\n  if (typeof url === 'string') url = parse(url);\n  if (!url.protocol || !url.hostname) return 'null';\n  return (url.protocol + '//' + url.host).toLowerCase();\n}","map":{"version":3,"names":["parse","require","events","https","http","util","httpsOptions","bom","colon","space","lineFeed","carriageReturn","hasBom","buf","every","charCode","index","EventSource","url","eventSourceInitDict","readyState","CONNECTING","headers","hasNewOrigin","Object","defineProperty","get","self","reconnectInterval","connectionInProgress","onConnectionClosed","message","CLOSED","_emit","Event","reconnectUrl","setTimeout","connect","req","lastEventId","discardTrailingNewline","data","eventName","options","isSecure","protocol","reqHeaders","removeUnsafeHeaders","i","header","rejectUnauthorized","createConnection","undefined","useProxy","proxy","path","Host","host","hostname","port","optName","indexOf","option","withCredentials","request","res","statusCode","status","statusMessage","location","prevOrigin","getOrigin","nextOrigin","process","nextTick","close","OPEN","on","removeAllListeners","isFirst","startingPos","startingFieldLength","chunk","Buffer","concat","slice","length","pos","lineLength","fieldLength","c","parseEventStreamLine","err","setNoDelay","end","listeners","arguments","emit","apply","_close","abort","xhr","type","MessageEvent","origin","noValue","step","field","toString","valueLength","value","retry","parseInt","Number","isNaN","module","exports","inherits","EventEmitter","prototype","constructor","forEach","method","listener","_listener","set","addEventListener","enumerable","dispatchEvent","event","Error","detail","removeEventListener","removeListener","optionalProperties","writable","f","hasOwnProperty","eventInitDict","safe","key","test","toLowerCase"],"sources":["C:/Users/acer/node_modules/eventsource/lib/eventsource.js"],"sourcesContent":["var parse = require('url').parse\nvar events = require('events')\nvar https = require('https')\nvar http = require('http')\nvar util = require('util')\n\nvar httpsOptions = [\n  'pfx', 'key', 'passphrase', 'cert', 'ca', 'ciphers',\n  'rejectUnauthorized', 'secureProtocol', 'servername', 'checkServerIdentity'\n]\n\nvar bom = [239, 187, 191]\nvar colon = 58\nvar space = 32\nvar lineFeed = 10\nvar carriageReturn = 13\n\nfunction hasBom (buf) {\n  return bom.every(function (charCode, index) {\n    return buf[index] === charCode\n  })\n}\n\n/**\n * Creates a new EventSource object\n *\n * @param {String} url the URL to which to connect\n * @param {Object} [eventSourceInitDict] extra init params. See README for details.\n * @api public\n **/\nfunction EventSource (url, eventSourceInitDict) {\n  var readyState = EventSource.CONNECTING\n  var headers = eventSourceInitDict && eventSourceInitDict.headers\n  var hasNewOrigin = false\n  Object.defineProperty(this, 'readyState', {\n    get: function () {\n      return readyState\n    }\n  })\n\n  Object.defineProperty(this, 'url', {\n    get: function () {\n      return url\n    }\n  })\n\n  var self = this\n  self.reconnectInterval = 1000\n  self.connectionInProgress = false\n\n  function onConnectionClosed (message) {\n    if (readyState === EventSource.CLOSED) return\n    readyState = EventSource.CONNECTING\n    _emit('error', new Event('error', {message: message}))\n\n    // The url may have been changed by a temporary redirect. If that's the case,\n    // revert it now, and flag that we are no longer pointing to a new origin\n    if (reconnectUrl) {\n      url = reconnectUrl\n      reconnectUrl = null\n      hasNewOrigin = false\n    }\n    setTimeout(function () {\n      if (readyState !== EventSource.CONNECTING || self.connectionInProgress) {\n        return\n      }\n      self.connectionInProgress = true\n      connect()\n    }, self.reconnectInterval)\n  }\n\n  var req\n  var lastEventId = ''\n  if (headers && headers['Last-Event-ID']) {\n    lastEventId = headers['Last-Event-ID']\n    delete headers['Last-Event-ID']\n  }\n\n  var discardTrailingNewline = false\n  var data = ''\n  var eventName = ''\n\n  var reconnectUrl = null\n\n  function connect () {\n    var options = parse(url)\n    var isSecure = options.protocol === 'https:'\n    options.headers = { 'Cache-Control': 'no-cache', 'Accept': 'text/event-stream' }\n    if (lastEventId) options.headers['Last-Event-ID'] = lastEventId\n    if (headers) {\n      var reqHeaders = hasNewOrigin ? removeUnsafeHeaders(headers) : headers\n      for (var i in reqHeaders) {\n        var header = reqHeaders[i]\n        if (header) {\n          options.headers[i] = header\n        }\n      }\n    }\n\n    // Legacy: this should be specified as `eventSourceInitDict.https.rejectUnauthorized`,\n    // but for now exists as a backwards-compatibility layer\n    options.rejectUnauthorized = !(eventSourceInitDict && !eventSourceInitDict.rejectUnauthorized)\n\n    if (eventSourceInitDict && eventSourceInitDict.createConnection !== undefined) {\n      options.createConnection = eventSourceInitDict.createConnection\n    }\n\n    // If specify http proxy, make the request to sent to the proxy server,\n    // and include the original url in path and Host headers\n    var useProxy = eventSourceInitDict && eventSourceInitDict.proxy\n    if (useProxy) {\n      var proxy = parse(eventSourceInitDict.proxy)\n      isSecure = proxy.protocol === 'https:'\n\n      options.protocol = isSecure ? 'https:' : 'http:'\n      options.path = url\n      options.headers.Host = options.host\n      options.hostname = proxy.hostname\n      options.host = proxy.host\n      options.port = proxy.port\n    }\n\n    // If https options are specified, merge them into the request options\n    if (eventSourceInitDict && eventSourceInitDict.https) {\n      for (var optName in eventSourceInitDict.https) {\n        if (httpsOptions.indexOf(optName) === -1) {\n          continue\n        }\n\n        var option = eventSourceInitDict.https[optName]\n        if (option !== undefined) {\n          options[optName] = option\n        }\n      }\n    }\n\n    // Pass this on to the XHR\n    if (eventSourceInitDict && eventSourceInitDict.withCredentials !== undefined) {\n      options.withCredentials = eventSourceInitDict.withCredentials\n    }\n\n    req = (isSecure ? https : http).request(options, function (res) {\n      self.connectionInProgress = false\n      // Handle HTTP errors\n      if (res.statusCode === 500 || res.statusCode === 502 || res.statusCode === 503 || res.statusCode === 504) {\n        _emit('error', new Event('error', {status: res.statusCode, message: res.statusMessage}))\n        onConnectionClosed()\n        return\n      }\n\n      // Handle HTTP redirects\n      if (res.statusCode === 301 || res.statusCode === 302 || res.statusCode === 307) {\n        var location = res.headers.location\n        if (!location) {\n          // Server sent redirect response without Location header.\n          _emit('error', new Event('error', {status: res.statusCode, message: res.statusMessage}))\n          return\n        }\n        var prevOrigin = getOrigin(url)\n        var nextOrigin = getOrigin(location)\n        hasNewOrigin = prevOrigin !== nextOrigin\n        if (res.statusCode === 307) reconnectUrl = url\n        url = location\n        process.nextTick(connect)\n        return\n      }\n\n      if (res.statusCode !== 200) {\n        _emit('error', new Event('error', {status: res.statusCode, message: res.statusMessage}))\n        return self.close()\n      }\n\n      readyState = EventSource.OPEN\n      res.on('close', function () {\n        res.removeAllListeners('close')\n        res.removeAllListeners('end')\n        onConnectionClosed()\n      })\n\n      res.on('end', function () {\n        res.removeAllListeners('close')\n        res.removeAllListeners('end')\n        onConnectionClosed()\n      })\n      _emit('open', new Event('open'))\n\n      // text/event-stream parser adapted from webkit's\n      // Source/WebCore/page/EventSource.cpp\n      var isFirst = true\n      var buf\n      var startingPos = 0\n      var startingFieldLength = -1\n      res.on('data', function (chunk) {\n        buf = buf ? Buffer.concat([buf, chunk]) : chunk\n        if (isFirst && hasBom(buf)) {\n          buf = buf.slice(bom.length)\n        }\n\n        isFirst = false\n        var pos = 0\n        var length = buf.length\n\n        while (pos < length) {\n          if (discardTrailingNewline) {\n            if (buf[pos] === lineFeed) {\n              ++pos\n            }\n            discardTrailingNewline = false\n          }\n\n          var lineLength = -1\n          var fieldLength = startingFieldLength\n          var c\n\n          for (var i = startingPos; lineLength < 0 && i < length; ++i) {\n            c = buf[i]\n            if (c === colon) {\n              if (fieldLength < 0) {\n                fieldLength = i - pos\n              }\n            } else if (c === carriageReturn) {\n              discardTrailingNewline = true\n              lineLength = i - pos\n            } else if (c === lineFeed) {\n              lineLength = i - pos\n            }\n          }\n\n          if (lineLength < 0) {\n            startingPos = length - pos\n            startingFieldLength = fieldLength\n            break\n          } else {\n            startingPos = 0\n            startingFieldLength = -1\n          }\n\n          parseEventStreamLine(buf, pos, fieldLength, lineLength)\n\n          pos += lineLength + 1\n        }\n\n        if (pos === length) {\n          buf = void 0\n        } else if (pos > 0) {\n          buf = buf.slice(pos)\n        }\n      })\n    })\n\n    req.on('error', function (err) {\n      self.connectionInProgress = false\n      onConnectionClosed(err.message)\n    })\n\n    if (req.setNoDelay) req.setNoDelay(true)\n    req.end()\n  }\n\n  connect()\n\n  function _emit () {\n    if (self.listeners(arguments[0]).length > 0) {\n      self.emit.apply(self, arguments)\n    }\n  }\n\n  this._close = function () {\n    if (readyState === EventSource.CLOSED) return\n    readyState = EventSource.CLOSED\n    if (req.abort) req.abort()\n    if (req.xhr && req.xhr.abort) req.xhr.abort()\n  }\n\n  function parseEventStreamLine (buf, pos, fieldLength, lineLength) {\n    if (lineLength === 0) {\n      if (data.length > 0) {\n        var type = eventName || 'message'\n        _emit(type, new MessageEvent(type, {\n          data: data.slice(0, -1), // remove trailing newline\n          lastEventId: lastEventId,\n          origin: getOrigin(url)\n        }))\n        data = ''\n      }\n      eventName = void 0\n    } else if (fieldLength > 0) {\n      var noValue = fieldLength < 0\n      var step = 0\n      var field = buf.slice(pos, pos + (noValue ? lineLength : fieldLength)).toString()\n\n      if (noValue) {\n        step = lineLength\n      } else if (buf[pos + fieldLength + 1] !== space) {\n        step = fieldLength + 1\n      } else {\n        step = fieldLength + 2\n      }\n      pos += step\n\n      var valueLength = lineLength - step\n      var value = buf.slice(pos, pos + valueLength).toString()\n\n      if (field === 'data') {\n        data += value + '\\n'\n      } else if (field === 'event') {\n        eventName = value\n      } else if (field === 'id') {\n        lastEventId = value\n      } else if (field === 'retry') {\n        var retry = parseInt(value, 10)\n        if (!Number.isNaN(retry)) {\n          self.reconnectInterval = retry\n        }\n      }\n    }\n  }\n}\n\nmodule.exports = EventSource\n\nutil.inherits(EventSource, events.EventEmitter)\nEventSource.prototype.constructor = EventSource; // make stacktraces readable\n\n['open', 'error', 'message'].forEach(function (method) {\n  Object.defineProperty(EventSource.prototype, 'on' + method, {\n    /**\n     * Returns the current listener\n     *\n     * @return {Mixed} the set function or undefined\n     * @api private\n     */\n    get: function get () {\n      var listener = this.listeners(method)[0]\n      return listener ? (listener._listener ? listener._listener : listener) : undefined\n    },\n\n    /**\n     * Start listening for events\n     *\n     * @param {Function} listener the listener\n     * @return {Mixed} the set function or undefined\n     * @api private\n     */\n    set: function set (listener) {\n      this.removeAllListeners(method)\n      this.addEventListener(method, listener)\n    }\n  })\n})\n\n/**\n * Ready states\n */\nObject.defineProperty(EventSource, 'CONNECTING', {enumerable: true, value: 0})\nObject.defineProperty(EventSource, 'OPEN', {enumerable: true, value: 1})\nObject.defineProperty(EventSource, 'CLOSED', {enumerable: true, value: 2})\n\nEventSource.prototype.CONNECTING = 0\nEventSource.prototype.OPEN = 1\nEventSource.prototype.CLOSED = 2\n\n/**\n * Closes the connection, if one is made, and sets the readyState attribute to 2 (closed)\n *\n * @see https://developer.mozilla.org/en-US/docs/Web/API/EventSource/close\n * @api public\n */\nEventSource.prototype.close = function () {\n  this._close()\n}\n\n/**\n * Emulates the W3C Browser based WebSocket interface using addEventListener.\n *\n * @param {String} type A string representing the event type to listen out for\n * @param {Function} listener callback\n * @see https://developer.mozilla.org/en/DOM/element.addEventListener\n * @see http://dev.w3.org/html5/websockets/#the-websocket-interface\n * @api public\n */\nEventSource.prototype.addEventListener = function addEventListener (type, listener) {\n  if (typeof listener === 'function') {\n    // store a reference so we can return the original function again\n    listener._listener = listener\n    this.on(type, listener)\n  }\n}\n\n/**\n * Emulates the W3C Browser based WebSocket interface using dispatchEvent.\n *\n * @param {Event} event An event to be dispatched\n * @see https://developer.mozilla.org/en-US/docs/Web/API/EventTarget/dispatchEvent\n * @api public\n */\nEventSource.prototype.dispatchEvent = function dispatchEvent (event) {\n  if (!event.type) {\n    throw new Error('UNSPECIFIED_EVENT_TYPE_ERR')\n  }\n  // if event is instance of an CustomEvent (or has 'details' property),\n  // send the detail object as the payload for the event\n  this.emit(event.type, event.detail)\n}\n\n/**\n * Emulates the W3C Browser based WebSocket interface using removeEventListener.\n *\n * @param {String} type A string representing the event type to remove\n * @param {Function} listener callback\n * @see https://developer.mozilla.org/en/DOM/element.removeEventListener\n * @see http://dev.w3.org/html5/websockets/#the-websocket-interface\n * @api public\n */\nEventSource.prototype.removeEventListener = function removeEventListener (type, listener) {\n  if (typeof listener === 'function') {\n    listener._listener = undefined\n    this.removeListener(type, listener)\n  }\n}\n\n/**\n * W3C Event\n *\n * @see http://www.w3.org/TR/DOM-Level-3-Events/#interface-Event\n * @api private\n */\nfunction Event (type, optionalProperties) {\n  Object.defineProperty(this, 'type', { writable: false, value: type, enumerable: true })\n  if (optionalProperties) {\n    for (var f in optionalProperties) {\n      if (optionalProperties.hasOwnProperty(f)) {\n        Object.defineProperty(this, f, { writable: false, value: optionalProperties[f], enumerable: true })\n      }\n    }\n  }\n}\n\n/**\n * W3C MessageEvent\n *\n * @see http://www.w3.org/TR/webmessaging/#event-definitions\n * @api private\n */\nfunction MessageEvent (type, eventInitDict) {\n  Object.defineProperty(this, 'type', { writable: false, value: type, enumerable: true })\n  for (var f in eventInitDict) {\n    if (eventInitDict.hasOwnProperty(f)) {\n      Object.defineProperty(this, f, { writable: false, value: eventInitDict[f], enumerable: true })\n    }\n  }\n}\n\n/**\n * Returns a new object of headers that does not include any authorization and cookie headers\n *\n * @param {Object} headers An object of headers ({[headerName]: headerValue})\n * @return {Object} a new object of headers\n * @api private\n */\nfunction removeUnsafeHeaders (headers) {\n  var safe = {}\n  for (var key in headers) {\n    if (/^(cookie|authorization)$/i.test(key)) {\n      continue\n    }\n\n    safe[key] = headers[key]\n  }\n\n  return safe\n}\n\n/**\n * Transform an URL to a valid origin value.\n *\n * @param {String|Object} url URL to transform to it's origin.\n * @returns {String} The origin.\n * @api private\n */\nfunction getOrigin (url) {\n  if (typeof url === 'string') url = parse(url)\n  if (!url.protocol || !url.hostname) return 'null'\n  return (url.protocol + '//' + url.host).toLowerCase()\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}