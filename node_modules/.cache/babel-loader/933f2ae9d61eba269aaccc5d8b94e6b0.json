{"ast":null,"code":"/*\n Modifications copyright 2018 The caver-js Authors\n This file is part of web3.js.\n\n web3.js is free software: you can redistribute it and/or modify\n it under the terms of the GNU Lesser General Public License as published by\n the Free Software Foundation, either version 3 of the License, or\n (at your option) any later version.\n\n web3.js is distributed in the hope that it will be useful,\n but WITHOUT ANY WARRANTY; without even the implied warranty of\n MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n GNU Lesser General Public License for more details.\n\n You should have received a copy of the GNU Lesser General Public License\n along with web3.js.  If not, see <http://www.gnu.org/licenses/>.\n\n This file is derived from web3.js/packages/web3-utils/src/soliditySha3.js (2019/06/12).\n Modified and improved for the caver-js development.\n */\n\n/**\n * @file soliditySha3.js\n * @author Fabian Vogelsteller <fabian@ethereum.org>\n * @date 2017\n */\nconst _ = require('lodash');\n\nconst BN = require('bn.js');\n\nconst utils = require('./utils');\n\nconst _elementaryName = function (name) {\n  if (name.startsWith('int[')) {\n    return `int256${name.slice(3)}`;\n  }\n\n  if (name === 'int') {\n    return 'int256';\n  }\n\n  if (name.startsWith('uint[')) {\n    return `uint256${name.slice(4)}`;\n  }\n\n  if (name === 'uint') {\n    return 'uint256';\n  }\n\n  if (name.startsWith('fixed[')) {\n    return `fixed128x128${name.slice(5)}`;\n  }\n\n  if (name === 'fixed') {\n    return 'fixed128x128';\n  }\n\n  if (name.startsWith('ufixed[')) {\n    return `ufixed128x128${name.slice(6)}`;\n  }\n\n  if (name === 'ufixed') {\n    return 'ufixed128x128';\n  }\n\n  return name;\n}; // Parse N from type<N>\n\n\nconst _parseTypeN = function (type) {\n  const typesize = /^\\D+(\\d+).*$/.exec(type);\n  return typesize ? parseInt(typesize[1], 10) : null;\n}; // Parse N from type[<N>]\n\n\nconst _parseTypeNArray = function (type) {\n  const arraySize = /^\\D+\\d*\\[(\\d+)\\]$/.exec(type);\n  return arraySize ? parseInt(arraySize[1], 10) : null;\n};\n\nconst _parseNumber = function (arg) {\n  const type = typeof arg;\n\n  if (type === 'string') {\n    if (utils.isHexStrict(arg)) {\n      return new BN(arg.replace(/0x/i, ''), 16);\n    }\n\n    return new BN(arg, 10);\n  }\n\n  if (type === 'number') {\n    return new BN(arg);\n  }\n\n  if (utils.isBigNumber(arg)) {\n    return new BN(arg.toString(10));\n  }\n\n  if (utils.isBN(arg)) {\n    return arg;\n  }\n\n  throw new Error(`${arg} is not a number`);\n};\n/* eslint-disable complexity */\n\n\nconst _solidityPack = function (type, value, arraySize) {\n  let size;\n  let num;\n  type = _elementaryName(type);\n\n  if (type === 'bytes') {\n    if (value.replace(/^0x/i, '').length % 2 !== 0) {\n      throw new Error(`Invalid bytes characters ${value.length}`);\n    }\n\n    return value;\n  }\n\n  if (type === 'string') {\n    return utils.utf8ToHex(value);\n  }\n\n  if (type === 'bool') {\n    return value ? '01' : '00';\n  }\n\n  if (type.startsWith('address')) {\n    if (arraySize) {\n      size = 64;\n    } else {\n      size = 40;\n    }\n\n    if (!utils.isAddress(value)) {\n      throw new Error(`${value} is not a valid address, or the checksum is invalid.`);\n    }\n\n    return utils.leftPad(value.toLowerCase(), size);\n  }\n\n  size = _parseTypeN(type);\n\n  if (type.startsWith('bytes')) {\n    if (!size) {\n      throw new Error('bytes[] not yet supported in solidity');\n    } // must be 32 byte slices when in an array\n\n\n    if (arraySize) {\n      size = 32;\n    }\n\n    if (size < 1 || size > 32 || size < value.replace(/^0x/i, '').length / 2) {\n      throw new Error(`Invalid bytes${size} for ${value}`);\n    }\n\n    return utils.rightPad(value, size * 2);\n  }\n\n  if (type.startsWith('uint')) {\n    if (size % 8 || size < 8 || size > 256) {\n      throw new Error(`Invalid uint${size} size`);\n    }\n\n    num = _parseNumber(value);\n\n    if (num.bitLength() > size) {\n      throw new Error(`Supplied uint exceeds width: ${size} vs ${num.bitLength()}`);\n    }\n\n    if (num.lt(new BN(0))) {\n      throw new Error(`Supplied uint ${num.toString()} is negative`);\n    }\n\n    return size ? utils.leftPad(num.toString('hex'), size / 8 * 2) : num;\n  }\n\n  if (type.startsWith('int')) {\n    if (size % 8 || size < 8 || size > 256) {\n      throw new Error(`Invalid int${size} size`);\n    }\n\n    num = _parseNumber(value);\n\n    if (num.bitLength() > size) {\n      throw new Error(`Supplied int exceeds width: ${size} vs ${num.bitLength()}`);\n    }\n\n    if (num.lt(new BN(0))) {\n      return num.toTwos(size).toString('hex');\n    }\n\n    return size ? utils.leftPad(num.toString('hex'), size / 8 * 2) : num;\n  } // FIXME: support all other types\n\n\n  throw new Error(`Unsupported or invalid type: ${type}`);\n};\n/* eslint-enable complexity */\n\n/* eslint-disable complexity */\n\n\nconst _processSoliditySha3Args = function (arg) {\n  if (_.isArray(arg)) {\n    throw new Error('Autodetection of array types is not supported.');\n  }\n\n  let type;\n  let value = '';\n  let hexArg;\n  let arraySize; // if type is given\n\n  if (_.isObject(arg) && (Object.prototype.hasOwnProperty.call(arg, 'v') || Object.prototype.hasOwnProperty.call(arg, 't') || Object.prototype.hasOwnProperty.call(arg, 'value') || Object.prototype.hasOwnProperty.call(arg, 'type'))) {\n    type = Object.prototype.hasOwnProperty.call(arg, 't') ? arg.t : arg.type;\n    value = Object.prototype.hasOwnProperty.call(arg, 'v') ? arg.v : arg.value; // otherwise try to guess the type\n  } else {\n    type = utils.toHex(arg, true);\n    value = utils.toHex(arg);\n\n    if (!type.startsWith('int') && !type.startsWith('uint')) {\n      type = 'bytes';\n    }\n  }\n\n  if ((type.startsWith('int') || type.startsWith('uint')) && typeof value === 'string' && !/^(-)?0x/i.test(value)) {\n    value = new BN(value);\n  } // get the array size\n\n\n  if (_.isArray(value)) {\n    arraySize = _parseTypeNArray(type);\n\n    if (arraySize && value.length !== arraySize) {\n      throw new Error(`${type} is not matching the given array ${JSON.stringify(value)}`);\n    } else {\n      arraySize = value.length;\n    }\n  }\n\n  if (_.isArray(value)) {\n    hexArg = value.map(function (val) {\n      return _solidityPack(type, val, arraySize).toString('hex').replace('0x', '');\n    });\n    return hexArg.join('');\n  }\n\n  hexArg = _solidityPack(type, value, arraySize);\n  return hexArg.toString('hex').replace('0x', '');\n};\n/* eslint-enable complexity */\n\n/**\n * Hashes solidity values to a sha3 hash using keccak 256\n *\n * @method soliditySha3\n * @return {Object} the sha3\n */\n\n\nconst soliditySha3 = function () {\n  const args = Array.prototype.slice.call(arguments);\n\n  const hexArgs = _.map(args, _processSoliditySha3Args);\n\n  return utils.sha3(`0x${hexArgs.join('')}`);\n};\n\nmodule.exports = soliditySha3;","map":{"version":3,"names":["_","require","BN","utils","_elementaryName","name","startsWith","slice","_parseTypeN","type","typesize","exec","parseInt","_parseTypeNArray","arraySize","_parseNumber","arg","isHexStrict","replace","isBigNumber","toString","isBN","Error","_solidityPack","value","size","num","length","utf8ToHex","isAddress","leftPad","toLowerCase","rightPad","bitLength","lt","toTwos","_processSoliditySha3Args","isArray","hexArg","isObject","Object","prototype","hasOwnProperty","call","t","v","toHex","test","JSON","stringify","map","val","join","soliditySha3","args","Array","arguments","hexArgs","sha3","module","exports"],"sources":["C:/Users/acer/node_modules/caver-js/packages/caver-utils/src/soliditySha3.js"],"sourcesContent":["/*\n Modifications copyright 2018 The caver-js Authors\n This file is part of web3.js.\n\n web3.js is free software: you can redistribute it and/or modify\n it under the terms of the GNU Lesser General Public License as published by\n the Free Software Foundation, either version 3 of the License, or\n (at your option) any later version.\n\n web3.js is distributed in the hope that it will be useful,\n but WITHOUT ANY WARRANTY; without even the implied warranty of\n MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n GNU Lesser General Public License for more details.\n\n You should have received a copy of the GNU Lesser General Public License\n along with web3.js.  If not, see <http://www.gnu.org/licenses/>.\n\n This file is derived from web3.js/packages/web3-utils/src/soliditySha3.js (2019/06/12).\n Modified and improved for the caver-js development.\n */\n/**\n * @file soliditySha3.js\n * @author Fabian Vogelsteller <fabian@ethereum.org>\n * @date 2017\n */\n\nconst _ = require('lodash')\nconst BN = require('bn.js')\nconst utils = require('./utils')\n\nconst _elementaryName = function(name) {\n    if (name.startsWith('int[')) {\n        return `int256${name.slice(3)}`\n    }\n    if (name === 'int') {\n        return 'int256'\n    }\n    if (name.startsWith('uint[')) {\n        return `uint256${name.slice(4)}`\n    }\n    if (name === 'uint') {\n        return 'uint256'\n    }\n    if (name.startsWith('fixed[')) {\n        return `fixed128x128${name.slice(5)}`\n    }\n    if (name === 'fixed') {\n        return 'fixed128x128'\n    }\n    if (name.startsWith('ufixed[')) {\n        return `ufixed128x128${name.slice(6)}`\n    }\n    if (name === 'ufixed') {\n        return 'ufixed128x128'\n    }\n    return name\n}\n\n// Parse N from type<N>\nconst _parseTypeN = function(type) {\n    const typesize = /^\\D+(\\d+).*$/.exec(type)\n    return typesize ? parseInt(typesize[1], 10) : null\n}\n\n// Parse N from type[<N>]\nconst _parseTypeNArray = function(type) {\n    const arraySize = /^\\D+\\d*\\[(\\d+)\\]$/.exec(type)\n    return arraySize ? parseInt(arraySize[1], 10) : null\n}\n\nconst _parseNumber = function(arg) {\n    const type = typeof arg\n    if (type === 'string') {\n        if (utils.isHexStrict(arg)) {\n            return new BN(arg.replace(/0x/i, ''), 16)\n        }\n        return new BN(arg, 10)\n    }\n    if (type === 'number') {\n        return new BN(arg)\n    }\n    if (utils.isBigNumber(arg)) {\n        return new BN(arg.toString(10))\n    }\n    if (utils.isBN(arg)) {\n        return arg\n    }\n    throw new Error(`${arg} is not a number`)\n}\n\n/* eslint-disable complexity */\nconst _solidityPack = function(type, value, arraySize) {\n    let size\n    let num\n    type = _elementaryName(type)\n\n    if (type === 'bytes') {\n        if (value.replace(/^0x/i, '').length % 2 !== 0) {\n            throw new Error(`Invalid bytes characters ${value.length}`)\n        }\n\n        return value\n    }\n    if (type === 'string') {\n        return utils.utf8ToHex(value)\n    }\n    if (type === 'bool') {\n        return value ? '01' : '00'\n    }\n    if (type.startsWith('address')) {\n        if (arraySize) {\n            size = 64\n        } else {\n            size = 40\n        }\n\n        if (!utils.isAddress(value)) {\n            throw new Error(`${value} is not a valid address, or the checksum is invalid.`)\n        }\n\n        return utils.leftPad(value.toLowerCase(), size)\n    }\n\n    size = _parseTypeN(type)\n\n    if (type.startsWith('bytes')) {\n        if (!size) {\n            throw new Error('bytes[] not yet supported in solidity')\n        }\n\n        // must be 32 byte slices when in an array\n        if (arraySize) {\n            size = 32\n        }\n\n        if (size < 1 || size > 32 || size < value.replace(/^0x/i, '').length / 2) {\n            throw new Error(`Invalid bytes${size} for ${value}`)\n        }\n\n        return utils.rightPad(value, size * 2)\n    }\n    if (type.startsWith('uint')) {\n        if (size % 8 || size < 8 || size > 256) {\n            throw new Error(`Invalid uint${size} size`)\n        }\n\n        num = _parseNumber(value)\n        if (num.bitLength() > size) {\n            throw new Error(`Supplied uint exceeds width: ${size} vs ${num.bitLength()}`)\n        }\n\n        if (num.lt(new BN(0))) {\n            throw new Error(`Supplied uint ${num.toString()} is negative`)\n        }\n\n        return size ? utils.leftPad(num.toString('hex'), (size / 8) * 2) : num\n    }\n    if (type.startsWith('int')) {\n        if (size % 8 || size < 8 || size > 256) {\n            throw new Error(`Invalid int${size} size`)\n        }\n\n        num = _parseNumber(value)\n        if (num.bitLength() > size) {\n            throw new Error(`Supplied int exceeds width: ${size} vs ${num.bitLength()}`)\n        }\n\n        if (num.lt(new BN(0))) {\n            return num.toTwos(size).toString('hex')\n        }\n        return size ? utils.leftPad(num.toString('hex'), (size / 8) * 2) : num\n    }\n    // FIXME: support all other types\n    throw new Error(`Unsupported or invalid type: ${type}`)\n}\n/* eslint-enable complexity */\n\n/* eslint-disable complexity */\nconst _processSoliditySha3Args = function(arg) {\n    if (_.isArray(arg)) {\n        throw new Error('Autodetection of array types is not supported.')\n    }\n\n    let type\n    let value = ''\n    let hexArg\n    let arraySize\n\n    // if type is given\n    if (\n        _.isObject(arg) &&\n        (Object.prototype.hasOwnProperty.call(arg, 'v') ||\n            Object.prototype.hasOwnProperty.call(arg, 't') ||\n            Object.prototype.hasOwnProperty.call(arg, 'value') ||\n            Object.prototype.hasOwnProperty.call(arg, 'type'))\n    ) {\n        type = Object.prototype.hasOwnProperty.call(arg, 't') ? arg.t : arg.type\n        value = Object.prototype.hasOwnProperty.call(arg, 'v') ? arg.v : arg.value\n\n        // otherwise try to guess the type\n    } else {\n        type = utils.toHex(arg, true)\n        value = utils.toHex(arg)\n\n        if (!type.startsWith('int') && !type.startsWith('uint')) {\n            type = 'bytes'\n        }\n    }\n\n    if ((type.startsWith('int') || type.startsWith('uint')) && typeof value === 'string' && !/^(-)?0x/i.test(value)) {\n        value = new BN(value)\n    }\n\n    // get the array size\n    if (_.isArray(value)) {\n        arraySize = _parseTypeNArray(type)\n        if (arraySize && value.length !== arraySize) {\n            throw new Error(`${type} is not matching the given array ${JSON.stringify(value)}`)\n        } else {\n            arraySize = value.length\n        }\n    }\n\n    if (_.isArray(value)) {\n        hexArg = value.map(function(val) {\n            return _solidityPack(type, val, arraySize)\n                .toString('hex')\n                .replace('0x', '')\n        })\n        return hexArg.join('')\n    }\n    hexArg = _solidityPack(type, value, arraySize)\n    return hexArg.toString('hex').replace('0x', '')\n}\n/* eslint-enable complexity */\n\n/**\n * Hashes solidity values to a sha3 hash using keccak 256\n *\n * @method soliditySha3\n * @return {Object} the sha3\n */\nconst soliditySha3 = function() {\n    const args = Array.prototype.slice.call(arguments)\n\n    const hexArgs = _.map(args, _processSoliditySha3Args)\n\n    return utils.sha3(`0x${hexArgs.join('')}`)\n}\n\nmodule.exports = soliditySha3\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}