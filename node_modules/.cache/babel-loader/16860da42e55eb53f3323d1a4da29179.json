{"ast":null,"code":"\"use strict\";\n\nvar __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  Object.defineProperty(o, k2, {\n    enumerable: true,\n    get: function () {\n      return m[k];\n    }\n  });\n} : function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\n\nvar __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {\n  Object.defineProperty(o, \"default\", {\n    enumerable: true,\n    value: v\n  });\n} : function (o, v) {\n  o[\"default\"] = v;\n});\n\nvar __importStar = this && this.__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (k !== \"default\" && Object.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n\n  __setModuleDefault(result, mod);\n\n  return result;\n};\n\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nconst _ = __importStar(require(\"lodash\"));\n\nconst common_1 = require(\"../common\");\n\nconst account_trustline_1 = __importDefault(require(\"./parse/account-trustline\"));\n\nfunction currencyFilter(currency, trustline) {\n  return currency === null || trustline.specification.currency === currency;\n}\n\nfunction getTrustlines(address) {\n  let options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n  var _a;\n\n  return __awaiter(this, void 0, void 0, function* () {\n    common_1.validate.getTrustlines({\n      address,\n      options\n    });\n    address = common_1.ensureClassicAddress(address);\n    const responses = yield this._requestAll('account_lines', {\n      account: address,\n      ledger_index: (_a = options.ledgerVersion) !== null && _a !== void 0 ? _a : yield this.getLedgerVersion(),\n      limit: options.limit,\n      peer: options.counterparty\n    });\n\n    const trustlines = _.flatMap(responses, response => response.lines);\n\n    return trustlines.map(account_trustline_1.default).filter(trustline => {\n      return currencyFilter(options.currency || null, trustline);\n    });\n  });\n}\n\nexports.default = getTrustlines;","map":{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;AACA;;AACA;;AAWA,SAASA,cAAT,CAAwBC,QAAxB,EAA0CC,SAA1C,EAAuE;EACrE,OAAOD,QAAQ,KAAK,IAAb,IAAqBC,SAAS,CAACC,aAAV,CAAwBF,QAAxB,KAAqCA,QAAjE;AACD;;AAED,SAAeG,aAAf,CAEEC,OAFF,EAGoC;EAAA,IAAlCC,OAAkC,uEAAF,EAAE;;;;;IAGlCC,kBAASH,aAAT,CAAuB;MAACC,OAAD;MAAUC;IAAV,CAAvB;IAKAD,OAAO,GAAGE,8BAAqBF,OAArB,CAAV;IAGA,MAAMG,SAAS,GAAG,MAAM,KAAKC,WAAL,CAAiB,eAAjB,EAAkC;MACxDC,OAAO,EAAEL,OAD+C;MAExDM,YAAY,QAAEL,OAAO,CAACM,aAAV,MAAuB,IAAvB,IAAuBC,aAAvB,GAAuBA,EAAvB,GAA2B,MAAM,KAAKC,gBAAL,EAFW;MAGxDC,KAAK,EAAET,OAAO,CAACS,KAHyC;MAIxDC,IAAI,EAAEV,OAAO,CAACW;IAJ0C,CAAlC,CAAxB;;IAOA,MAAMC,UAAU,GAAGC,CAAC,CAACC,OAAF,CAAUZ,SAAV,EAAsBa,QAAD,IAAcA,QAAQ,CAACC,KAA5C,CAAnB;;IACA,OAAOJ,UAAU,CAACK,GAAX,CAAeC,2BAAf,EAAsCC,MAAtC,CAA8CvB,SAAD,IAAc;MAChE,OAAOF,cAAc,CAACM,OAAO,CAACL,QAAR,IAAoB,IAArB,EAA2BC,SAA3B,CAArB;IACD,CAFM,CAAP;;AAGD;;AAEDwB,kBAAetB,aAAf","names":["currencyFilter","currency","trustline","specification","getTrustlines","address","options","common_1","responses","_requestAll","account","ledger_index","ledgerVersion","_a","getLedgerVersion","limit","peer","counterparty","trustlines","_","flatMap","response","lines","map","account_trustline_1","filter","exports"],"sourceRoot":"","sources":["../../../src/ledger/trustlines.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}