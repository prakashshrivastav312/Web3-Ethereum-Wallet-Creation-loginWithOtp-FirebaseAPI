{"ast":null,"code":"import * as e from \"@onflow/sdk\";\nimport { config as t, send as r, getTransactionStatus as n, decode as o, resolve as i, createSignableVoucher as a, pipe as s, interaction as u, latestBlock as c } from \"@onflow/sdk\";\nexport { account, arg, args, atBlockHeight, atBlockId, authorization, authorizations, build, config, createSignableVoucher, decode, getAccount, getBlock, getBlockByHeight, getBlockById, getBlockHeader, getCollection, getEvents, getEventsAtBlockHeightRange, getEventsAtBlockIds, getLatestBlock, getTransaction, getTransactionStatus, invariant, isBad, isOk, latestBlock, limit, param, params, payer, ping, pipe, proposer, ref, script, send, transaction, validator, why } from \"@onflow/sdk\";\nimport { invariant as l } from \"@onflow/util-invariant\";\nimport * as d from \"@onflow/types\";\nimport { INIT as f, SUBSCRIBE as h, UNSUBSCRIBE as p, spawn as m, send as v, UPDATED as y, SNAPSHOT as P, subscriber as g, snapshoter as E } from \"@onflow/util-actor\";\nimport { withPrefix as b, sansPrefix as w } from \"@onflow/util-address\";\nexport { display, sansPrefix, withPrefix } from \"@onflow/util-address\";\nimport * as R from \"@onflow/rlp\";\nimport { uid as S } from \"@onflow/util-uid\";\nexport { template as cadence, template as cdc } from \"@onflow/util-template\";\nt().put(\"accessNode.api\", \"http://localhost:8080\").put(\"challenge.handshake\", \"http://localhost:8700/authenticate\");\n\nvar j = \"0.0.73\",\n    I = function (e) {\n  return function (t) {\n    return typeof t === e;\n  };\n},\n    A = function (e) {\n  return null != e;\n},\n    C = I(\"object\"),\n    k = I(\"string\"),\n    T = I(\"function\"),\n    O = I(\"number\");\n\nfunction N(t) {\n  return T(t) ? t(e.arg, d) : [];\n}\n\nvar _ = function (t) {\n  void 0 === t && (t = {});\n\n  try {\n    return Promise.resolve(function (e) {\n      try {\n        return l(A(e.cadence), \"query({ cadence }) -- cadence is required\"), l(k(e.cadence), \"query({ cadence }) -- cadence must be a string\"), Promise.resolve();\n      } catch (e) {\n        return Promise.reject(e);\n      }\n    }(t)).then(function () {\n      return e.send([e.script(t.cadence), e.args(N(t.args || [])), t.limit && \"number\" == typeof t.limit && e.limit(t.limit)]).then(e.decode);\n    });\n  } catch (e) {\n    return Promise.reject(e);\n  }\n};\n\nfunction D() {\n  return (D = Object.assign || function (e) {\n    for (var t = 1; t < arguments.length; t++) {\n      var r = arguments[t];\n\n      for (var n in r) Object.prototype.hasOwnProperty.call(r, n) && (e[n] = r[n]);\n    }\n\n    return e;\n  }).apply(this, arguments);\n}\n\nfunction L(e, t) {\n  (null == t || t > e.length) && (t = e.length);\n\n  for (var r = 0, n = new Array(t); r < t; r++) n[r] = e[r];\n\n  return n;\n}\n\nfunction x(e, t) {\n  var r = \"undefined\" != typeof Symbol && e[Symbol.iterator] || e[\"@@iterator\"];\n  if (r) return (r = r.call(e)).next.bind(r);\n\n  if (Array.isArray(e) || (r = function (e, t) {\n    if (e) {\n      if (\"string\" == typeof e) return L(e, t);\n      var r = Object.prototype.toString.call(e).slice(8, -1);\n      return \"Object\" === r && e.constructor && (r = e.constructor.name), \"Map\" === r || \"Set\" === r ? Array.from(e) : \"Arguments\" === r || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r) ? L(e, t) : void 0;\n    }\n  }(e)) || t && e && \"number\" == typeof e.length) {\n    r && (e = r);\n    var n = 0;\n    return function () {\n      return n >= e.length ? {\n        done: !0\n      } : {\n        done: !1,\n        value: e[n++]\n      };\n    };\n  }\n\n  throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nvar z = {\n  f_type: \"Service\",\n  f_vsn: \"1.0.0\"\n},\n    U = {\n  f_type: \"Identity\",\n  f_vsn: \"1.0.0\"\n},\n    F = {\n  f_type: \"USER\",\n  f_vsn: \"1.0.0\"\n},\n    H = {\n  f_type: \"PollingResponse\",\n  f_vsn: \"1.0.0\"\n},\n    B = {\n  f_type: \"CompositeSignature\",\n  f_vsn: \"1.0.0\"\n};\n\nfunction M(e) {\n  if (null == e) return null;\n\n  switch (e.f_vsn) {\n    case \"1.0.0\":\n      return e;\n\n    default:\n      return D({\n        old: e\n      }, z, {\n        type: \"frame\",\n        endpoint: e.endpoint,\n        params: e.params || {},\n        data: e.data || {}\n      });\n  }\n}\n\nfunction J(e) {\n  if (null == e) return null;\n\n  switch (e.f_vsn) {\n    case \"1.0.0\":\n      return e;\n\n    default:\n      return D({}, z, {\n        type: \"back-channel-rpc\",\n        endpoint: e.endpoint,\n        method: e.method,\n        params: e.params || {},\n        data: e.data || {}\n      });\n  }\n}\n\nvar G = {\n  \"back-channel-rpc\": J,\n  \"pre-authz\": function (e) {\n    if (null == e) return null;\n\n    switch (e.f_vsn) {\n      case \"1.0.0\":\n        return e;\n\n      default:\n        return D({}, z, {\n          type: e.type,\n          uid: e.id,\n          endpoint: e.endpoint,\n          method: e.method,\n          identity: D({}, U, {\n            address: b(e.addr),\n            keyId: e.keyId\n          }),\n          params: e.params,\n          data: e.data\n        });\n    }\n  },\n  authz: function (e) {\n    if (null == e) return null;\n\n    switch (e.f_vsn) {\n      case \"1.0.0\":\n        return e;\n\n      default:\n        return D({}, z, {\n          type: e.type,\n          uid: e.id,\n          endpoint: e.endpoint,\n          method: e.method,\n          identity: D({}, U, {\n            address: b(e.addr),\n            keyId: e.keyId\n          }),\n          params: e.params,\n          data: e.data\n        });\n    }\n  },\n  authn: function (e) {\n    if (null == e) return null;\n\n    switch (e.f_vsn) {\n      case \"1.0.0\":\n        return e;\n\n      default:\n        return D({}, z, {\n          type: e.type,\n          uid: e.id,\n          endpoint: e.authn,\n          id: e.pid,\n          provider: {\n            address: b(e.addr),\n            name: e.name,\n            icon: e.icon\n          }\n        });\n    }\n  },\n  frame: M,\n  \"open-id\": function (e) {\n    if (null == e) return null;\n\n    switch (e.f_vsn) {\n      case \"1.0.0\":\n        return e;\n\n      default:\n        return null;\n    }\n  },\n  \"user-signature\": function (e) {\n    if (null == e) return null;\n\n    switch (e.f_vsn) {\n      case \"1.0.0\":\n        return e;\n\n      default:\n        throw new Error(\"Invalid user-signature service\");\n    }\n  }\n};\n\nfunction q(e) {\n  return R.encode([e.provider.address || e.provider.name || \"UNSPECIFIED\", e.id]).toString(\"hex\");\n}\n\nfunction V(e, t) {\n  return void 0 === e && (e = []), e.find(function (e) {\n    return e.type === t;\n  });\n}\n\nfunction Y(e) {\n  var t = new URL(e.endpoint);\n  if (t.searchParams.append(\"l6n\", window.location.origin), null != e.params) for (var r = 0, n = Object.entries(e.params || {}); r < n.length; r++) {\n    var o = n[r];\n    t.searchParams.append(o[0], o[1]);\n  }\n  return t;\n}\n\nfunction Z(e, t) {\n  void 0 === t && (t = {});\n  var r = t.method || \"POST\",\n      n = \"GET\" === r ? void 0 : JSON.stringify(t.data || e.data || {});\n  return fetch(Y(e), {\n    method: r,\n    headers: D({}, e.headers || {}, t.headers || {}, {\n      \"Content-Type\": \"application/json\"\n    }),\n    body: n\n  }).then(function (e) {\n    return e.json();\n  });\n}\n\nfunction K(e) {\n  if (null == e) return null;\n\n  switch (e.f_vsn) {\n    case \"1.0.0\":\n      return e;\n\n    default:\n      return D({}, H, {\n        status: e.status,\n        reason: e.reason,\n        data: e.compositeSignature || e.data || {},\n        updates: J(e.authorizationUpdates),\n        local: M((e.local || [])[0])\n      });\n  }\n}\n\nfunction $(e) {\n  if (null == e) return null;\n\n  switch (e.f_vsn) {\n    case \"1.0.0\":\n      return e;\n\n    default:\n      return D({}, B, {\n        addr: w(e.addr || e.address),\n        signature: e.signature || e.sig,\n        keyId: e.keyId\n      });\n  }\n}\n\nvar W = \"FCL_IFRAME\",\n    X = function () {},\n    Q = new Set([\"monetizationstart\", \"monetizationpending\", \"monetizationprogress\", \"monetizationstop\"]);\n\nfunction ee(e, t) {\n  if (void 0 === t && (t = {}), null == e) return {\n    send: X,\n    close: X\n  };\n  var r = t.onClose || X,\n      n = t.onMessage || X,\n      o = t.onReady || X,\n      i = t.onResponse || X;\n  window.addEventListener(\"message\", c);\n\n  var a = function (e) {\n    l(!document.getElementById(W), \"Attempt at triggering multiple Frames\", {\n      src: e\n    });\n    var t = document.createElement(\"iframe\");\n    return t.src = e, t.id = W, t.allow = \"usb *; hid *\", t.frameBorder = \"0\", t.style.cssText = \"\\n  position:fixed;\\n  top: 0px;\\n  right: 0px;\\n  bottom: 0px;\\n  left: 0px;\\n  height: 100vh;\\n  width: 100vw;\\n  display:block;\\n  background:rgba(0,0,0,0.25);\\n  z-index: 2147483647;\\n  box-sizing: border-box;\\n\", document.body.append(t), [t, function () {\n      document.getElementById(W) && document.getElementById(W).remove();\n    }];\n  }(Y(e)),\n      s = a[0],\n      u = a[1];\n\n  return {\n    send: f,\n    close: d\n  };\n\n  function c(e) {\n    try {\n      if (\"object\" != typeof e.data) return;\n      if (Q.has(e.data.type)) return;\n      \"FCL:FRAME:CLOSE\" === e.data.type && d(), \"FCL:FRAME:READY\" === e.data.type && o(e, {\n        send: f,\n        close: d\n      }), \"FCL:FRAME:RESPONSE\" === e.data.type && i(e, {\n        send: f,\n        close: d\n      }), n(e, {\n        send: f,\n        close: d\n      }), \"FCL::CHALLENGE::RESPONSE\" === e.data.type && i(e, {\n        send: f,\n        close: d\n      }), \"FCL::AUTHZ_READY\" === e.data.type && o(e, {\n        send: f,\n        close: d\n      }), \"FCL::CHALLENGE::CANCEL\" === e.data.type && d(), \"FCL::CANCEL\" === e.data.type && d();\n    } catch (e) {\n      console.error(\"Frame Callback Error\", e), d();\n    }\n  }\n\n  function d() {\n    try {\n      window.removeEventListener(\"message\", c), u(), r();\n    } catch (e) {\n      console.error(\"Frame Close Error\", e);\n    }\n  }\n\n  function f(e) {\n    try {\n      s.contentWindow.postMessage(JSON.parse(JSON.stringify(e || {})), \"*\");\n    } catch (t) {\n      console.error(\"Frame Send Error\", e, t);\n    }\n  }\n}\n\nvar te,\n    re = function e(t, r) {\n  void 0 === r && (r = function () {\n    return !0;\n  });\n\n  try {\n    if (l(t, \"Missing Polling Service\", {\n      service: t\n    }), !r()) throw new Error(\"Externally Halted\");\n    return Promise.resolve(Z(t, {\n      method: oe(t)\n    }).then(K)).then(function (t) {\n      switch (t.status) {\n        case \"APPROVED\":\n          return t.data;\n\n        case \"DECLINED\":\n          throw new Error(\"Declined: \" + (t.reason || \"No reason supplied.\"));\n\n        default:\n          return Promise.resolve(new Promise(function (e) {\n            return setTimeout(e, 500);\n          })).then(function () {\n            return e(t.updates, r);\n          });\n      }\n    });\n  } catch (e) {\n    return Promise.reject(e);\n  }\n},\n    ne = {\n  \"HTTP/GET\": \"GET\",\n  \"HTTP/POST\": \"POST\"\n},\n    oe = function (e) {\n  return l(ne[e.method], \"Invalid Service Method for type back-channel-rpc\", {\n    service: e\n  }), ne[e.method];\n},\n    ie = function (e, t, r) {\n  try {\n    return t.data = e.data, Promise.resolve(Z(e, {\n      data: t\n    }).then(K)).then(function (t) {\n      if (\"APPROVED\" === t.status) return t.data;\n      if (\"DECLINED\" === t.status) throw new Error(\"Declined: \" + (t.reason || \"No reason supplied.\"));\n\n      if (\"PENDING\" === t.status) {\n        var r = !0,\n            n = ee(t.local, {\n          onClose: function () {\n            r = !1;\n          }\n        }).close;\n        return re(t.updates, function () {\n          return r;\n        }).then(function (e) {\n          return n(), $(e);\n        }).catch(function (e) {\n          throw console.error(e), n(), e;\n        });\n      }\n\n      throw console.error(\"Auto Decline: Invalid Response\", {\n        service: e,\n        resp: t\n      }), new Error(\"Auto Decline: Invalid Response\");\n    });\n  } catch (e) {\n    return Promise.reject(e);\n  }\n},\n    ae = function (e, t, r) {\n  void 0 === r && (r = {});\n\n  try {\n    try {\n      return Promise.resolve(se[e.method](e, t, r));\n    } catch (n) {\n      throw console.error(\"execService(service, msg)\", n, {\n        service: e,\n        msg: t,\n        opts: r\n      }), n;\n    }\n  } catch (e) {\n    return Promise.reject(e);\n  }\n},\n    se = {\n  \"HTTP/RPC\": ie,\n  \"HTTP/POST\": ie,\n  \"IFRAME/RPC\": function (e, t, r) {\n    return new Promise(function (n, o) {\n      var i = S(),\n          a = r.includeOlderJsonRpcCall;\n      t.data = e.data, ee(e, {\n        onReady: function (r, n) {\n          var o = n.send;\n\n          try {\n            o({\n              type: \"FCL:FRAME:READY:RESPONSE\",\n              body: t,\n              service: {\n                params: e.params,\n                data: e.data\n              }\n            }), a && o({\n              jsonrpc: \"2.0\",\n              id: i,\n              method: \"fcl:sign\",\n              params: [t, e.params]\n            });\n          } catch (e) {\n            throw e;\n          }\n        },\n        onResponse: function (e, t) {\n          var r = t.close;\n\n          try {\n            if (\"object\" != typeof e.data) return;\n            var i = K(e.data);\n\n            switch (i.status) {\n              case \"APPROVED\":\n                n($(i.data)), r();\n                break;\n\n              case \"DECLINED\":\n                o(\"Declined: \" + (i.reason || \"No reason supplied\")), r();\n                break;\n\n              default:\n                o(\"Declined: No reason supplied\"), r();\n            }\n          } catch (e) {\n            throw console.error(\"execIframeRPC onResponse error\", e), e;\n          }\n        },\n        onMessage: function (e, t) {\n          var r = t.close;\n\n          try {\n            if (\"object\" != typeof e.data) return;\n            if (\"2.0\" !== e.data.jsonrpc) return;\n            if (e.data.id !== i) return;\n            var a = K(e.data.result);\n\n            switch (a.status) {\n              case \"APPROVED\":\n                n($(a.data)), r();\n                break;\n\n              case \"DECLINED\":\n                o(\"Declined: \" + (a.reason || \"No reason supplied\")), r();\n                break;\n\n              default:\n                o(\"Declined: No reason supplied\"), r();\n            }\n          } catch (e) {\n            throw console.error(\"execIframeRPC onMessage error\", e), e;\n          }\n        },\n        onClose: function () {\n          o(\"Declined: Externally Halted\");\n        }\n      });\n    });\n  }\n};\n\nfunction ue(e, t, r) {\n  if (!e.s) {\n    if (r instanceof de) {\n      if (!r.s) return void (r.o = ue.bind(null, e, t));\n      1 & t && (t = r.s), r = r.v;\n    }\n\n    if (r && r.then) return void r.then(ue.bind(null, e, t), ue.bind(null, e, 2));\n    e.s = t, e.v = r;\n    var n = e.o;\n    n && n(e);\n  }\n}\n\nvar ce = function (e, t) {\n  void 0 === t && (t = {});\n\n  try {\n    return we(), Promise.resolve(he(t)).then(function (t) {\n      var r = V(t.services, \"user-signature\");\n      return l(r, \"Current user must have authorized a signing service.\"), function (t, n) {\n        try {\n          var o = Promise.resolve(ae(r, ke(e)));\n        } catch (e) {\n          return n(e);\n        }\n\n        return o && o.then ? o.then(void 0, n) : o;\n      }(0, function (e) {\n        console.log(e);\n      });\n    });\n  } catch (e) {\n    return Promise.reject(e);\n  }\n},\n    le = function (e) {\n  try {\n    return we(), Promise.resolve(he()).then(function (t) {\n      var r = V(t.services, \"authz\"),\n          n = V(t.services, \"pre-authz\");\n      return D({}, e, n ? {\n        tempId: \"CURRENT_USER\",\n        resolve: function (e, t) {\n          try {\n            return Promise.resolve(ae(n, t)).then(je);\n          } catch (e) {\n            return Promise.reject(e);\n          }\n        }\n      } : {\n        tempId: \"CURRENT_USER\",\n        resolve: null,\n        addr: w(r.identity.address),\n        keyId: r.identity.keyId,\n        sequenceNum: null,\n        signature: null,\n        signingFunction: function (e) {\n          try {\n            return Promise.resolve(ae(r, e, {\n              includeOlderJsonRpcCall: !0\n            }));\n          } catch (e) {\n            return Promise.reject(e);\n          }\n        }\n      });\n    });\n  } catch (e) {\n    return Promise.reject(e);\n  }\n},\n    de = function () {\n  function e() {}\n\n  return e.prototype.then = function (t, r) {\n    var n = new e(),\n        o = this.s;\n\n    if (o) {\n      var i = 1 & o ? t : r;\n\n      if (i) {\n        try {\n          ue(n, 1, i(this.v));\n        } catch (e) {\n          ue(n, 2, e);\n        }\n\n        return n;\n      }\n\n      return this;\n    }\n\n    return this.o = function (e) {\n      try {\n        var o = e.v;\n        1 & e.s ? ue(n, 1, t ? t(o) : o) : r ? ue(n, 1, r(o)) : ue(n, 2, o);\n      } catch (e) {\n        ue(n, 2, e);\n      }\n    }, n;\n  }, e;\n}();\n\nfunction fe(e) {\n  return e instanceof de && 1 & e.s;\n}\n\nvar he = function (e) {\n  void 0 === e && (e = {});\n\n  try {\n    return Promise.resolve(new Promise(function (r, n) {\n      try {\n        return we(), Promise.resolve(Ae()).then(function (n) {\n          if (n.loggedIn && Re(n)) return r(n);\n          var o = e.serviceStrategy || ee;\n          return Promise.resolve(t().get(\"discovery.wallet\")).then(function (e) {\n            function n(e) {\n              o({\n                endpoint: e\n              }, {\n                onReady: function (e, t) {\n                  var r = t.send;\n\n                  try {\n                    return Promise.resolve(pe(/^service\\./)).then(function (e) {\n                      return Promise.resolve(pe(/^app\\.detail\\./)).then(function (t) {\n                        r({\n                          type: \"FCL:AUTHN:CONFIG\",\n                          services: e,\n                          app: t\n                        });\n                      });\n                    });\n                  } catch (e) {\n                    return Promise.reject(e);\n                  }\n                },\n                onClose: function () {\n                  try {\n                    return Promise.resolve(Ae()).then(function (e) {\n                      r(e);\n                    });\n                  } catch (e) {\n                    return Promise.reject(e);\n                  }\n                },\n                onResponse: function (e, t) {\n                  var n = t.close;\n\n                  try {\n                    return Promise.resolve(function (e) {\n                      try {\n                        var t = (e = function (e) {\n                          return e.addr = e.addr ? b(e.addr) : null, e.paddr = e.paddr ? b(e.paddr) : null, e;\n                        }(e)).services || [];\n\n                        return Promise.resolve(function (e, t) {\n                          try {\n                            if (null == e || null == t) return Promise.resolve([]);\n                            var r = new URL(e);\n                            return r.searchParams.append(\"code\", t), Promise.resolve(fetch(r, {\n                              method: \"GET\",\n                              headers: {\n                                \"Content-Type\": \"application/json\"\n                              }\n                            }).then(function (e) {\n                              return e.json();\n                            })).then(function (e) {\n                              if (Array.isArray(e)) return e;\n                              var t = [];\n                              if (Array.isArray(e.authorizations)) for (var r, n = x(e.authorizations); !(r = n()).done;) t.push(D({\n                                type: \"authz\",\n                                keyId: e.keyId\n                              }, r.value));\n                              return null != e.provider && t.push(D({\n                                type: \"authn\",\n                                id: \"wallet-provider#authn\"\n                              }, e.provider)), t;\n                            });\n                          } catch (e) {\n                            return Promise.reject(e);\n                          }\n                        }(e.hks, e.code)).then(function (r) {\n                          var n,\n                              o,\n                              i = (n = t, o = r, void 0 === n && (n = []), void 0 === o && (o = []), [].concat(n, o)).map(function (t) {\n                            return function (e, t) {\n                              try {\n                                return G[e.type](e, t);\n                              } catch (t) {\n                                return console.error(\"Unrecognized FCL Service Type [\" + e.type + \"]\", e, t), e;\n                              }\n                            }(t, e);\n                          }),\n                              a = function (e, t) {\n                            return t.find(function (e) {\n                              return \"authn\" === e.type;\n                            });\n                          }(0, i);\n\n                          return D({}, F, {\n                            addr: b(e.addr),\n                            cid: q(a),\n                            loggedIn: !0,\n                            services: i,\n                            expiresAt: e.exp\n                          });\n                        });\n                      } catch (e) {\n                        return Promise.reject(e);\n                      }\n                    }(e.data)).then(function (e) {\n                      return v(me, ye, e), Promise.resolve(Ae()).then(function (e) {\n                        r(e), n();\n                      });\n                    });\n                  } catch (e) {\n                    return Promise.reject(e);\n                  }\n                }\n              });\n            }\n\n            return e ? n(e) : Promise.resolve(t().get(\"challenge.handshake\")).then(n);\n          });\n        });\n      } catch (e) {\n        return Promise.reject(e);\n      }\n    }));\n  } catch (e) {\n    return Promise.reject(e);\n  }\n},\n    pe = function (e) {\n  try {\n    return Promise.resolve(t().where(e)).then(function (t) {\n      return Object.fromEntries(Object.entries(t).map(function (t) {\n        var r = t[1];\n        return [t[0].replace(e, \"\"), r];\n      }));\n    });\n  } catch (e) {\n    return Promise.reject(e);\n  }\n},\n    me = \"CURRENT_USER\",\n    ve = \"CURRENT_USER/UPDATED\",\n    ye = \"SET_CURRENT_USER\",\n    Pe = '{\\n  \"f_type\": \"User\",\\n  \"f_vsn\": \"1.0.0\",\\n  \"addr\":null,\\n  \"cid\":null,\\n  \"loggedIn\":null,\\n  \"expiresAt\":null,\\n  \"services\":[]\\n}',\n    ge = function (e) {\n  try {\n    return sessionStorage.setItem(me, JSON.stringify(e)), Promise.resolve(e);\n  } catch (e) {\n    return Promise.reject(e);\n  }\n},\n    Ee = function () {\n  return t().get(\"persistSession\", !0);\n},\n    be = ((te = {})[f] = function (e) {\n  try {\n    return e.merge(JSON.parse(Pe)), Promise.resolve(Ee()).then(function (t) {\n      var r = function () {\n        if (t) return Promise.resolve(function () {\n          try {\n            var e = JSON.parse(Pe),\n                t = JSON.parse(sessionStorage.getItem(me));\n            return null != t && e.f_vsn !== t.f_vsn ? (sessionStorage.removeItem(me), Promise.resolve(e)) : Promise.resolve(t || e);\n          } catch (e) {\n            return Promise.reject(e);\n          }\n        }()).then(function (t) {\n          Re(t) && e.merge(t);\n        });\n      }();\n\n      if (r && r.then) return r.then(function () {});\n    });\n  } catch (e) {\n    return Promise.reject(e);\n  }\n}, te[h] = function (e, t) {\n  e.subscribe(t.from), e.send(t.from, ve, D({}, e.all()));\n}, te[p] = function (e, t) {\n  e.unsubscribe(t.from);\n}, te.SNAPSHOT = function (e, t) {\n  try {\n    return t.reply(D({}, e.all())), Promise.resolve();\n  } catch (e) {\n    return Promise.reject(e);\n  }\n}, te[ye] = function (e, t, r) {\n  try {\n    return e.merge(r), Promise.resolve(Ee()).then(function (t) {\n      t && ge(e.all()), e.broadcast(ve, D({}, e.all()));\n    });\n  } catch (e) {\n    return Promise.reject(e);\n  }\n}, te.DEL_CURRENT_USER = function (e, t) {\n  try {\n    return e.merge(JSON.parse(Pe)), Promise.resolve(Ee()).then(function (t) {\n      t && ge(e.all()), e.broadcast(ve, D({}, e.all()));\n    });\n  } catch (e) {\n    return Promise.reject(e);\n  }\n}, te),\n    we = function () {\n  return m(be, me);\n};\n\nfunction Re(e) {\n  return null == e.expiresAt || 0 === e.expiresAt || e.expiresAt > Date.now();\n}\n\nfunction Se() {\n  we(), v(me, \"DEL_CURRENT_USER\");\n}\n\nfunction je(e) {\n  var t = function (e) {\n    return {\n      f_type: \"PreAuthzResponse\",\n      f_vsn: \"1.0.0\",\n      proposer: (e || {}).proposer,\n      payer: (e || {}).payer || [],\n      authorization: (e || {}).authorization || []\n    };\n  }(e),\n      r = [];\n\n  null != t.proposer && r.push([\"PROPOSER\", t.proposer]);\n\n  for (var n, o = x(t.payer || []); !(n = o()).done;) r.push([\"PAYER\", n.value]);\n\n  for (var i, a = x(t.authorization || []); !(i = a()).done;) r.push([\"AUTHORIZER\", i.value]);\n\n  return r.map(function (e) {\n    var t = e[0],\n        r = e[1];\n    return {\n      tempId: [r.identity.address, r.identity.keyId].join(\"|\"),\n      addr: r.identity.address,\n      keyId: r.identity.keyId,\n      signingFunction: function (e) {\n        return ae(r, e);\n      },\n      role: {\n        proposer: \"PROPOSER\" === t,\n        payer: \"PAYER\" === t,\n        authorizer: \"AUTHORIZER\" === t\n      }\n    };\n  });\n}\n\nfunction Ie(e) {\n  we();\n  var t = \"@EXIT\",\n      r = m(function (r) {\n    try {\n      var n;\n      return r.send(me, h), Promise.resolve(function (e, t, r) {\n        for (var n;;) {\n          var o = e();\n          if (fe(o) && (o = o.v), !o) return i;\n\n          if (o.then) {\n            n = 0;\n            break;\n          }\n\n          var i = r();\n\n          if (i && i.then) {\n            if (!fe(i)) {\n              n = 1;\n              break;\n            }\n\n            i = i.s;\n          }\n        }\n\n        var a = new de(),\n            s = ue.bind(null, a, 2);\n        return (0 === n ? o.then(c) : 1 === n ? i.then(u) : (void 0).then(function () {\n          (o = e()) ? o.then ? o.then(c).then(void 0, s) : c(o) : ue(a, 1, i);\n        })).then(void 0, s), a;\n\n        function u(t) {\n          i = t;\n\n          do {\n            if (!(o = e()) || fe(o) && !o.v) return void ue(a, 1, i);\n            if (o.then) return void o.then(c).then(void 0, s);\n            fe(i = r()) && (i = i.v);\n          } while (!i || !i.then);\n\n          i.then(u).then(void 0, s);\n        }\n\n        function c(e) {\n          e ? (i = r()) && i.then ? i.then(u).then(void 0, s) : u(i) : ue(a, 1, i);\n        }\n      }(function () {\n        return !n && 1;\n      }, 0, function () {\n        return Promise.resolve(r.receive()).then(function (o) {\n          if (o.tag === t) return r.send(me, p), void (n = 1);\n          e(o.data);\n        });\n      }));\n    } catch (e) {\n      return Promise.reject(e);\n    }\n  });\n  return function () {\n    return v(r, t);\n  };\n}\n\nfunction Ae() {\n  return we(), v(me, \"SNAPSHOT\", null, {\n    expectReply: !0,\n    timeout: 0\n  });\n}\n\nvar Ce,\n    ke = function (e) {\n  return l(/^[0-9a-f]+$/i.test(e), \"Message must be a hex string\"), {\n    message: e\n  };\n},\n    Te = function () {\n  return {\n    authenticate: he,\n    unauthenticate: Se,\n    authorization: le,\n    signUserMessage: ce,\n    subscribe: Ie,\n    snapshot: Ae\n  };\n},\n    Oe = function (e) {\n  try {\n    return Promise.resolve(r([n(e)]).then(o));\n  } catch (e) {\n    return Promise.reject(e);\n  }\n},\n    Ne = function (e) {\n  return e.status >= 4;\n},\n    _e = function (e) {\n  return e.status >= 3;\n},\n    De = function (e) {\n  return e.status >= 2;\n},\n    Le = ((Ce = {})[f] = function (e) {\n  try {\n    return Promise.resolve(Oe(e.self())).then(function (t) {\n      Ne(t) || setTimeout(function () {\n        return e.sendSelf(\"POLL\");\n      }, 2500), e.merge(t);\n    });\n  } catch (e) {\n    return Promise.reject(e);\n  }\n}, Ce[h] = function (e, t) {\n  e.subscribe(t.from), e.send(t.from, y, e.all());\n}, Ce[p] = function (e, t) {\n  e.unsubscribe(t.from);\n}, Ce[P] = function (e, t) {\n  try {\n    return t.reply(e.all()), Promise.resolve();\n  } catch (e) {\n    return Promise.reject(e);\n  }\n}, Ce.POLL = function (e) {\n  try {\n    return Promise.resolve(Oe(e.self())).then(function (t) {\n      var r, n;\n      Ne(t) || setTimeout(function () {\n        return e.sendSelf(\"POLL\");\n      }, 2500), r = e.all(), n = t, JSON.stringify(r) !== JSON.stringify(n) && e.broadcast(y, t), e.merge(t);\n    });\n  } catch (e) {\n    return Promise.reject(e);\n  }\n}, Ce),\n    xe = function (e) {\n  if (\"object\" == typeof e && (e = e.transactionId), null == e) throw new Error(\"transactionId required\");\n  return e;\n},\n    ze = function (e) {\n  return m(Le, xe(e));\n};\n\nfunction Ue(e) {\n  function t(t) {\n    return g(xe(e), ze, t);\n  }\n\n  function r(e) {\n    return function (r) {\n      void 0 === r && (r = {});\n      var n = r.suppress || !1;\n      return new Promise(function (r, o) {\n        var i = t(function (t) {\n          t.statusCode && !n ? (o(t.errorMessage), i()) : e(t) && (r(t), i());\n        });\n      });\n    };\n  }\n\n  return {\n    snapshot: function () {\n      return E(e, ze);\n    },\n    subscribe: t,\n    onceFinalized: r(De),\n    onceExecuted: r(_e),\n    onceSealed: r(Ne)\n  };\n}\n\nUe.isUnknown = function (e) {\n  return e.status >= 0;\n}, Ue.isPending = function (e) {\n  return e.status >= 1;\n}, Ue.isFinalized = De, Ue.isExecuted = _e, Ue.isSealed = Ne, Ue.isExpired = function (e) {\n  return 5 === e.status;\n};\n\nvar Fe,\n    He = function (t) {\n  void 0 === t && (t = {});\n\n  try {\n    return Promise.resolve(function (r, n) {\n      try {\n        var o = Promise.resolve(function (e) {\n          try {\n            return l(A(e), \"mutate(opts) -- opts is required\"), l(C(e), \"mutate(opts) -- opts must be an object\"), l(A(e.cadence), \"mutate({ cadence }) -- cadence is required\"), l(k(e.cadence), \"mutate({ cadence }) -- cadence must be a string\"), Promise.resolve();\n          } catch (e) {\n            return Promise.reject(e);\n          }\n        }(t)).then(function () {\n          return Promise.resolve(e.config().get(\"fcl.authz\", Te().authorization)).then(function (r) {\n            return e.send([e.transaction(t.cadence), e.args(N(t.args || [])), t.limit && O(t.limit) && e.limit(t.limit), e.proposer(t.proposer || t.authz || r), e.payer(t.payer || t.authz || r), e.authorizations(t.authorizations || [t.authz || r])]).then(e.decode);\n          });\n        });\n      } catch (e) {\n        return n(e);\n      }\n\n      return o && o.then ? o.then(void 0, n) : o;\n    }(0, function (e) {\n      throw e;\n    }));\n  } catch (e) {\n    return Promise.reject(e);\n  }\n},\n    Be = function (e, r) {\n  void 0 === e && (e = []), void 0 === r && (r = {});\n\n  try {\n    return Promise.resolve(t().get(\"sdk.resolve\", r.resolve || i(r))).then(function (t) {\n      function r() {\n        return Promise.resolve(t(e)).then(function (e) {\n          return JSON.stringify(a(e), null, 2);\n        });\n      }\n\n      var n = function () {\n        if (Array.isArray(e)) return Promise.resolve(s(u(), e)).then(function (t) {\n          e = t;\n        });\n      }();\n\n      return n && n.then ? n.then(r) : r();\n    });\n  } catch (e) {\n    return Promise.reject(e);\n  }\n},\n    Me = function (e) {\n  try {\n    var r = setTimeout;\n    return Promise.resolve(t().get(\"fcl.eventPollRate\", 1e4)).then(function (t) {\n      return r(function () {\n        return e.sendSelf(\"TICK\");\n      }, t);\n    });\n  } catch (e) {\n    return Promise.reject(e);\n  }\n},\n    Je = ((Fe = {}).TICK = function (e) {\n  try {\n    if (!e.hasSubs()) return Promise.resolve();\n\n    var t = e.get(\"hwm\"),\n        n = function () {\n      if (null == t) {\n        var n = e.put;\n        return Promise.resolve(c()).then(function (t) {\n          n.call(e, \"hwm\", t);\n          var r = e.put;\n          return Promise.resolve(Me(e)).then(function (t) {\n            r.call(e, \"tick\", t);\n          });\n        });\n      }\n\n      return Promise.resolve(c()).then(function (n) {\n        return e.put(\"hwm\", n), Promise.resolve(r([getEvents(e.self(), t.height, n.height - 1)]).then(o)).then(function (t) {\n          for (var r, n = x(t); !(r = n()).done;) e.broadcast(\"UPDATED\", r.value.data);\n\n          var o = e.put;\n          return Promise.resolve(Me(e)).then(function (t) {\n            o.call(e, \"tick\", t);\n          });\n        });\n      });\n    }();\n\n    return Promise.resolve(n && n.then ? n.then(function () {}) : void 0);\n  } catch (e) {\n    return Promise.reject(e);\n  }\n}, Fe[h] = function (e, t) {\n  try {\n    var r = function () {\n      e.subscribe(t.from);\n    },\n        n = function () {\n      if (!e.hasSubs()) {\n        var t = e.put;\n        return Promise.resolve(Me(e)).then(function (r) {\n          t.call(e, \"tick\", r);\n        });\n      }\n    }();\n\n    return Promise.resolve(n && n.then ? n.then(r) : r());\n  } catch (e) {\n    return Promise.reject(e);\n  }\n}, Fe[p] = function (e, t) {\n  e.unsubscribe(t.from), e.hasSubs() || (clearTimeout(e.get(\"tick\")), e.delete(\"tick\"), e.delete(\"hwm\"));\n}, Fe),\n    Ge = function (e) {\n  return m(Je, e);\n};\n\nfunction qe(e) {\n  return {\n    subscribe: function (t) {\n      return g(e, Ge, t);\n    }\n  };\n}\n\nvar Ve = function (e) {\n  return Te().authenticate(e);\n},\n    Ye = function () {\n  return Te().unauthenticate();\n},\n    Ze = function () {\n  return Te().unauthenticate(), Te().authenticate();\n},\n    Ke = function (e) {\n  return Te().authenticate();\n},\n    $e = function (e) {\n  return Te().authenticate();\n},\n    We = Te().authorization,\n    Xe = d;\n\nexport { j as VERSION, Ve as authenticate, We as authz, Te as currentUser, qe as events, $e as logIn, He as mutate, _ as query, Ze as reauthenticate, Be as serialize, Ke as signUp, Xe as t, Ue as tx, Ye as unauthenticate };","map":{"version":3,"mappings":";;;;;;;;;;;AAEAA,IACGC,GADHD,CACO,gBADPA,EACyB,uBADzBA,EAEGC,GAFHD,CAEO,qBAFPA,EAE8B,oCAF9BA;;ACFaE,QAAU,QAAVA;AAAAA,ICAPC,IAAK;EAAAC,iBAAQC,CAARD,EAAQC;IAAAA,cAAYA,CAAZA,KAAkBD,CAAlBC;EAAkBD,CAA1BA;AAA0BA,CDAxBF;AAAAA,ICEAI,IAAa;EAAAD,OAAU,QAALA,CAALA;AAAKA,CDFlBH;AAAAA,ICGAK,IAAWJ,EAAG,QAAHA,CDHXD;AAAAA,ICIAM,IAAWL,EAAG,QAAHA,CDJXD;AAAAA,ICKAO,IAASN,EAAG,UAAHA,CDLTD;AAAAA,ICMAQ,IAAWP,EAAG,QAAHA,CDNXD;;ACMc,SCFXS,CDEW,CCFGC,CDEH,ECFGA;EAC5B,OAAIH,EAAOG,CAAPH,IAAmBG,EAAGC,EAAIC,GAAPF,EAAYG,CAAZH,CAAnBH,GACG,EADP;AACO;;AAAA,ICoCaO,cAAMC,CAAND,EAAMC;EAAAA,qBAAO,EAAPA;;EAAO;IAAA,iCAWXA,CAXW,EAWXA;MAAAA;QAAM,OAC5BC,EACEZ,EAAWW,EAAKE,OAAhBb,CADFY,EAEE,2CAFFA,GAKAA,EACEV,EAASS,EAAKE,OAAdX,CADFU,EAEE,gDAFFA,CALAA,EAOEE,iBAR0B;MAQ1B,CARoBH,CAQpB;QAAA;MAAA;IAlBII,CAD2B,CAClBJ,CADkB,GAClBA,IADkB,CAClBA;MAGf,OAAOJ,EAAIS,IAAJT,CAAS,CACdA,EAAIU,MAAJV,CAAWI,EAAKE,OAAhBN,CADc,EAEdA,EAAIW,IAAJX,CAASF,EAAcM,EAAKO,IAALP,IAAa,EAA3BN,CAATE,CAFc,EAGdI,EAAKQ,KAALR,IAAoC,mBAAfA,EAAKQ,KAA1BR,IAAgDJ,EAAIY,KAAJZ,CAAUI,EAAKQ,KAAfZ,CAHlC,CAATA,EAIJa,IAJIb,CAICA,EAAIc,MAJLd,CAAP;IAIYc,CARqB;EAAnC,CAAmC,CAAnC;IAAA;EAAA;AAAA,CDpCS;;ACoCT;EAAA;IAAA;MAAA;;MAAA;IAAA;;IAAA;EAAA;AAAA;;AAAA;EAAA;;EAAA;;EAAA;AAAA;;AAAA;EAAA;EAAA;;EAAA;IAAA;MAAA;MAAA;MAAA;IAAA;EAAA;IAAAC;IAAA;IAAA;MAAA;QAAAC;MAAA;QAAAA;QAAAC;MAAA;IAAA;EAAA;;EAAA;AAAA;;AAAA,IC1CaC,IAAiB;EAC5BC,QAAQ,SADoB;EAE5BC,OAAO;AAFqB,CD0C9B;AAAA,ICrCaC,IAAkB;EAC7BF,QAAQ,UADqB;EAE7BC,OAAO;AAFsB,CDqC/B;AAAA,IC3BaE,IAAc;EACzBH,QAAQ,MADiB;EAEzBC,OAAO;AAFkB,CD2B3B;AAAA,ICtBaG,IAA0B;EACrCJ,QAAQ,iBAD6B;EAErCC,OAAO;AAF8B,CDsBvC;AAAA,ICjBaI,IAA6B;EACxCL,QAAQ,oBADgC;EAExCC,OAAO;AAFiC,CDiB1C;;ACfS,SCjBOK,CDiBP,CCjBsBC,CDiBtB,ECjBsBA;EAC7B,IAAe,QAAXA,CAAJ,EAAqB;;EAErB,QAAQA,EAAON,KAAf;IACE,KAAK,OAAL;MACE,OAAOM,CAAP;;IAEF;MACE;QACEC,KAAKD;MADP,GAEKR,CAFL,EAEKA;QACH3B,MAAM,OADH2B;QAEHU,UAAUF,EAAQE,QAFfV;QAGHW,QAAQH,EAAQG,MAARH,IAAkB,EAHvBR;QAIHY,MAAMJ,EAAQI,IAARJ,IAAgB;MAJnBR,CAFL;EALJ;AAW4B;;AAAA,SCbda,CDac,CCbUL,CDaV,ECbUA;EACtC,IAAe,QAAXA,CAAJ,EAAqB;;EAErB,QAAQA,EAAON,KAAf;IACE,KAAK,OAAL;MACE,OAAOM,CAAP;;IAEF;MACE,aACKR,CADL,EACKA;QACH3B,MAAM,kBADH2B;QAEHU,UAAUF,EAAQE,QAFfV;QAGHc,QAAQN,EAAQM,MAHbd;QAIHW,QAAQH,EAAQG,MAARH,IAAkB,EAJvBR;QAKHY,MAAMJ,EAAQI,IAARJ,IAAgB;MALnBR,CADL;EALJ;ACFF;;AAAA,IAAMe,IAAqB;EACzBC,oBAAoBH,CADK;EAEzBI,uBCGgCT,CDHhCS,ECGgCT;IAChC,IAAe,QAAXA,CAAJ,EAAqB;;IAErB,QAAQA,EAAON,KAAf;MACE,KAAK,OAAL;QACE,OAAOM,CAAP;;MAEF;QACE,aACKR,CADL,EACKA;UACH3B,MAAMmC,EAAQnC,IADX2B;UAEHkB,KAAKV,EAAQW,EAFVnB;UAGHU,UAAUF,EAAQE,QAHfV;UAIHc,QAAQN,EAAQM,MAJbd;UAKHoB,gBACKjB,CADLiB,EACKjB;YACHkB,SAASC,EAAWd,EAAQe,IAAnBD,CADNnB;YAEHqB,OAAOhB,EAAQgB;UAFZrB,CADLiB,CALGpB;UAUHW,QAAQH,EAAQG,MAVbX;UAWHY,MAAMJ,EAAQI;QAXXZ,CADL;IALJ;EAiBoBY,CDzBK;EAGzBa,iBEE6BjB,CFF7BiB,EEE6BjB;IAC7B,IAAe,QAAXA,CAAJ,EAAqB;;IAErB,QAAQA,EAAON,KAAf;MACE,KAAK,OAAL;QACE,OAAOM,CAAP;;MAEF;QACE,aACKR,CADL,EACKA;UACH3B,MAAMmC,EAAQnC,IADX2B;UAEHkB,KAAKV,EAAQW,EAFVnB;UAGHU,UAAUF,EAAQE,QAHfV;UAIHc,QAAQN,EAAQM,MAJbd;UAKHoB,gBACKjB,CADLiB,EACKjB;YACHkB,SAASC,EAAWd,EAAQe,IAAnBD,CADNnB;YAEHqB,OAAOhB,EAAQgB;UAFZrB,CADLiB,CALGpB;UAUHW,QAAQH,EAAQG,MAVbX;UAWHY,MAAMJ,EAAQI;QAXXZ,CADL;IALJ;EAiBoBY,CFzBK;EAIzBc,iBGI6BlB,CHJ7BkB,EGI6BlB;IAC7B,IAAe,QAAXA,CAAJ,EAAqB;;IAErB,QAAQA,EAAON,KAAf;MACE,KAAK,OAAL;QACE,OAAOM,CAAP;;MAEF;QACE,aACKR,CADL,EACKA;UACH3B,MAAMmC,EAAQnC,IADX2B;UAEHkB,KAAKV,EAAQW,EAFVnB;UAGHU,UAAUF,EAAQkB,KAHf1B;UAIHmB,IAAIX,EAAQmB,GAJT3B;UAKH4B,UAAU;YACRP,SAASC,EAAWd,EAAQe,IAAnBD,CADD;YAERO,MAAMrB,EAAQqB,IAFN;YAGRC,MAAMtB,EAAQsB;UAHN;QALP9B,CADL;IALJ;EAcsB8B,CHzBG;EAKzBC,OAAOxB,CALkB;EAMzByB,qBIuB8BxB,CJvB9BwB,EIuB8BxB;IAC9B,IAAe,QAAXA,CAAJ,EAAqB;;IAErB,QAAQA,EAAON,KAAf;MACE,KAAK,OAAL;QACE,OAAOM,CAAP;;MAEF;QACE;IALJ;EAKI,CJrCqB;EAOzByB,4BKLqCzB,CLKrCyB,EKLqCzB;IACrC,IAAe,QAAXA,CAAJ,EAAqB;;IAErB,QAAQA,EAAON,KAAf;MACE,KAAK,OAAL;QACE,OAAOM,CAAP;;MAEF;QACE,UAAU0B,KAAV,CAAgB,gCAAhB;IALJ;EAKoB;ALVK,CAA3B;;AMLA,SAASC,CAAT,CAA2BT,CAA3B,EAA2BA;EACzB,OAAOU,EACJC,MADID,CACG,CACNV,EAAME,QAANF,CAAeL,OAAfK,IAA0BA,EAAME,QAANF,CAAeG,IAAzCH,IAAiD,aAD3C,EAENA,EAAMP,EAFA,CADHiB,EAKJE,QALIF,CAKK,KALLA,CAAP;AAKY;;AAAA,SCbEG,CDaF,CCbgBC,CDahB,ECb+BnE,CDa/B,ECb+BA;EAC3C,kBAD4BmE,CAC5B,KAD4BA,IAAW,EACvC,GAAOA,EAASC,IAATD,CAAc;IAAAhC,OAAWA,EAAQnC,IAARmC,KAAiBnC,CAA5BmC;EAA4BnC,CAA1CmE,CAAP;AAAiDnE;;AAAAA,SCDnCqE,CDCmCrE,CCDnBmC,CDCmBnC,ECDnBmC;EAC9B,IAAMmC,IAAM,IAAIC,GAAJ,CAAQpC,EAAQE,QAAhB,CAAZ;EAEA,IADAiC,EAAIE,YAAJF,CAAiBG,MAAjBH,CAAwB,KAAxBA,EAA+BI,OAAOC,QAAPD,CAAgBE,MAA/CN,GACsB,QAAlBnC,EAAQG,MAAZ,EACE,oBAAyBuC,OAAOC,OAAPD,CAAe1C,EAAQG,MAARH,IAAkB,EAAjC0C,CAAzB,EAA0DrD,YAA1D,EAA0DA,GAA1D,EAA+D;IAA1D;IACH8C,EAAIE,YAAJF,CAAiBG,MAAjBH,CAAiBG,IAAjBH,EAAiBG,IAAjBH;EAGJ;EAAA,OAAOA,CAAP;AAAOA;;AAAAA,SCNOS,CDMPT,CCNoBnC,CDMpBmC,ECN6BzD,CDM7ByD,ECN6BzD;EAAAA,qBAAO,EAAPA;EACpC,IAAM4B,IAAS5B,EAAK4B,MAAL5B,IAAe,MAA9B;EAAA,IACMmE,IACO,UAAXvC,CAAW,GAAXA,KACIwC,CADO,GAEPC,KAAKC,SAALD,CAAerE,EAAK0B,IAAL1B,IAAasB,EAAQI,IAArB1B,IAA6B,EAA5CqE,CAJN;EAMA,OAAOE,MAAMf,EAAgBlC,CAAhBkC,CAANe,EAAgC;IACrC3C,QAAQA,CAD6B;IAErC4C,eACMlD,EAAQkD,OAARlD,IAAmB,EADzBkD,EAEMxE,EAAKwE,OAALxE,IAAgB,EAFtBwE,EAEsB;MACpBC,gBAAgB;IADI,CAFtBD,CAFqC;IAOrCL,MAAMA;EAP+B,CAAhCI,EAQJ9D,IARI8D,CAQC,UAACnF,CAAD,EAACA;IAAAA,OAAMA,EAAEsF,IAAFtF,EAANA;EAAQsF,CARVH,CAAP;AAQiBG;;AAAAA,SCJHC,CDIGD,CCJsBE,CDItBF,ECJsBE;EACvC,IAAY,QAARA,CAAJ,EAAkB;;EAElB,QAAQA,EAAI5D,KAAZ;IACE,KAAK,OAAL;MACE,OAAO4D,CAAP;;IAEF;MACE,aACKzD,CADL,EACKA;QACH0D,QAAQD,EAAKC,MADV1D;QAEH2D,QAAQF,EAAKE,MAFV3D;QAGHO,MAAMkD,EAAKG,kBAALH,IAA2BA,EAAKlD,IAAhCkD,IAAwC,EAH3CzD;QAIH6D,SAASrD,EAAwBiD,EAAKK,oBAA7BtD,CAJNR;QAKH+D,OAAO7D,GAAgBuD,EAAKM,KAALN,IAAc,EAA9BvD,EAAkC,CAAlCA;MALJF,CADL;EALJ;AAW+C;;AAAA,SCjBjCgE,CDiBiC,CCjBLP,CDiBK,ECjBLA;EAC1C,IAAY,QAARA,CAAJ,EAAkB;;EAElB,QAAQA,EAAI5D,KAAZ;IACE,KAAK,OAAL;MACE,OAAO4D,CAAP;;IAEF;MACE,aACKxD,CADL,EACKA;QACHiB,MAAM+C,EAAWR,EAAKvC,IAALuC,IAAaA,EAAKzC,OAA7BiD,CADHhE;QAEHiE,WAAWT,EAAKS,SAALT,IAAkBA,EAAKU,GAF/BlE;QAGHkB,OAAOsC,EAAKtC;MAHTlB,CADL;EALJ;ACXF;;AAAA,IAAMmE,IAAQ,YAAd;AAAA,ICMMC,IAAO,cDNb;AAAA,ICQMC,IAAS,IAAIC,GAAJ,CAAQ,CACrB,mBADqB,EAErB,qBAFqB,EAGrB,sBAHqB,EAIrB,kBAJqB,CAAR,CDRf;;ACYE,SAGc7C,EAHd,CAGoBvB,CAHpB,EAG6BtB,CAH7B,EAG6BA;EAC7B,eAD6BA,CAC7B,KAD6BA,IAAO,EACpC,GAAe,QAAXsB,CAAJ,EAAqB,OAAO;IAACjB,MAAMmF,CAAP;IAAaG,OAAOH;EAApB,CAAP;EAErB,IACMI,IAAU5F,EAAK4F,OAAL5F,IAAgBwF,CADhC;EAAA,IAEMK,IAAY7F,EAAK6F,SAAL7F,IAAkBwF,CAFpC;EAAA,IAGMM,IAAU9F,EAAK8F,OAAL9F,IAAgBwF,CAHhC;EAAA,IAIMO,IAAa/F,EAAK+F,UAAL/F,IAAmBwF,CAJtC;EAMA3B,OAAOmC,gBAAPnC,CAAwB,SAAxBA,EAAmCoC,CAAnCpC;;EACA,kBDT0BqC,CCS1B,EDT0BA;IAC1BjG,GACGkG,SAASC,cAATD,CAAwBZ,CAAxBY,CADHlG,EAEE,uCAFFA,EAGE;MAACiG;IAAD,CAHFjG;IAMA,IAAMoG,IAASF,SAASG,aAATH,CAAuB,QAAvBA,CAAf;IAcA,OAbAE,EAAOH,GAAPG,GAAaH,CAAbG,EACAA,EAAOpE,EAAPoE,GAAYd,CADZc,EAEAA,EAAOE,KAAPF,GAAe,cAFfA,EAGAA,EAAOG,WAAPH,GAAqB,GAHrBA,EAIAA,EAAOI,KAAPJ,CAAaK,OAAbL,GAAaK,yNAJbL,EAKAF,SAAShC,IAATgC,CAAcvC,MAAduC,CAAqBE,CAArBF,CALAE,EAaO,CAACA,CAAD,EANS;MACVF,SAASC,cAATD,CAAwBZ,CAAxBY,KACFA,SAASC,cAATD,CAAwBZ,CAAxBY,EAA+BQ,MAA/BR,EADEA;IAC6BQ,CAI5B,CAAP;ECZ0BC,CAA1B,CAAsCpD,EAAgBlC,CAAhBkC,CAAtC;EAAA,IAAO6C,QAAP;EAAA,IAAeQ,QAAf;;EACA,OAAO;IAACxG,OAAD;IAAOsF;EAAP,CAAP;;EAEA,SAASM,CAAT,CAAkBa,CAAlB,EAAkBA;IAChB;MACE,IAAsB,mBAAXA,EAAEpF,IAAb,EAAgC;MAChC,IAAI+D,EAAOsB,GAAPtB,CAAWqB,EAAEpF,IAAFoF,CAAO3H,IAAlBsG,CAAJ,EAA6B;MA9Bf,sBA+BVqB,EAAEpF,IAAFoF,CAAO3H,IA/BG,IA+BmBwG,GA/BnB,EACA,sBA+BVmB,EAAEpF,IAAFoF,CAAO3H,IA/BG,IA+BmB2G,EAAQgB,CAARhB,EAAW;QAACzF,OAAD;QAAOsF;MAAP,CAAXG,CAhCnB,EAEG,yBA+BbgB,EAAEpF,IAAFoF,CAAO3H,IA/BM,IA+BmB4G,EAAWe,CAAXf,EAAc;QAAC1F,OAAD;QAAOsF;MAAP,CAAdI,CAjCtB,EAkCdF,EAAUiB,CAAVjB,EAAa;QAACxF,OAAD;QAAOsF;MAAP,CAAbE,CAlCc,EAqCM,+BAAhBiB,EAAEpF,IAAFoF,CAAO3H,IAAS,IAClB4G,EAAWe,CAAXf,EAAc;QAAC1F,OAAD;QAAOsF;MAAP,CAAdI,CAtCY,EAwCM,uBAAhBe,EAAEpF,IAAFoF,CAAO3H,IAAS,IAAoB2G,EAAQgB,CAARhB,EAAW;QAACzF,OAAD;QAAOsF;MAAP,CAAXG,CAxC1B,EAyCM,6BAAhBgB,EAAEpF,IAAFoF,CAAO3H,IAAS,IAA0BwG,GAzChC,EA0CM,kBAAhBmB,EAAEpF,IAAFoF,CAAO3H,IAAS,IAAewG,GA1CrB;IA2Cd,CAfF,CAeE,OAAOqB,CAAP,EAAOA;MACPC,QAAQD,KAARC,CAAc,sBAAdA,EAAsCD,CAAtCC,GACAtB,GADAsB;IACAtB;EAIJ;;EAAA,SAASA,CAAT,GAASA;IACP;MACE9B,OAAOqD,mBAAPrD,CAA2B,SAA3BA,EAAsCoC,CAAtCpC,GAEAgD,GAFAhD,EAGA+B,GAHA/B;IAIA,CALF,CAKE,OAAOmD,CAAP,EAAOA;MACPC,QAAQD,KAARC,CAAc,mBAAdA,EAAmCD,CAAnCC;IAAmCD;EAIvC;;EAAA,SAAS3G,CAAT,CAAc8G,CAAd,EAAcA;IACZ;MACEd,EAAOe,aAAPf,CAAqBgB,WAArBhB,CACEhC,KAAKiD,KAALjD,CAAWA,KAAKC,SAALD,CAAe8C,KAAO,EAAtB9C,CAAXA,CADFgC,EAEE,GAFFA;IAIA,CALF,CAKE,OAAOW,CAAP,EAAOA;MACPC,QAAQD,KAARC,CAAc,kBAAdA,EAAkCE,CAAlCF,EAAuCD,CAAvCC;IAAuCD;EAAAA;AAAAA;;AAAAA;AAAAA,IC5CvBO,gBAAKjG,CAALiG,EAAcC,CAAdD,EAAcC;EAAAA,qBAAc;IAAA;EAAA,CAAdA;;EAAc;IAEhD,IADAvH,EAAUqB,CAAVrB,EAAmB,yBAAnBA,EAA8C;MAACqB;IAAD,CAA9CrB,GAA+CqB,CAC1CkG,GAAL,EAAoB,UAAUxE,KAAV,CAAgB,mBAAhB;IAFwC,uBAIzCkB,EAAa5C,CAAb4C,EAAsB;MACvCtC,QAAQ6F,GAAcnG,CAAdmG;IAD+B,CAAtBvD,EAEhBzD,IAFgByD,CAEXS,CAFWT,CAJyC,EAMpDS,IANoD,CAMpDA,UAFFC,CAEED,EAFFC;MAIN,QAAQA,EAAKC,MAAb;QACE,KAAK,UAAL;UACE,OAAOD,EAAKlD,IAAZ;;QACF,KAAK,UAAL;UACE,UAAUsB,KAAV,CAAUA,gBAAmB4B,EAAKE,MAALF,IAAe,qBAAlC5B,CAAV;;QACF;UAAA,uBACQ,IAAI7C,OAAJ,CAAY;YAAAQ,OAAK+G,WAAW/G,CAAX+G,EAAc,GAAdA,CAAL/G;UAAmB,CAA/B,CADR,EACuCF,IADvC,CACuC;YACrC,OAAO8G,EAAK3C,EAAKI,OAAVuC,EAAmBC,CAAnBD,CAAP;UAA0BC,CAF5B;MALF;IAO8BA,CAf8B;EAA9D,CAAkD,CAAlD;IAAA;EAAA;AAAA,CD4C6CR;AAAAA,ICjEvCW,KAAU;EACdC,YAAY,KADE;EAEdC,aAAa;AAFC,CDiE6Bb;AAAAA,IC5DvCS,KAAgB;EAMpB,OALAxH,EACE0H,GAAQrG,EAAQM,MAAhB+F,CADF1H,EAEE,kDAFFA,EAGE;IAACqB;EAAD,CAHFrB,GAKO0H,GAAQrG,EAAQM,MAAhB+F,CAAP;AAAuB/F,CDsDoBoF;AAAAA,IE/DvBc,eAAaxG,CAAbwG,EAAsBC,CAAtBD,EAAgC9H,CAAhC8H,EAAgC9H;EAAAA;IAAM,OAC1D+H,EAASrG,IAATqG,GAAgBzG,EAAQI,IAAxBqG,EAAwBrG,gBACLwC,EAAa5C,CAAb4C,EAAsB;MACvCxC,MAAMqG;IADiC,CAAtB7D,EAEhBzD,IAFgByD,CAEXS,CAFWT,CADKxC,EAGhBiD,IAHgBjD,CAGhBiD,UAFFC,CAEED,EAFFC;MAAAA,IAIc,eAAhBA,EAAKC,MAJHD,EAKJ,OAAOA,EAAKlD,IAAZ;MAAYA,IACa,eAAhBkD,EAAKC,MADFnD,EAEZ,UAAUsB,KAAV,CAAUA,gBAAmB4B,EAAKE,MAALF,IAAe,qBAAlC5B,CAAV;;MAA4C,IACnB,cAAhB4B,EAAKC,MAD8B,EACR;QACpC,IAAI2C,KAAc,CAAlB;QAAA,IACcQ,IAAcnF,GAAM+B,EAAKM,KAAXrC,EAAkB;UAC5C+C;YACE4B,KAAc,CAAdA;UAAc;QAF4B,CAAlB3E,EAArB8C,KADP;QAOA,OAAO4B,GAAK3C,EAAKI,OAAVuC,EAAmB;UAAA,OAAMC,CAAN;QAAMA,CAAzBD,EACJ9G,IADI8G,CACC;UAEJ,OADAS,KACO7C,EAA4BJ,CAA5BI,CAAP;QAAmCJ,CAHhCwC,EAGgCxC,KAHhCwC,CAKE;UAGL,MAFAN,QAAQD,KAARC,CAAcD,CAAdC,GACAe,GADAf,EAEMD,CAAN;QAAMA,CARHO,CAAP;MAYA;;MAAA,MADAN,QAAQD,KAARC,CAAQD,gCAARC,EAAgD;QAAC3F,UAAD;QAAUsD;MAAV,CAAhDqC,GAA0DrC,IAChD5B,KADgD4B,CAChD5B,gCADgD4B,CAC1D;IAAU5B,CA7BYtB,CADkC;EAA5D,CAAsD1B,CAAtD;IAAA;EAAA;AAAA,CF+D6CgH;AAAAA,IG7DvBiB,eAAY3G,CAAZ2G,EAAqBd,CAArBc,EAA0BjI,CAA1BiI,EAA0BjI;EAAAA,qBAAO,EAAPA;;EAAO;IACrD;MACE,uBAAOkI,GAAW5G,EAAQM,MAAnBsG,EAA2B5G,CAA3B4G,EAAoCf,CAApCe,EAAyClI,CAAzCkI,CAAP;IACA,CAFF,CAEE,OAAOlB,CAAP,EAAOA;MAEP,MADAC,QAAQD,KAARC,CAAc,2BAAdA,EAA2CD,CAA3CC,EAAkD;QAAC3F,UAAD;QAAU6F,MAAV;QAAenH;MAAf,CAAlDiH,GACMD,CAAN;IAAMA;EALV,CAAuD,CAAvD;IAAA;EAAA;AAAA,CH6D6CA;AAAAA,IGnEvCkB,KAAa;EACjBC,YAAYL,EADK;EAEjBD,aAAaC,EAFI;EAGjBM,wBCD4B9G,CDC5B8G,ECDqCjE,CDCrCiE,ECD2CpI,CDC3CoI,ECD2CpI;IAC3C,WAAWG,OAAX,CAAmB,UAACkI,CAAD,EAAUC,CAAV,EAAUA;MAC3B,IAAMrG,IAAKD,GAAX;MAAA,IACMuG,IAA0BvI,EAAKuI,uBADrC;MAGApE,EAAKzC,IAALyC,GAAY7C,EAAQI,IAApByC,EAEAtB,GAAMvB,CAANuB,EAAe;QACbiD,mBAAQ0C,CAAR1C,EAAQ0C,CAAR1C,EAAQ0C;UAAAA,IAAInI,UAAJmI;;UACN;YACEnI,EAAK;cACHlB,MAAM,0BADH;cAEHgF,OAFG;cAGH7C,SAAS;gBACPG,QAAQH,EAAQG,MADT;gBAEPC,MAAMJ,EAAQI;cAFP;YAHN,CAALrB,GAQIkI,KACFlI,EAAK;cACHoI,SAAS,KADN;cAEHxG,IAAIA,CAFD;cAGHL,QAAQ,UAHL;cAIHH,QAAQ,CAAC0C,CAAD,EAAO7C,EAAQG,MAAf;YAJL,CAALpB,CATFA;UAgBA,CAjBF,CAiBE,OAAO2G,CAAP,EAAOA;YACP,MAAMA,CAAN;UAAMA;QAAAA,CApBG;QAwBbjB,sBAAWe,CAAXf,EAAWe,CAAXf,EAAWe;UAAIzG,IAAMsF,WAANtF;;UACb;YACE,IAAsB,mBAAXyG,EAAEpF,IAAb,EAAgC;YAChC,IAAMkD,IAAOD,EAAyBmC,EAAEpF,IAA3BiD,CAAb;;YAEA,QAAQC,EAAKC,MAAb;cACE,KAAK,UAAL;gBACEwD,EAAQlD,EAA4BP,EAAKlD,IAAjCyD,CAARkD,GACA1C,GADA0C;gBAEA;;cAEF,KAAK,UAAL;gBACEC,kBAAoB1D,EAAKE,MAALF,IAAe,oBAAnC0D,IACA3C,GADA2C;gBAEA;;cAEF;gBACEA,mCACA3C,GADA2C;YAZJ;UAgBA,CApBF,CAoBE,OAAOtB,CAAP,EAAOA;YAEP,MADAC,QAAQD,KAARC,CAAc,gCAAdA,EAAgDD,CAAhDC,GACMD,CAAN;UAAMA;QAAAA,CA/CG;QAmDbnB,qBAAUiB,CAAVjB,EAAUiB,CAAVjB,EAAUiB;UAAAA,IAAInB,WAAJmB;;UACR;YACE,IAAsB,mBAAXA,EAAEpF,IAAb,EAAgC;YAChC,IAAuB,UAAnBoF,EAAEpF,IAAFoF,CAAO2B,OAAX,EAA8B;YAC9B,IAAI3B,EAAEpF,IAAFoF,CAAO7E,EAAP6E,KAAc7E,CAAlB,EAAsB;YACtB,IAAM2C,IAAOD,EAAyBmC,EAAEpF,IAAFoF,CAAO4B,MAAhC/D,CAAb;;YAEA,QAAQC,EAAKC,MAAb;cACE,KAAK,UAAL;gBACEwD,EAAQlD,EAA4BP,EAAKlD,IAAjCyD,CAARkD,GACA1C,GADA0C;gBAEA;;cAEF,KAAK,UAAL;gBACEC,kBAAoB1D,EAAKE,MAALF,IAAe,oBAAnC0D,IACA3C,GADA2C;gBAEA;;cAEF;gBACEA,mCACA3C,GADA2C;YAZJ;UAgBA,CAtBF,CAsBE,OAAOtB,CAAP,EAAOA;YAEP,MADAC,QAAQD,KAARC,CAAc,+BAAdA,EAA+CD,CAA/CC,GACMD,CAAN;UAAMA;QAAAA,CA5EG;QAgFbpB;UACE0C;QAAAA;MAjFW,CAAfzF,CAFAsB;IAmFImE,CAvFN;EAuFMA;AD1FW,CHmE0BtB;;AK/BtC,YAAiB2B,CAAjB,EAAuBC,CAAvB,EAA8B/H,CAA9B,EAA8BA;EACpC,KAAK8H,EAAKE,CAAV,EAAa;IACZ,IAAIhI,eAAJ,EAA4B;MAC3B,KAAIA,EAAMgI,CAAV,EAOC,aADAhI,EAAMiI,CAANjI,GAAUkI,GAAQC,IAARD,CAAa,IAAbA,EAAmBJ,CAAnBI,EAAyBH,CAAzBG,CACV;MANY,IAARH,CAAQ,KACXA,IAAQ/H,EAAMgI,CADH,GAGZhI,IAAQA,EAAMoI,CAHF;IASd;;IAAA,IAAIpI,KAASA,EAAMJ,IAAnB,EAEC,YADAI,EAAMJ,IAANI,CAAWkI,GAAQC,IAARD,CAAa,IAAbA,EAAmBJ,CAAnBI,EAAyBH,CAAzBG,CAAXlI,EAA4CkI,GAAQC,IAARD,CAAa,IAAbA,EAAmBJ,CAAnBI,EAAyB,CAAzBA,CAA5ClI,CACA;IAED8H,EAAKE,CAALF,GAASC,CAATD,EACAA,EAAKM,CAALN,GAAS9H,CADT8H;IAEA,IAAMO,IAAWP,EAAKG,CAAtB;IACII,KACHA,EAASP,CAATO,CADGA;EACMP;AAAAA;;AAAAA,IAgLGQ,eAAgBhC,CAAhBgC,EAAqBnJ,CAArBmJ,EAAqBnJ;EAAAA,qBAAO,EAAPA;;EAAO;IAAI,OAC7CoJ,sBACmBC,GAAarJ,CAAbqJ,CADnBD,EACgCpJ,IADhCoJ,CACgCpJ,UAA1BsJ,CAA0BtJ,EAA1BsJ;MACN,IAAMC,IAAiBlG,EAAciG,EAAKhG,QAAnBD,EAA6B,gBAA7BA,CAAvB;MAH6C,OAK7CpD,EACEsJ,CADFtJ,EAEE,sDAFFA,GAiUK,UAAgBkE,CAAhB,EAAsBqF,CAAtB,EAAsBA;QAC5B;UACC,IAAId,oBA7TWT,GAAYsB,CAAZtB,EAA4BwB,GAAatC,CAAbsC,CAA5BxB,CA6TXS,CAAJ;QACC,CAFF,CAEE,OAAM5B,CAAN,EAAMA;UACP,OAAO0C,EAAQ1C,CAAR0C,CAAP;QAED;;QAAA,OAAId,KAAUA,EAAOjI,IAAjBiI,GACIA,EAAOjI,IAAPiI,CAAOjI,KAAK,CAAZiI,EAAoBc,CAApBd,CADJA,GAGGA,CAHP;MAGOA,CATD,CASCA,CATD,EASCA,UAnUG1B,CAmUH0B,EAnUG1B;QACPC,QAAQyC,GAARzC,CAAYD,CAAZC;MAAYD,CAyTT,CAtUwC;IAa/BA,CAZdoC,CAD6C;EAa/BpC,CAb2B,CAa3BA;IAAAA;EAAAA;AAAAA,CA7LJ2B;AAAAA,IA2GGgB,eAAcC,CAAdD,EAAcC;EAAAA;IAAS,OACpCR,sBACmBC,IADnBD,EACmBC,IADnBD,CACmBC,UAAbC,CAAaD,EAAbC;MACN,IAAM/G,IAAQc,EAAciG,EAAKhG,QAAnBD,EAA6B,OAA7BA,CAAd;MAAA,IAEMwG,IAAWxG,EAAciG,EAAKhG,QAAnBD,EAA6B,WAA7BA,CAFjB;MAHoC,aAQ7BuG,CAR6B,EAMhCC;QAGAC,QAAQ,cAHRD;QAIMxB,mBAAQuB,CAARvB,EAAiB0B,CAAjB1B,EAAiB0B;UAAAA;YAAAA,uBACQ9B,GAAY4B,CAAZ5B,EAAsB8B,CAAtB9B,CADR8B,EAC8BA,IAD9BA,CACdC,EADcD;UAVS,CAUTA,CAVS;YAAA;UAAA;QAAA;MAMhCF,IANgC;QAkBlCC,QAAQ,cAlB0B;QAmBlCzB,SAAS,IAnByB;QAoBlChG,MAAM+C,EAAW7C,EAAML,QAANK,CAAeJ,OAA1BiD,CApB4B;QAqBlC9C,OAAOC,EAAML,QAANK,CAAeD,KArBY;QAsBlC2H,aAAa,IAtBqB;QAuBlC5E,WAAW,IAvBuB;QAwB5B6E,2BAAgBnC,CAAhBmC,EAAgBnC;UAAAA;YACpB,uBAAOE,GAAY1F,CAAZ0F,EAAmBF,CAAnBE,EAA6B;cAClCM,0BAAyB;YADS,CAA7BN,CAAP;UAzBgC,CAwBZF,CAxBY;YAAA;UAAA;QAAA;MAAA;IAAA,CACpCqB,CADoC;EAAA,CAATQ,CAAS;IAAA;EAAA;AAAA,CA3G1BjB;AAAAA,IA2G0BwB,KAtKH;EAClC,cAiCA;;EAAA,OAhCAC,EAAMC,SAAND,CAAgB3J,IAAhB2J,GAAuB,UAASE,CAAT,EAAsBC,CAAtB,EAAsBA;IAC5C,IAAM7B,IAAS,OAAf;IAAA,IACME,IAAQ4B,KAAK3B,CADnB;;IAEA,IAAID,CAAJ,EAAW;MACV,IAAM6B,IAAmB,IAAR7B,CAAQ,GAAI0B,CAAJ,GAAkBC,CAA3C;;MACA,IAAIE,CAAJ,EAAc;QACb;UACC1B,GAAQL,CAARK,EAAgB,CAAhBA,EAAmB0B,EAASD,KAAKvB,CAAdwB,CAAnB1B;QACC,CAFF,CAEE,OAAOjC,CAAP,EAAOA;UACRiC,GAAQL,CAARK,EAAgB,CAAhBA,EAAmBjC,CAAnBiC;QAED;;QAAA,OAAOL,CAAP;MAEA;;MAAA;IAiBF;;IAAA,OAdA8B,KAAK1B,CAAL0B,GAAS,UAASE,CAAT,EAASA;MACjB;QACC,IAAM7J,IAAQ6J,EAAMzB,CAApB;QACc,IAAVyB,EAAM7B,CAAI,GACbE,GAAQL,CAARK,EAAgB,CAAhBA,EAAmBuB,IAAcA,EAAYzJ,CAAZyJ,CAAdA,GAAmCzJ,CAAtDkI,CADa,GAEHwB,IACVxB,GAAQL,CAARK,EAAgB,CAAhBA,EAAmBwB,EAAW1J,CAAX0J,CAAnBxB,CADUwB,GAGVxB,GAAQL,CAARK,EAAgB,CAAhBA,EAAmBlI,CAAnBkI,CALa;MAOb,CATF,CASE,OAAOjC,CAAP,EAAOA;QACRiC,GAAQL,CAARK,EAAgB,CAAhBA,EAAmBjC,CAAnBiC;MAAmBjC;IAAAA,CAXrB0D,EAcO9B,CAAP;EAAOA,CA9BR0B,EA8BQ1B,CAER;AAlCkC,GA2DvBC;;AAKL,SAASgC,EAAT,CAAwBC,CAAxB,EAAwBA;EAC9B,OAAOA,aAAoBR,EAApBQ,IAA0C,IAAbA,EAAS/B,CAA7C;AAA6CA;;AAAAA,IA8B/BQ,eAAarJ,CAAbqJ,EAAarJ;EAAAA,qBAAO,EAAPA;;EAAO;IACjC,uBAAO,IAAIG,OAAJ,CAAIA,UAAekI,CAAflI,EAAwBmI,CAAxBnI,EAAwBmI;MAAAA;QAAW,OAC5Cc,sBACmByB,IADnBzB,EACmByB,IADnBzB,CACmByB,UAAbvB,CAAauB,EAAbvB;UACN,IAAIA,EAAKwB,QAALxB,IAAiByB,GAAWzB,CAAXyB,CAArB,EAAuC,OAAO1C,EAAQiB,CAARjB,CAAP;UACvC,IAAM2C,IAAkBhL,EAAKgL,eAALhL,IAAwB6C,EAAhD;UAJ4C,uBAS/B9D,IAASkM,GAATlM,CAAa,kBAAbA,CAT+B,EASlB0B,IATkB,CASlB;YAAA;cAH1BuK,EACE;gBACExJ;cADF,CADFwJ,EAME;gBACQlF,mBAAQgB,CAARhB,EAAQgB,CAARhB,EAAQgB;kBAAAA,IAAIzG,UAAJyG;;kBAAIzG;oBAAAA,uBAGE6K,GAAW,YAAXA,CAHF7K,EAGaI,IAHbJ,CAGa;sBAAA,uBAChB6K,GAAW,gBAAXA,CADgB,EACLzK,IADK,CACL;wBAHxBJ,EAAK;0BACHlB,MAAM,kBADH;0BAEHmE,WAFG;0BAGH6H;wBAHG,CAAL9K;sBAGE8K,CAD2B;oBAC3BA,CAJc9K;kBADpB,CACoBA,CADpB;oBAAA;kBAAA;gBAAA;gBAQQuF;kBAAAA;oBAAAA,uBACUiF,IADVjF,EACUiF,IADVjF,CACUiF;sBAAdxC;oBAAAA,CADIzC;kBARR,CAQQA,CARR;oBAAA;kBAAA;gBAAA;gBAWQG,sBAAWe,CAAXf,EAAWe,CAAXf,EAAWe;kBAAAA,IAAInB,WAAJmB;;kBAAInB;oBAAAA,iCZ9FGjE,CY8FHiE,EZ9FGjE;sBAAAA;wBAAM,SACpCA,IAXF,UAAuBA,CAAvB,EAAuBA;0BAGrB,OAFAA,EAAKW,IAALX,GAAYA,EAAKW,IAALX,GAAYU,EAAWV,EAAKW,IAAhBD,CAAZV,GAAoC,IAAhDA,EACAA,EAAK0J,KAAL1J,GAAaA,EAAK0J,KAAL1J,GAAaU,EAAWV,EAAK0J,KAAhBhJ,CAAbV,GAAsC,IADnDA,EAEOA,CAAP;wBAQO2J,CAXT,CAWuB3J,CAXvB,CAUsC,EAI7B4B,QAJ6B,IAIjB,EAJiB;;wBAIjB,iCa9BegI,Cb8Bf,Ea9B4BC,Cb8B5B,Ea9B4BA;0BAAAA;4BAC/C,IAAmB,QAAfD,CAAe,IAAgB,QAARC,CAA3B,EAAyC,uBAAO,EAAP;4BAEzC,IAAM9H,IAAM,IAAIC,GAAJ,CAAQ4H,CAAR,CAAZ;4BAHqD,OAIrD7H,EAAIE,YAAJF,CAAiBG,MAAjBH,CAAwB,MAAxBA,EAAgC8H,CAAhC9H,GAAgC8H,gBAEbhH,MAAMd,CAANc,EAAW;8BAC5B3C,QAAQ,KADoB;8BAE5B4C,SAAS;gCACPC,gBAAgB;8BADT;4BAFmB,CAAXF,EAKhB9D,IALgB8D,CAKX;8BAAAnF,OAAKA,EAAEsF,IAAFtF,EAALA;4BAAOsF,CALIH,CAFagH,EAOjB7G,IAPiB6G,CAOjB7G,UALTE,CAKSF,EALTE;8BAON,IAAI4G,MAAMC,OAAND,CAAc5G,CAAd4G,CAAJ,EAAyB,OAAO5G,CAAP;8BAGzB,IAAMtB,IAAW,EAAjB;8BAGA,IAAIkI,MAAMC,OAAND,CAAc5G,EAAK8G,cAAnBF,CAAJ,EACE,kBAAoB5G,EAAK8G,cAAzB,GAAyBA,eAAzB,GACEpI,EAASqI,IAATrI,CAASqI;gCACPxM,MAAM,OADCwM;gCAEPrJ,OAAOsC,EAAKtC;8BAFLqJ,GAEKrJ,OAFLqJ,CAATrI;8BAiBJ,OARqB,QAAjBsB,EAAKlC,QAAY,IACnBY,EAASqI,IAATrI,CAASqI;gCACPxM,MAAM,OADCwM;gCAEP1J,IAAI;8BAFG0J,GAGJ/G,EAAKlC,QAHDiJ,CAATrI,CADmB,EAQdA,CAAP;4BAAOA,CAlCyBiI,CAJqB;0BAAvD,CAAiDA,CAAjD;4BAAA;0BAAA;wBb+BUK,CADW,CACGlK,EAAKmK,GADR,EACanK,EAAK6J,IADlB,GACkBA,IADlB,CACkBA;0BAFrC,Ic3B4BO,Cd2B5B;0BAAA,Ic3BsCC,Cd2BtC;0BAAA,IAAIzI,Kc3BwBwI,OAAUC,KAAVD,EAAUC,WAAVD,CAAUC,KAAVD,IAAM,EAAIC,CAAVD,EAAM,WAAIC,CAAJ,KAAIA,IAAM,EAAV,CAAND,EAAgB,UAEjCA,CAFiC,EAEzBC,CAFyB,Cd2BxCzI,EAGF0I,GAHE1I,CAGE;4BAAAhC,iBNVyBA,CMUzBA,ENVkCI,CMUlCJ,ENVkCI;8BACxC;gCAEE,OADiBG,EAAmBP,EAAQnC,IAA3B0C,EAAiCP,CAAjCO,EAA0CH,CAA1CG,CACjB;8BACA,CAHF,CAGE,OAAOmF,CAAP,EAAOA;gCAMP,OALAC,QAAQD,KAARC,CAAQD,oCAC4B1F,EAAQnC,IADpC6H,GACoC7H,GAD5C8H,EAEE3F,CAFF2F,EAGED,CAHFC,GAKO3F,CAAP;8BAAOA;4BMAQ2K,CAAX3K,CAA4BA,CAA5BA,EAAqCI,CAArCJ;0BAAqCI,CAHvC4B,CAAJ;0BAAA,IAKMd,IAZR,UAAqBrD,CAArB,EAA2BmE,CAA3B,EAA2BA;4BACzB,OAAOA,EAASC,IAATD,CAAc;8BAAAlE,OAWK,YAXAA,EAAED,IAAPC;4BAAOD,CAArBmE,CAAP;0BAWc4I,CAZhB,CAY4B,CAZ5B,EAYqC5I,CAZrC,CAOE;;0BAOA,aACKpC,CADL,EACKA;4BACHmB,MAAMD,EAAWV,EAAKW,IAAhBD,CADHlB;4BAEHiL,KAAKlJ,EAAkBT,CAAlBS,CAFF/B;4BAGH4J,WAAU,CAHP5J;4BAIHoC,UAAUA,CAJPpC;4BAKHkL,WAAW1K,EAAK2K;0BALbnL,CADL;wBAMkBmL,CAZC;sBAJrB,CAAgC3K,CAAhC;wBAAA;sBAAA;oBY+F6C4K,CADhB3G,CAC0BmB,EAAEpF,IAD5BiE,GAC4BjE,IAD5BiE,CAC4BjE;sBADpB,OAC3BrB,EAAKkM,EAALlM,EAAWmM,EAAXnM,EAAWmM,CAAXnM,GAAWmM,gBACG3B,IADH2B,EACG3B,IADH2B,CACG3B;wBAAdxC,MACA1C,GADA0C;sBACA1C,CAFW6G,CADgB;oBAG3B7G,CAHmBA;kBAXvB,CAWuBA,CAXvB;oBAAA;kBAAA;gBAAA;cAAA,CANFqF;YAME;;YAAA,kCAFWjM,IAASkM,GAATlM,CAAa,qBAAbA,CAEX,EAFwB0B,IAExB,CAFwBgM,CAExB;UAFwB,CAVkB;QAUlB,CAT1BrD,CAD4C;MAAvC,CAA4Bd,CAA5B;QAAA;MAAA;IAAA,EAAP;EAAO,CAD0B,CAC1B;IAAA;EAAA;AAAA,CA/BqCO;AAAAA,IAqB/BqC,eAAWwB,CAAXxB,EAAWwB;EAAAA;IAAAA,uBAED3N,IAAS4N,KAAT5N,CAAe2N,CAAf3N,CAFC2N,EAEcA,IAFdA,CAEcA;MADtC,OAAO1I,OAAO4I,WAAP5I,CACLA,OAAOC,OAAPD,CAAOC,CAAPD,EAA4CgI,GAA5ChI,CAAgD;QAAA,IAAOnD,QAAP;QAAOA,OAAW,MAC5DgM,OAD4D,CACpDH,CADoD,EAC7C,EAD6C,GAEhE7L,CAFgE,CAAXA;MAErDA,CAFFmD,CADKA,CAAP;IAGInD,CAJoB6L;EAIpB7L,CAJoB6L,CAIpB7L;IAAAA;EAAAA;AAAAA,CAzBwCgI;AAAAA,IAxDxC0D,KAAO,cAwDiC1D;AAAAA,IAvDxCiE,KAAU,sBAuD8BjE;AAAAA,IArDxC2D,KAAmB,kBAqDqB3D;AAAAA,IAlDxCkE,8IAkDwClE;AAAAA,IAxCxCmE,eAUOtL,CAVPsL,EAUOtL;EAAAA;IAET,OADAuL,eAAeC,OAAfD,CAAuBV,EAAvBU,EAA6B5I,KAAKC,SAALD,CAAe3C,CAAf2C,CAA7B4I,GAA4CvL,gBACrCA,CADqCA,CAC5C;EAFC,CAAQA,CAAR;IAAA;EAAA;AAAA,CA8ByCmH;AAAAA,IAxBxCsE,KAAiB;EACrB,OAAOpO,IAASkM,GAATlM,CAAa,gBAAbA,EAAa,CAAkB,CAA/BA,CAAP;AAAsC,CAuBM8J;AAAAA,IApBxCuE,gBACHC,CADGD,IACHC,UAAaC,CAAbD,EAAaC;EAAAA;IAAO,OACnBA,EAAIC,KAAJD,CAAUjJ,KAAKiD,KAALjD,CAAW0I,EAAX1I,CAAViJ,GAAqBP,gBACXI,IADWJ,EACXI,IADWJ,CACXI;MAAAA;QAAAA;UAAAA;YArBV,IAAMK,IAAWnJ,KAAKiD,KAALjD,CAAW0I,EAAX1I,CAAjB;YAAA,IACMoJ,IAASpJ,KAAKiD,KAALjD,CAAW4I,eAAeS,OAAfT,CAAuBV,EAAvBU,CAAX5I,CADf;YAEA,OAAc,QAAVoJ,CAAU,IAAQD,EAAQxM,KAARwM,KAAsBC,EAAMzM,KAApC,IACZiM,eAAeU,UAAfV,CAA0BV,EAA1BU,GAA0BV,gBACnBiB,CADmBjB,CADd,IAELiB,gBAEFC,KAAUD,CAFRA,CAFT;UAHC,CAsBSL,CAtBT;YAAA;UAAA;QAuBoBH,CADXG,IACWH,IADXG,CACWH,UAAb1D,CAAa0D,EAAb1D;UACFyB,GAAWzB,CAAXyB,KAAkBuC,EAAIC,KAAJD,CAAUhE,CAAVgE,CAAlBvC;QAA4BzB,CAFxB6D;MAEwB7D,CAFxB6D;;MAEwB7D;IAAAA,CAHbyD,CADF;EADT,CACEO,CADF;IAAA;EAAA;AAAA,CAARF,EAAQQ,GAQXC,CARW,IAQC,UAACP,CAAD,EAAMQ,CAAN,EAAMA;EACjBR,EAAIS,SAAJT,CAAcQ,EAAOE,IAArBV,GACAA,EAAIjN,IAAJiN,CAASQ,EAAOE,IAAhBV,EAAsBR,EAAtBQ,EAAsBR,MAAaQ,EAAIW,GAAJX,EAAbR,CAAtBQ,CADAA;AACuCW,CAVrCb,EAUqCa,GAExCC,CAFwCD,IAE1B,UAACX,CAAD,EAAMQ,CAAN,EAAMA;EACnBR,EAAIa,WAAJb,CAAgBQ,EAAOE,IAAvBV;AAAuBU,CAbrBZ,EAaqBY,GAbbI,QAaaJ,GAbb,UAeOV,CAfP,EAeYQ,CAfZ,EAeYA;EAAAA;IAAW,OACjCA,EAAOO,KAAPP,CAAOO,MAAUf,EAAIW,GAAJX,EAAVe,CAAPP,GAAqBG,iBADY;EAfvB,CAeYH,CAfZ;IAAA;EAAA;AAAA,CAARV,EAAQQ,GAkBXpB,EAlBW,IAkBXA,UAA0Bc,CAA1Bd,EAA+BsB,CAA/BtB,EAAuC9K,CAAvC8K,EAAuC9K;EAAAA;IAAS,OAC/C4L,EAAIC,KAAJD,CAAU5L,CAAV4L,GAAU5L,gBACAyL,IADAzL,EACAyL,IADAzL,CACAyL;MAAAA,KAAkBH,GAAgBM,EAAIW,GAAJX,EAAhBN,CAAlBG,EACVG,EAAIgB,SAAJhB,CAAcR,EAAdQ,EAAcR,MAAaQ,EAAIW,GAAJX,EAAbR,CAAdQ,CADUH;IACqBc,CAFrBvM,CADqC;EAlBrC,CAkB4BA,CAlB5B;IAAA;EAAA;AAAA,CAAR0L,EAAQQ,gCAuBeN,CAvBf,EAuBoBQ,CAvBpB,EAuBoBA;EAAAA;IAAW,OACzCR,EAAIC,KAAJD,CAAUjJ,KAAKiD,KAALjD,CAAW0I,EAAX1I,CAAViJ,GAAqBP,gBACXI,IADWJ,EACXI,IADWJ,CACXI;MAAAA,KAAkBH,GAAgBM,EAAIW,GAAJX,EAAhBN,CAAlBG,EACVG,EAAIgB,SAAJhB,CAAcR,EAAdQ,EAAcR,MAAaQ,EAAIW,GAAJX,EAAbR,CAAdQ,CADUH;IACqBc,CAFVlB,CADoB;EAvB/B,CAuBoBe,CAvBpB;IAAA;EAAA;AAAA,CAARV,EAAQQ,EAARR,CAoBwCvE;AAAAA,IAWxCO,KAAmB;EAAA,OAAMmF,EAAMnB,EAANmB,EAAgBhC,EAAhBgC,CAAN;AAAsBhC,CAXD1D;;AAa9C,SAASkC,EAAT,CAAoBzB,CAApB,EAAoBA;EAClB,OACoB,QAAlBA,EAAK8C,SAAa,IACC,MAAnB9C,EAAK8C,SADa,IAElB9C,EAAK8C,SAAL9C,GAAiBkF,KAAKC,GAALD,EAHnB;AAkDF;;AAAA,SAASE,EAAT,GAASA;EACPtF,MACA/I,EAAKkM,EAALlM,EAtHuB,kBAsHvBA,CADA+I;AAYF;;AAAA,SAASY,EAAT,CAAyBzH,CAAzB,EAAyBA;EACvB,IAAMqC,IAT0B;IAAArC,OAAU;MAC1CxB,QAAQ,kBADkC;MAE1CC,OAAO,OAFmC;MAG1C2N,WAAWpM,KAAS,EAApBoM,EAAwBA,QAHkB;MAI1CC,QAAQrM,KAAS,EAAjBqM,EAAqBA,KAArBA,IAA8B,EAJY;MAK1CjF,gBAAgBpH,KAAS,EAAzBoH,EAA6BA,aAA7BA,IAA8C;IALJ,CAAVpH;EASnBsM,CATmB,CASOtM,CATP,CAShC;EAAA,IACMuM,IAAM,EADZ;;EAGqB,QAAjBlK,EAAK+J,QAAY,IAAMG,EAAInD,IAAJmD,CAAS,CAAC,UAAD,EAAalK,EAAK+J,QAAlB,CAATG,CAAN;;EACrB,kBAAelK,EAAKgK,KAALhK,IAAc,EAA7B,GAA6B,eAA7B,GAAiCkK,EAAInD,IAAJmD,CAAS,CAAC,OAAD,EAACrC,OAAD,CAATqC;;EACjC,kBAAelK,EAAK+E,aAAL/E,IAAsB,EAArC,GAAqC,eAArC,GAAyCkK,EAAInD,IAAJmD,CAAS,CAAC,YAAD,EAACC,OAAD,CAATD;;EAezC,OAbaA,EAAI9C,GAAJ8C,CAAQ;IAAA,IAAEE,QAAF;IAAA,IAAQC,QAAR;IAAQA,OAAS;MACpCnF,QAAQ,CAACmF,EAAG/M,QAAH+M,CAAY9M,OAAb,EAAsB8M,EAAG/M,QAAH+M,CAAY3M,KAAlC,EAAyC4M,IAAzC,CAA8C,GAA9C,CAD4B;MAEpC7M,MAAM4M,EAAG/M,QAAH+M,CAAY9M,OAFkB;MAGpCG,OAAO2M,EAAG/M,QAAH+M,CAAY3M,KAHiB;MAIpC4H,2BAAgBnC,CAAhBmC,EAAgBnC;QACd,OAAOE,GAAYgH,CAAZhH,EAAgBF,CAAhBE,CAAP;MAAuBF,CALW;MAOpCiH,MAAM;QACJL,UAAmB,eAATK,CADN;QAEJJ,OAAgB,YAATI,CAFH;QAGJG,YAAqB,iBAATH;MAHR;IAP8B,CAATC;EAUbD,CAVHF,CAab;AAmCF;;AAAA,SAASf,EAAT,CAAmBtD,CAAnB,EAAmBA;EACjBrB;EACA,IAAMgG,IAAO,OAAb;EAAA,IACMC,IAAOd,YAAYjB,CAAZiB,EAAYjB;IAAAA;MAAAA;MAAO,OAC9BA,EAAIjN,IAAJiN,CAASf,EAATe,EAAeO,CAAfP,GAAeO,gBAoDZ,UAAcyB,CAAd,EAAoBC,CAApB,EAA4BpL,CAA5B,EAA4BA;QAElC,KADA,IAAIqL,CACJ,IAAS;UACR,IAAIC,IAAiBH,GAArB;UAIA,IAHI3E,GAAe8E,CAAf9E,MACH8E,IAAiBA,EAAexG,CAD7B0B,GAC6B1B,CAE5BwG,CAAL,EACC,OAAO/G,CAAP;;UAED,IAAI+G,EAAehP,IAAnB,EAAyB;YACxB+O,IAAQ,CAARA;YACA;UAED;;UAAA,IAAI9G,IAASvE,GAAb;;UACA,IAAIuE,KAAUA,EAAOjI,IAArB,EAA2B;YAC1B,KAAIkK,GAAejC,CAAfiC,CAAJ,EAEO;cACN6E,IAAQ,CAARA;cACA;YAHA9G;;YAAAA,IAASA,EAAOG,CAAhBH;UAAgBG;QAcnB;;QAAA,IAAIF,IAAO,IAAIyB,EAAJ,EAAX;QAAA,IACI9B,IAASS,GAAQC,IAARD,CAAa,IAAbA,EAAmBJ,CAAnBI,EAAyB,CAAzBA,CADb;QAGA,QADW,MAAVyG,CAAU,GAAIC,EAAehP,IAAfgP,CAAoBC,CAApBD,CAAJ,GAAsD,MAAVD,CAAU,GAAI9G,EAAOjI,IAAPiI,CAAYiH,CAAZjH,CAAJ,GAAgBiH,MAT3EC,CAS2ED,EAAgClP,IAAhCkP,CAwCjF;UAAA,CACKF,IAAiBH,GADtB,IAEMG,EAAehP,IAAfgP,GACHA,EAAehP,IAAfgP,CAAoBC,CAApBD,EAAsChP,IAAtCgP,CAAsChP,KAAK,CAA3CgP,EAAmDnH,CAAnDmH,CADGA,GAGHC,EAAiBD,CAAjBC,CALH,GAQE3G,GAAQJ,CAARI,EAAc,CAAdA,EAAiBL,CAAjBK,CARF;QAQmBL,CAhD8DiH,CACjF,EAD2IlP,IAC3I,CAD2IA,KAAK,CAChJ,EADwJ6H,CACxJ,GAAOK,CAAP;;QACA,SAASgH,CAAT,CAA0B9O,CAA1B,EAA0BA;UACzB6H,IAAS7H,CAAT6H;;UACA,GAAG;YASF,MADA+G,IAAiBH,GACjB,KAAwB3E,GAAe8E,CAAf9E,KAAe8E,CAAoBA,EAAexG,CAA1E,EAEC,YADAF,GAAQJ,CAARI,EAAc,CAAdA,EAAiBL,CAAjBK,CACA;YAED,IAAI0G,EAAehP,IAAnB,EAEC,YADAgP,EAAehP,IAAfgP,CAAoBC,CAApBD,EAAsChP,IAAtCgP,CAAsChP,KAAK,CAA3CgP,EAAmDnH,CAAnDmH,CACA;YAGG9E,GADJjC,IAASvE,GACLwG,MACHjC,IAASA,EAAOO,CADb0B;UACa1B,CAnBlB,QAmBkBA,CAERP,CAFQO,IAERP,CAAWA,EAAOjI,IArB5B;;UAsBAiI,EAAOjI,IAAPiI,CAAYiH,CAAZjH,EAA8BjI,IAA9BiI,CAA8BjI,KAAK,CAAnCiI,EAA2CJ,CAA3CI;QAED;;QAAA,SAASgH,CAAT,CAA0BD,CAA1B,EAA0BA;UACrBA,KACH/G,IAASvE,GADNsL,KAEW/G,EAAOjI,IAFlBgP,GAGF/G,EAAOjI,IAAPiI,CAAYiH,CAAZjH,EAA8BjI,IAA9BiI,CAA8BjI,KAAK,CAAnCiI,EAA2CJ,CAA3CI,CAHE+G,GAKFE,EAAiBjH,CAAjBiH,CALEF,GAQH1G,GAAQJ,CAARI,EAAc,CAAdA,EAAiBL,CAAjBK,CARG0G;QAQc/G;MAAAA,CAtEb,CAsEaA;QAAAA,aAzHT,CAyHSA;MAzHT,CAmDJ,EAnDI,CAmDJ,EAnDI;QAAA,uBACgB4E,EAAIuC,OAAJvC,EADhB,EACoBuC,IADpB,CACoBA,UAAnB/B,CAAmB+B,EAAnB/B;UACN,IAAIA,EAAOgC,GAAPhC,KAAesB,CAAnB,EAAmBA,OACjB9B,EAAIjN,IAAJiN,CAASf,EAATe,EAAeY,CAAfZ,GAAeY,MADQ6B,KACR7B,CADEkB;UAInB3E,EAASqD,EAAOpM,IAAhB+I;QAAgB/I,CANX;MAMWA,CA6Cf,CApDYmM,CADe;IAAd,CAAOP,CAAP;MAAA;IAAA;EAAA,CAALiB,CADb;EAYA;IAAA,OAAalO,EAAKgP,CAALhP,EAAW+O,CAAX/O,CAAb;EAAwB+O,CAAxB;AAGF;;AAAA,SAASvE,EAAT,GAASA;EAEP,OADAzB,MACO/I,EAAKkM,EAALlM,EA9MQ,UA8MRA,EAAqB,IAArBA,EAA2B;IAAC2P,cAAa,CAAd;IAAoBC,SAAS;EAA7B,CAA3B5P,CAAP;AAUF;;AAAA;AAAA,IAAMoJ,KAAe;EAGnB,OAFAxJ,EAAU,eAAeqP,IAAf,CAAoBnI,CAApB,CAAVlH,EAAoC,8BAApCA,GAEO;IACLiQ,SAAS/I;EADJ,CAAP;AACWA,CAJb;AAAA,IAyBagJ,KAAc;EACzB,OAAO;IACL9G,gBADK;IAELqF,kBAFK;IAGL/E,iBAHK;IAILR,mBAJK;IAKL4E,aALK;IAMLlD;EANK,CAAP;AAMEA,CAhCJ;AAAA,IGnNMuF,eAAsBC,CAAtBD,EAAsBC;EAAAA;IAC1B,uBAAOC,EAAQ,CAACC,EAAqBF,CAArBE,CAAD,CAARD,EAA+C7P,IAA/C6P,CAAoD5P,CAApD4P,CAAP;EADiB,CAASD,CAAT;IAAA;EAAA;AAAA,CHmNnB;AAAA,IG9MMG,KAAW;EAAAC,OAAMA,EAAG5L,MAAH4L,IAAa,CAAnBA;AAAmB,CH8MpC;AAAA,IG7MMC,KAAa;EAAAD,OAAMA,EAAG5L,MAAH4L,IAAa,CAAnBA;AAAmB,CH6MtC;AAAA,IG5MME,KAAc;EAAAF,OAAMA,EAAG5L,MAAH4L,IAAa,CAAnBA;AAAmB,CH4MvC;AAAA,IGpMMrD,gBACHC,CADGD,IACHC,UAAaC,CAAbD,EAAaC;EAAAA;IAAAA,uBACK8C,GAAc9C,EAAI+B,IAAJ/B,EAAd8C,CADL9C,EACuB+B,IADvB/B,CACuB+B,UAA7BoB,CAA6BpB,EAA7BoB;MACDD,GAASC,CAATD,KAAc9I,WAAW;QAAA,OAAM4F,EAAIsD,QAAJtD,CApB3B,MAoB2BA,CAAN;MApBrB,CAoBU5F,EArBV,IAqBUA,CAAd8I,EACLlD,EAAIC,KAAJD,CAAUmD,CAAVnD,CADKkD;IACKC,CAHEnD;EADF,CACEA,CADF;IAAA;EAAA;AAAA,CAARF,EAAQyD,GAMXhD,CANW,IAMC,UAACP,CAAD,EAAMQ,CAAN,EAAMA;EACjBR,EAAIS,SAAJT,CAAcQ,EAAOE,IAArBV,GACAA,EAAIjN,IAAJiN,CAASQ,EAAOE,IAAhBV,EAAsBR,CAAtBQ,EAA+BA,EAAIW,GAAJX,EAA/BA,CADAA;AACmCW,CARjCb,EAQiCa,GAEpCC,CAFoCD,IAEtB,UAACX,CAAD,EAAMQ,CAAN,EAAMA;EACnBR,EAAIa,WAAJb,CAAgBQ,EAAOE,IAAvBV;AAAuBU,CAXrBZ,EAWqBY,GAExBI,CAFwBJ,IAExBI,UAAkBd,CAAlBc,EAAuBN,CAAvBM,EAAuBN;EAAAA;IAAW,OACjCA,EAAOO,KAAPP,CAAaR,EAAIW,GAAJX,EAAbQ,GAAiBG,iBADgB;EAbvB,CAaYH,CAbZ;IAAA;EAAA;AAAA,CAARV,EAAQyD,oBAgBEvD,CAhBF,EAgBEA;EAAAA;IAAAA,uBACK8C,GAAc9C,EAAI+B,IAAJ/B,EAAd8C,CADL9C,EACuB+B,IADvB/B,CACuB+B,UAA7BoB,CAA6BpB,EAA7BoB;MArBK,IAACK,CAAD,EAAMC,CAAN;MAsBNP,GAASC,CAATD,KAAc9I,WAAW;QAAA,OAAM4F,EAAIsD,QAAJtD,CAnC3B,MAmC2BA,CAAN;MAnCrB,CAmCU5F,EApCV,IAoCUA,CAAd8I,EAtBOM,IAuBDxD,EAAIW,GAAJX,EADNkD,EAtBYO,IAuBKN,CADjBD,EArBAnM,KAAKC,SAALD,CAAeyM,CAAfzM,MAAwBA,KAAKC,SAALD,CAAe0M,CAAf1M,CAAxBA,IAsBsBiJ,EAAIgB,SAAJhB,CAAcR,CAAdQ,EAAuBmD,CAAvBnD,CADtBkD,EAELlD,EAAIC,KAAJD,CAAUmD,CAAVnD,CAFKkD;IAEKC,CAJEnD;EAhBF,CAgBEA,CAhBF;IAAA;EAAA;AAAA,CAARF,EAAQyD,EAARzD,CHoMN;AAAA,IG5KM4D,KAAS;EAGb,IAF6B,mBAAlBX,CAAkB,KAC3BA,IAAgBA,EAAcA,aADH,GAER,QAAjBA,CAAJ,EAA2B,UAAUrN,KAAV,CAAgB,wBAAhB;EAC3B,OAAOqN,CAAP;AAAOA,CHwKT;AAAA,IGrKMY,KAAmB;EACvB,OAAO1C,EAAMnB,EAANmB,EAAgByC,GAAOX,CAAPW,CAAhBzC,CAAP;AAA8B8B,CHoKhC;;AGpKgCA,SAGhBa,EAHgBb,CAGJA,CAHIA,EAGJA;EAK1B,SAAStC,CAAT,CAAmBtD,CAAnB,EAAmBA;IACjB,OAAO0G,EAAWH,GAAOX,CAAPW,CAAXG,EAAkCF,EAAlCE,EAAoD1G,CAApD0G,CAAP;EAGF;;EAAA,SAASC,CAAT,CAAcC,CAAd,EAAcA;IACZ,iBAA0BrR,CAA1B,EAA0BA;MAAAA,qBAAO,EAAPA;MACxB,IAAMsR,IAAWtR,EAAKsR,QAALtR,IAAKsR,CAAY,CAAlC;MACA,WAAWnR,OAAX,CAAmB,UAACkI,CAAD,EAAUC,CAAV,EAAUA;QAC3B,IAAMiJ,IAAQxD,EAAU;UAClByD,EAASC,UAATD,IAASC,CAAeH,CAAxBE,IACFlJ,EAAOkJ,EAASE,YAAhBpJ,GACAiJ,GAFEC,IAGOH,EAAUG,CAAVH,MACThJ,EAAQmJ,CAARnJ,GACAkJ,GAFSF,CAHPG;QAKFD,CANUxD,CAAd;MAMIwD,CAPN;IAOMA,CATR;EAgBF;;EAAA,OAAO;IACL1G,UA1BF;MACE,OAAO8G,EAAWtB,CAAXsB,EAA0BV,EAA1BU,CAAP;IAAiCV,CAwB5B;IAELlD,YAFK;IAGL6D,eAAeR,EAAKT,EAALS,CAHV;IAILS,cAAcT,EAAKV,EAALU,CAJT;IAKLU,YAAYV,EAAKZ,EAALY;EALP,CAAP;AASFF;;AAAAA,GAAYa,SAAZb,GA5EkB;EAAAT,OAAMA,EAAG5L,MAAH4L,IAAa,CAAnBA;AAAmB,CA4ErCS,EACAA,GAAYc,SAAZd,GA9EkB;EAAAT,OAAMA,EAAG5L,MAAH4L,IAAa,CAAnBA;AAAmB,CA6ErCS,EAEAA,GAAYP,WAAZO,GAA0BP,EAF1BO,EAGAA,GAAYR,UAAZQ,GAAyBR,EAHzBQ,EAIAA,GAAYV,QAAZU,GAAuBV,EAJvBU,EAKAA,GAAYe,SAAZf,GAtFkB;EAAAT,OAAoB,MAAdA,EAAG5L,MAAT4L;AAAS5L,CAiF3BqM;;AAjF2BrM;AAAAA,ICuCLqN,eAAOlS,CAAPkS,EAAOlS;EAAAA,qBAAO,EAAPA;;EAAO;IAAI,uBAsfjC,UAAgBmE,CAAhB,EAAsBqF,CAAtB,EAAsBA;MAC5B;QACC,IAAId,8BAvdsB1I,CAudtB0I,EAvdsB1I;UAAAA;YAAM,OAEhCC,EAAUZ,EAAWW,CAAXX,CAAVY,EAA4B,kCAA5BA,GAEAA,EAAUX,EAASU,CAATV,CAAVW,EAA0B,wCAA1BA,CAFAA,EAIAA,EAAUZ,EAAWW,EAAKE,OAAhBb,CAAVY,EAAoC,4CAApCA,CAJAA,EAMAA,EAAUV,EAASS,EAAKE,OAAdX,CAAVU,EAAkC,iDAAlCA,CANAA,EAMkCE,iBARF;UAQE,CARRH,CAQQ;YAAA;UAAA;QAtC1BmS,CAqfJzJ,CArfiB1I,CAqfjB0I,GArfiB1I,IAqfjB0I,CArfiB1I;UAAAA,uBAICJ,EAAIb,MAAJa,GAAaqL,GAAbrL,CAAiB,WAAjBA,EAA8BuQ,KAAcxG,aAA5C/J,CAJDI,EAI6C2J,IAJ7C3J,CAI6C2J,UAA1DpH,CAA0DoH,EAA1DpH;YAoBN,OAjBO3C,EAAIS,IAAJT,CAAS,CACdA,EAAIsR,WAAJtR,CAAgBI,EAAKE,OAArBN,CADc,EAGdA,EAAIW,IAAJX,CAASF,EAAcM,EAAKO,IAALP,IAAa,EAA3BN,CAATE,CAHc,EAKdI,EAAKQ,KAALR,IAAcP,EAASO,EAAKQ,KAAdf,CAAdO,IAAsCJ,EAAIY,KAAJZ,CAAUI,EAAKQ,KAAfZ,CALxB,EAQdA,EAAI+O,QAAJ/O,CAAaI,EAAK2O,QAAL3O,IAAiBA,EAAKuC,KAAtBvC,IAA+BuC,CAA5C3C,CARc,EAWdA,EAAIgP,KAAJhP,CAAUI,EAAK4O,KAAL5O,IAAcA,EAAKuC,KAAnBvC,IAA4BuC,CAAtC3C,CAXc,EAcdA,EAAI8L,cAAJ9L,CAAmBI,EAAK0L,cAAL1L,IAAuB,CAACA,EAAKuC,KAALvC,IAAcuC,CAAf,CAA1C3C,CAdc,CAATA,EAeJa,IAfIb,CAeCA,EAAIc,MAfLd,CAiBP;UAFYc,CAtBOV;QAsBPU,CA+dVgI,CAAJ;MACC,CAFF,CAEE,OAAM5B,CAAN,EAAMA;QACP,OAAO0C,EAAQ1C,CAAR0C,CAAP;MAED;;MAAA,OAAId,KAAUA,EAAOjI,IAAjBiI,GACIA,EAAOjI,IAAPiI,CAAOjI,KAAK,CAAZiI,EAAoBc,CAApBd,CADJA,GAGGA,CAHP;IAGOA,CATD,CASCA,CATD,EASCA,UAneG1B,CAmeH0B,EAneG1B;MACP,MAAMA,CAAN;IAAMA,CAydH,CAtfiC;EAAxC,CAAoC,CAApC;IAAA;EAAA;AAAA,CDvC2BnC;AAAAA,IEjBduN,eAAmB7R,CAAnB6R,EAA8BpS,CAA9BoS,EAA8BpS;EAAAA,WAAXO,CAAWP,KAAXO,IAAO,EAAIP,GAAJ,WAAIA,CAAJ,KAAIA,IAAO,EAAX,CAAIA;;EAAO;IAAA,uBAElBjB,IAC3BkM,GAD2BlM,CACvB,aADuBA,EACRiB,EAAKqI,OAALrI,IAAgBqS,EAAerS,CAAfqS,CADRtT,CAFkB,EAGKiB,IAHL,CAGKA,UAD/CsS,CAC+CtS,EAD/CsS;MAAAA;QAAAA,uBAMwBA,EAAgB/R,CAAhB+R,CANxBA,EAMwC/R,IANxC+R,CAMwC/R;UAD9C,OAAO8D,KAAKC,SAALD,CACLkO,IADKlO,EAEL,IAFKA,EAGL,CAHKA,CAAP;QAGE,CARIiO;MAQJ;;MAAA;QALF,IAAI9G,MAAMC,OAAND,CAAcjL,CAAdiL,CAAJ,EAAkBjL,uBAAoBiS,EAAKC,GAALD,EAAoBjS,CAApBiS,CAApBjS,EAAwCA,IAAxCA,CAAwCA;UAAjCA;QAAAA,CAAPA;MAAOA,CAKvB;;MALuBA;IAAAA,CALuB;EAA5B,CAA4B,CAA5B;IAAA;EAAA;AAAA,CFiBKsE;AAAAA,IGXrB6N,eAAqBpF,CAArBoF,EAAqBpF;EAAAA;IAAAA,QAClB5F,UADkB4F;IAClB5F,uBAEC3I,IAASkM,GAATlM,CAAa,mBAAbA,EAPG,GAOHA,CAFD2I,EALIjH,IAKJiH,CALI;MAKX,SACE;QAAA,OAAM4F,EAAIsD,QAAJtD,CAJG,MAIHA,CAAN;MAJS,CAGX,EAHWxN,CAGX;IAHW,CAGJ4H;EADS,CAAS4F,CAAT;IAAA;EAAA;AAAA,CHWSzI;AAAAA,IGJrBuI,gBAAQuF,IAARvF,GAAQ,UACEE,CADF,EACEA;EAAAA;IACZ,KAAKA,EAAIsF,OAAJtF,EAAL,EAAoB;;IACpB,IAAIuF,IAAMvF,EAAIrC,GAAJqC,CAAQ,KAARA,CAAV;IAAA,IAAkBb;MAAA,IACP,QAAPoG,CADc,EACdA;QAAAA,QACFvF,EAAItO,GADF6T;QACE7T,uBAAiB8T,GAAjB9T,EAAiB8T,IAAjB9T,CAAiB8T;UAArBC,UAAQ,KAARA,EAAQjT,CAARiT;UAJiB,QAKjBzF,EAAItO,GALa;UAKbA,uBAAkB0T,GAAapF,CAAboF,CAAlB1T,EAA+BsO,IAA/BtO,CAA+BsO;YAAnC0F,UAAQ,MAARA,EAAQlT,CAARkT;UAAQ,CAAJhU;QAAI,CADJA;MACI;;MAAA,uBAES8T,GAFT,EAESA,IAFT,CAESA,UAAb/B,CAAa+B,EAAb/B;QAPa,OAQjBzD,EAAItO,GAAJsO,CAAQ,KAARA,EAAeyD,CAAfzD,GAAeyD,gBACI1Q,EAAK,CACtB4S,UAAU3F,EAAI+B,IAAJ/B,EAAV2F,EAAsBJ,EAAIK,MAA1BD,EAAkClC,EAAKmC,MAALnC,GAAc,CAAhDkC,CADsB,CAAL5S,EAEhBI,IAFgBJ,CAEXK,CAFWL,CADJ0Q,EAGPrQ,IAHOqQ,CAGPrQ,UAFFgB,CAEEhB,EAFFgB;UAGN,kBAAcA,CAAd,GAAcA,eAAd,GAAoB4L,EAAIgB,SAAJhB,CAvBV,SAuBUA,EAvBV3M,QAuBmCe,IAAzB4L;;UAZH,QAajBA,EAAItO,GAba;UAabA,uBAAkB0T,GAAapF,CAAboF,CAAlB1T,EAA+BsO,IAA/BtO,CAA+BsO;YAAnC6F,UAAQ,MAARA,EAAQrT,CAARqT;UAAQ,CAAJnU;QAAI,CALO+R,CARE;MAaT,CARA;IAQA,CAXQ,EAAlB;;IAWU;EAdA,CACEzD,CADF;IAAA;EAAA;AAAA,CAARF,EAAQgG,GAiBXvF,CAjBW,IAiBXA,UAAmBP,CAAnBO,EAAwBC,CAAxBD,EAAwBC;EAAAA;IAAAA;MAIvBR,EAAIS,SAAJT,CAAcQ,EAAOE,IAArBV;IAAqBU,CAJEF;IAAAA,IAIFE;MAAAA,KAHhBV,EAAIsF,OAAJtF,EAGgBU,EAHZ4E;QAAAA,QACPtF,EAAItO,GADG4T;QACH5T,uBAAkB0T,GAAapF,CAAboF,CAAlB1T,EAA+BsO,IAA/BtO,CAA+BsO;UAAnC+F,UAAQ,MAARA,EAAQ1S,CAAR0S;QAAQ,CAAJrU;MAAI;IAAA,CAEWgP,EAJEF;;IAEb;EAnBA,CAiBaA,CAjBb;IAAA;EAAA;AAAA,CAARV,EAAQgG,GAuBXlF,CAvBW,IAuBG,UAACZ,CAAD,EAAMQ,CAAN,EAAMA;EACnBR,EAAIa,WAAJb,CAAgBQ,EAAOE,IAAvBV,GACKA,EAAIsF,OAAJtF,OACHgG,aAAahG,EAAIrC,GAAJqC,CAAQ,MAARA,CAAbgG,GACAhG,SAAW,MAAXA,CADAgG,EAEAhG,SAAW,KAAXA,CAHGA,CADLA;AAIa,CA5BXF,EA4BWgG,EA5BXhG,CHIqBvI;AAAAA,IG6BrB0O,KAAc;EAAAC,OAAOjF,EAAMnB,EAANmB,EAAgBiF,CAAhBjF,CAAPiF;AAAuBA,CH7BhB3O;;AG6BgB2O,SAE3BC,EAF2BD,CAEpBA,CAFoBA,EAEpBA;EACrB,OAAO;IACLzF,WAAW;MAAAtD,OAAY0G,EAAWqC,CAAXrC,EAAgBoC,EAAhBpC,EAA6B1G,CAA7B0G,CAAZ1G;IAAyCA;EAD/C,CAAP;AC1CWpB;;AAAAA,SAAe;EAAArJ,OAAQmQ,KAAc9G,YAAd8G,CAA2BnQ,CAA3BmQ,CAARnQ;AAAmCA,CAAlDqJ;AAAAA,IACAqF,KAAiB;EAAA,OAAMyB,KAAczB,cAAdyB,EAAN;AAAoBzB,CADrCrF;AAAAA,IAEAqK,KAAiB;EAE5B,OADAvD,KAAczB,cAAdyB,IACOA,KAAc9G,YAAd8G,EAAP;AAAqB9G,CAJVA;AAAAA,IAMAsK,KAAS;EAAA3T,OAAQmQ,KAAc9G,YAAd8G,EAARnQ;AAAsBqJ,CAN/BA;AAAAA,IAOAuK,KAAQ;EAAA5T,OAAQmQ,KAAc9G,YAAd8G,EAARnQ;AAAsBqJ,CAP9BA;AAAAA,IASA9G,KAAQ4N,KAAcxG,aATtBN;AAAAA,IAYAvJ,KAAI+T,CAZJxK;;AAYIwK","names":["config","put","VERSION","is","type","d","isRequired","isObject","isString","isFunc","isNumber","normalizeArgs","ax","sdk","arg","t","query","opts","invariant","cadence","Promise","preQuery","send","script","args","limit","then","decode","r","done","value","SERVICE_PRAGMA","f_type","f_vsn","IDENTITY_PRAGMA","USER_PRAGMA","POLLING_RESPONSE_PRAGMA","COMPOSITE_SIGNATURE_PRAGMA","normalizeFrame","service","old","endpoint","params","data","normalizeBackChannelRpc","method","serviceNormalizers","back-channel-rpc","pre-authz","uid","id","identity","address","withPrefix","addr","keyId","authz","authn","pid","provider","name","icon","frame","open-id","user-signature","Error","deriveCompositeId","rlp","encode","toString","serviceOfType","services","find","serviceEndpoint","url","URL","searchParams","append","window","location","origin","Object","entries","fetchService","body","undefined","JSON","stringify","fetch","headers","Content-Type","json","normalizePollingResponse","resp","status","reason","compositeSignature","updates","authorizationUpdates","local","normalizeCompositeSignature","sansPrefix","signature","sig","FRAME","noop","IGNORE","Set","close","onClose","onMessage","onReady","onResponse","addEventListener","internal","src","document","getElementById","$frame","createElement","allow","frameBorder","style","cssText","remove","renderFrame","unmount","e","has","error","console","removeEventListener","msg","contentWindow","postMessage","parse","poll","canContinue","serviceMethod","setTimeout","OPTIONS","HTTP/GET","HTTP/POST","execHttpPost","signable","closeFrame","execService","STRATEGIES","HTTP/RPC","IFRAME/RPC","resolve","reject","includeOlderJsonRpcCall","_","jsonrpc","result","pact","state","s","o","_settle","bind","v","observer","signUserMessage","spawnCurrentUser","authenticate","user","signingService","recover","makeSignable","log","authorization","account","preAuthz","tempId","preSignable","resolvePreAuthz","sequenceNum","signingFunction","de","_Pact","prototype","onFulfilled","onRejected","this","callback","_this","_isSettledPact","thenable","snapshot","loggedIn","notExpired","serviceStrategy","get","configLens","app","paddr","normalizeData","servicesURL","code","Array","isArray","authorizations","push","fetchServices","hks","sx1","sx2","map","normalizeService","findService","cid","expiresAt","exp","buildUser","NAME","SET_CURRENT_USER","n","regex","where","fromEntries","replace","UPDATED","DATA","coldStorage","sessionStorage","setItem","canColdStorage","HANDLERS","INIT","ctx","merge","fallback","stored","getItem","removeItem","te","SUBSCRIBE","letter","subscribe","from","all","UNSUBSCRIBE","unsubscribe","SNAPSHOT","reply","broadcast","spawn","Date","now","unauthenticate","proposer","payer","normalizePreAuthzResponse","axs","i","role","az","join","authorizer","EXIT","self","test","update","stage","shouldContinue","_resumeAfterTest","_resumeAfterBody","updateValue","receive","tag","_exit2","expectReply","timeout","message","currentUser","fetchTxStatus","transactionId","fclSend","getTransactionStatus","isSealed","tx","isExecuted","isFinalized","sendSelf","Ce","cur","next","scoped","spawnTransaction","transaction","subscriber","once","predicate","suppress","unsub","txStatus","statusCode","errorMessage","snapshoter","onceFinalized","onceExecuted","onceSealed","isUnknown","isPending","isExpired","mutate","prepMutation","serialize","defaultResolve","resolveFunction","createSignableVoucher","pipe","interaction","scheduleTick","TICK","hasSubs","hwm","latestBlock","_put4","_put2","getEvents","height","_put3","Fe","_put6","clearTimeout","spawnEvents","key","events","reauthenticate","signUp","logIn","types"],"sources":["../src/default-config.js","../src/VERSION.js","../src/exec/utils/is.js","../src/exec/utils/normalize-args.js","../src/exec/query.js","../src/current-user/normalize/__vsn.js","../src/current-user/normalize/frame.js","../src/current-user/normalize/back-channel-rpc.js","../src/current-user/normalize/service.js","../src/current-user/normalize/pre-authz.js","../src/current-user/normalize/authz.js","../src/current-user/normalize/authn.js","../src/current-user/normalize/open-id.js","../src/current-user/normalize/user-signature.js","../src/current-user/build-user.js","../src/current-user/service-of-type.js","../src/current-user/exec-service/strategies/utils/service-endpoint.js","../src/current-user/exec-service/strategies/utils/fetch-service.js","../src/current-user/normalize/polling-response.js","../src/current-user/normalize/composite-signature.js","../src/current-user/exec-service/strategies/utils/render-frame.js","../src/current-user/exec-service/strategies/utils/frame.js","../src/current-user/exec-service/strategies/utils/poll.js","../src/current-user/exec-service/strategies/http-post.js","../src/current-user/exec-service/index.js","../src/current-user/exec-service/strategies/iframe-rpc.js","../src/current-user/index.js","../src/current-user/fetch-services.js","../src/current-user/merge-services.js","../src/transaction/index.js","../src/exec/mutate.js","../src/serialize/index.js","../src/events/index.js","../src/fcl.js"],"sourcesContent":["import {config} from \"@onflow/sdk\"\n\nconfig()\n  .put(\"accessNode.api\", \"http://localhost:8080\")\n  .put(\"challenge.handshake\", \"http://localhost:8700/authenticate\")\n","export const VERSION = \"0.0.73\"\n","const is = type => d => typeof d === type\n\nexport const isRequired = d => d != null\nexport const isObject = is(\"object\")\nexport const isString = is(\"string\")\nexport const isFunc = is(\"function\")\nexport const isNumber = is(\"number\")\n","import {isFunc} from \"./is\"\nimport * as sdk from \"@onflow/sdk\"\nimport * as t from \"@onflow/types\"\n\nexport function normalizeArgs(ax) {\n  if (isFunc(ax)) return ax(sdk.arg, t)\n  return []\n}\n","import {invariant} from \"@onflow/util-invariant\"\nimport * as sdk from \"@onflow/sdk\"\nimport * as t from \"@onflow/types\"\nimport {isRequired, isObject, isString, isFunc} from \"./utils/is\"\nimport {normalizeArgs} from \"./utils/normalize-args\"\n\n/** Query the Flow Blockchain\n *\n *  @arg {Object} opts         - Query Options and configuration\n *  @arg {string} opts.cadence - Cadence Script used to query Flow\n *  @arg {ArgsFn} opts.args    - Arguments passed to cadence script\n *  @arg {number} opts.limit   - Compute Limit for Query\n *  @returns {Promise<Response>}\n *\n *  Where:\n *    @callback ArgsFn\n *    @arg {ArgFn}  arg - Argument function to define a single argument\n *    @arg {Object} t   - Cadence Types object used to define the type\n *    @returns {args[]}\n *\n *    @callback ArgFn\n *    @arg {Any}  value - the value of the argument\n *    @arg {Type} type  - the cadence type of the value\n *    @returns {arg}\n *\n *  Example:\n *    const cadence = `\n *      cadence: `\n *        pub fun main(a: Int, b: Int, c: Address): Int {\n *          log(c)\n *          return a + b\n *        }\n *    `.trim()\n *\n *    const args = (arg, t) => [\n *      arg(5, t.Int),\n *      arg(7, t.Int),\n *      arg(\"0xb2db43ad6bc345fec9\", t.Address),\n *    ]\n *\n *    await query({ cadence, args })\n */\nexport async function query(opts = {}) {\n  await preQuery(opts)\n\n  // prettier-ignore\n  return sdk.send([\n    sdk.script(opts.cadence),\n    sdk.args(normalizeArgs(opts.args || [])),\n    opts.limit && typeof opts.limit === \"number\" && sdk.limit(opts.limit)\n  ]).then(sdk.decode)\n}\n\nasync function preQuery(opts) {\n  invariant(\n    isRequired(opts.cadence),\n    \"query({ cadence }) -- cadence is required\"\n  )\n\n  invariant(\n    isString(opts.cadence),\n    \"query({ cadence }) -- cadence must be a string\"\n  )\n}\n","export const SERVICE_PRAGMA = {\n  f_type: \"Service\",\n  f_vsn: \"1.0.0\",\n}\n\nexport const IDENTITY_PRAGMA = {\n  f_type: \"Identity\",\n  f_vsn: \"1.0.0\",\n}\n\nexport const PROVIDER_PRAGMA = {\n  f_type: \"Provider\",\n  f_vsn: \"1.0.0\",\n}\n\nexport const USER_PRAGMA = {\n  f_type: \"USER\",\n  f_vsn: \"1.0.0\",\n}\n\nexport const POLLING_RESPONSE_PRAGMA = {\n  f_type: \"PollingResponse\",\n  f_vsn: \"1.0.0\",\n}\n\nexport const COMPOSITE_SIGNATURE_PRAGMA = {\n  f_type: \"CompositeSignature\",\n  f_vsn: \"1.0.0\",\n}\n\nexport const OPEN_ID_PRAGMA = {\n  f_type: \"OpenId\",\n  f_vsn: \"1.0.0\",\n}\n","import {SERVICE_PRAGMA} from \"./__vsn\"\n\n// {\n//    \"f_type\": \"Service\",\n//    \"f_vsn\": \"1.0.0\",\n//    \"type\": \"frame\",\n//    \"endpoint\": \"https://rawr\",\n//    \"data\": {},   // Sent to frame when ready\n//    \"params\": {}, // include in query params on frame\n// }\nexport function normalizeFrame(service) {\n  if (service == null) return null\n\n  switch (service[\"f_vsn\"]) {\n    case \"1.0.0\":\n      return service\n\n    default:\n      return {\n        old: service,\n        ...SERVICE_PRAGMA,\n        type: \"frame\",\n        endpoint: service.endpoint,\n        params: service.params || {},\n        data: service.data || {},\n      }\n  }\n}\n","import {SERVICE_PRAGMA} from \"./__vsn\"\n\n// {\n//    \"f_type\": \"Service\",\n//    \"f_vsn\": \"1.0.0\",\n//    \"type\": \"back-channel-rpc\",\n//    \"endpoint\": \"https://rawr\",\n//    \"method\": \"HTTP/GET\", // HTTP/GET | HTTP/POST\n//    \"data\": {},           // included in body of rpc\n//    \"params\": {},         // included as query params on endpoint url\n// }\nexport function normalizeBackChannelRpc(service) {\n  if (service == null) return null\n\n  switch (service[\"f_vsn\"]) {\n    case \"1.0.0\":\n      return service\n\n    default:\n      return {\n        ...SERVICE_PRAGMA,\n        type: \"back-channel-rpc\",\n        endpoint: service.endpoint,\n        method: service.method,\n        params: service.params || {},\n        data: service.data || {},\n      }\n  }\n}\n","import {normalizeAuthn} from \"./authn\"\nimport {normalizeAuthz} from \"./authz\"\nimport {normalizePreAuthz} from \"./pre-authz\"\nimport {normalizeFrame} from \"./frame\"\nimport {normalizeBackChannelRpc} from \"./back-channel-rpc\"\nimport {normalizeOpenId} from \"./open-id\"\nimport {normalizeUserSignature} from \"./user-signature\"\n\nexport function normalizeServices(services, data) {\n  return services.map(service => normalizeService(service, data))\n}\n\nconst serviceNormalizers = {\n  \"back-channel-rpc\": normalizeBackChannelRpc,\n  \"pre-authz\": normalizePreAuthz,\n  authz: normalizeAuthz,\n  authn: normalizeAuthn,\n  frame: normalizeFrame,\n  \"open-id\": normalizeOpenId,\n  \"user-signature\": normalizeUserSignature,\n}\n\nexport function normalizeService(service, data) {\n  try {\n    var normalized = serviceNormalizers[service.type](service, data)\n    return normalized\n  } catch (error) {\n    console.error(\n      `Unrecognized FCL Service Type [${service.type}]`,\n      service,\n      error\n    )\n    return service\n  }\n}\n","import {withPrefix} from \"@onflow/util-address\"\nimport {SERVICE_PRAGMA, IDENTITY_PRAGMA} from \"./__vsn\"\n\n// {\n//   \"f_type\": \"service\",\n//   \"f_vsn\": \"1.0.0\",\n//   \"type\": \"pre-authz\",\n//   \"uid\": \"uniqueDedupeKey\",\n//   \"endpoint\": \"https://rawr\",\n//   \"method\": \"HTTP/POST\", // HTTP/POST | IFRAME/RPC | HTTP/RPC\n//   \"identity\": {\n//      \"address\": \"0x______\",\n//      \"keyId\": 0,\n//   },\n//   \"data\": {}, // included in body of pre-authz request\n//   \"params\": {}, // included as query params on endpoint url\n// }\nexport function normalizePreAuthz(service) {\n  if (service == null) return null\n\n  switch (service[\"f_vsn\"]) {\n    case \"1.0.0\":\n      return service\n\n    default:\n      return {\n        ...SERVICE_PRAGMA,\n        type: service.type,\n        uid: service.id,\n        endpoint: service.endpoint,\n        method: service.method,\n        identity: {\n          ...IDENTITY_PRAGMA,\n          address: withPrefix(service.addr),\n          keyId: service.keyId,\n        },\n        params: service.params,\n        data: service.data,\n      }\n  }\n}\n","import {withPrefix} from \"@onflow/util-address\"\nimport {SERVICE_PRAGMA, IDENTITY_PRAGMA} from \"./__vsn\"\n\n// {\n//   \"f_type\": \"service\",\n//   \"f_vsn\": \"1.0.0\",\n//   \"type\": \"authz\",\n//   \"uid\": \"uniqueDedupeKey\",\n//   \"endpoint\": \"https://rawr\",\n//   \"method\": \"HTTP/POST\", // HTTP/POST | IFRAME/RPC | HTTP/RPC\n//   \"identity\": {\n//      \"address\": \"0x______\",\n//      \"keyId\": 0,\n//   },\n//   \"data\": {}, // included in body of authz request\n//   \"params\": {}, // included as query params on endpoint url\n// }\nexport function normalizeAuthz(service) {\n  if (service == null) return null\n\n  switch (service[\"f_vsn\"]) {\n    case \"1.0.0\":\n      return service\n\n    default:\n      return {\n        ...SERVICE_PRAGMA,\n        type: service.type,\n        uid: service.id,\n        endpoint: service.endpoint,\n        method: service.method,\n        identity: {\n          ...IDENTITY_PRAGMA,\n          address: withPrefix(service.addr),\n          keyId: service.keyId,\n        },\n        params: service.params,\n        data: service.data,\n      }\n  }\n}\n","import {withPrefix} from \"@onflow/util-address\"\nimport {SERVICE_PRAGMA} from \"./__vsn\"\n\n// {\n//   \"f_type\": \"Service\",\n//   \"f_vsn\": \"1.0.0\",\n//   \"type\": \"authn\",\n//   \"uid\": \"uniqueDedupeKey\",\n//   \"endpoint\": \"https://rawr\",\n//   \"id\": \"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx\", // wallets internal id for the user\n//   \"identity\": {\n//     \"address\": \"0x____\"\n//   },\n//   \"provider\": {\n//     \"address\": \"0x____\",\n//     \"name\": \"Best Wallet\",\n//     \"description\": \"The Best Wallet\"\n//     \"icon\": \"https://\",\n//   }\n// }\nexport function normalizeAuthn(service) {\n  if (service == null) return null\n\n  switch (service[\"f_vsn\"]) {\n    case \"1.0.0\":\n      return service\n\n    default:\n      return {\n        ...SERVICE_PRAGMA,\n        type: service.type,\n        uid: service.id,\n        endpoint: service.authn,\n        id: service.pid,\n        provider: {\n          address: withPrefix(service.addr),\n          name: service.name,\n          icon: service.icon,\n        },\n      }\n  }\n}\n","import {SERVICE_PRAGMA, OPEN_ID_PRAGMA} from \"./__vsn\"\n\n// {\n//   \"f_type\": \"Service\",\n//   \"f_vsn\": \"1.0.0\",\n//   \"type\": \"open-id\",\n//   \"uid\": \"uniqueDedupeKey\",\n//   \"method: \"data\",\n//   \"data\": {\n//      \"profile\": {\n//        \"name\": \"Bob\",\n//        \"family_name\": \"Builder\",\n//        \"given_name\": \"Robert\",\n//        \"middle_name\": \"the\",\n//        \"nickname\": \"Bob the Builder\",\n//        \"perferred_username\": \"bob\",\n//        \"profile\": \"https://www.bobthebuilder.com/\",\n//        \"picture\": \"https://avatars.onflow.org/avatar/bob\",\n//        \"gender\": \"...\",\n//        \"birthday\": \"2001-01-18\",\n//        \"zoneinfo\": \"America/Vancouver\",\n//        \"locale\": \"en-us\",\n//        \"updated_at\": \"1614970797388\"\n//      },\n//      \"email\": {\n//        \"email\": \"bob@bob.bob\",\n//        \"email_verified\": true\n//      },\n//      \"address\": {\n//        \"address\": \"One Apple Park Way, Cupertino, CA 95014, USA\"\n//      },\n//      \"phone\": {\n//        \"phone_number\": \"+1 (xxx) yyy-zzzz\",\n//        \"phone_number_verified\": true\n//      },\n//      \"social\": {\n//        \"twitter\": \"@_qvvg\",\n//        \"twitter_verified\": true\n//      },\n//   }\n// }\nexport function normalizeOpenId(service) {\n  if (service == null) return null\n\n  switch (service[\"f_vsn\"]) {\n    case \"1.0.0\":\n      return service\n\n    default:\n      return null\n  }\n}\n","import {withPrefix} from \"@onflow/util-address\"\nimport {SERVICE_PRAGMA} from \"./__vsn\"\n\n// {\n//   \"f_type\": \"Service\",\n//   \"f_vsn\": \"1.0.0\",\n//   \"type\": \"user-signature\",\n//   \"uid\": \"uniqueDedupeKey\",\n//   \"endpoint\": \"https://rawr\",\n//   \"method\": \"IFRAME/RPC\", // HTTP/POST | IFRAME/RPC | HTTP/RPC\n//   \"id\": \"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx\", // wallets internal id for the user\n//   \"data\": {}, // included in body of user-signature request\n//   \"params\": {}, // included as query params on endpoint url\n// }\nexport function normalizeUserSignature(service) {\n  if (service == null) return null\n\n  switch (service[\"f_vsn\"]) {\n    case \"1.0.0\":\n      return service\n\n    default:\n      throw new Error(\"Invalid user-signature service\")\n  }\n}\n","import {withPrefix} from \"@onflow/util-address\"\nimport * as rlp from \"@onflow/rlp\"\nimport {fetchServices} from \"./fetch-services\"\nimport {mergeServices} from \"./merge-services\"\nimport {USER_PRAGMA} from \"./normalize/__vsn\"\nimport {normalizeService} from \"./normalize/service\"\n\nfunction deriveCompositeId(authn) {\n  return rlp\n    .encode([\n      authn.provider.address || authn.provider.name || \"UNSPECIFIED\",\n      authn.id,\n    ])\n    .toString(\"hex\")\n}\n\nfunction normalizeData(data) {\n  data.addr = data.addr ? withPrefix(data.addr) : null\n  data.paddr = data.paddr ? withPrefix(data.paddr) : null\n  return data\n}\n\nfunction findService(type, services) {\n  return services.find(d => d.type === type)\n}\n\nexport async function buildUser(data) {\n  data = normalizeData(data)\n\n  var services = mergeServices(\n    data.services || [],\n    await fetchServices(data.hks, data.code)\n  ).map(service => normalizeService(service, data))\n\n  const authn = findService(\"authn\", services)\n\n  return {\n    ...USER_PRAGMA,\n    addr: withPrefix(data.addr),\n    cid: deriveCompositeId(authn),\n    loggedIn: true,\n    services: services,\n    expiresAt: data.exp,\n  }\n}\n","export function serviceOfType(services = [], type) {\n  return services.find(service => service.type === type)\n}\n","export function serviceEndpoint(service) {\n  const url = new URL(service.endpoint)\n  url.searchParams.append(\"l6n\", window.location.origin)\n  if (service.params != null) {\n    for (let [key, value] of Object.entries(service.params || {})) {\n      url.searchParams.append(key, value)\n    }\n  }\n  return url\n}\n","import {serviceEndpoint} from \"./service-endpoint\"\n\nexport function fetchService(service, opts = {}) {\n  const method = opts.method || \"POST\"\n  const body =\n    method === \"GET\"\n      ? undefined\n      : JSON.stringify(opts.data || service.data || {})\n\n  return fetch(serviceEndpoint(service), {\n    method: method,\n    headers: {\n      ...(service.headers || {}),\n      ...(opts.headers || {}),\n      \"Content-Type\": \"application/json\",\n    },\n    body: body,\n  }).then((d) => d.json())\n}\n","import {POLLING_RESPONSE_PRAGMA} from \"./__vsn\"\nimport {normalizeBackChannelRpc} from \"./back-channel-rpc\"\nimport {normalizeFrame} from \"./frame\"\n\n// {\n//    \"f_type\": \"PollingResponse\",\n//    \"f_vsn\": \"1.0.0\",\n//    \"status\": \"PENDING\", // PENDING | APPROVED | DECLINED\n//    \"reason\": null,      // Reason for Declining Transaction\n//    \"data\": null,        // Return value for APPROVED\n//    \"updates\": BackChannelRpc,\n//    \"local\": Frame,\n// }\nexport function normalizePollingResponse(resp) {\n  if (resp == null) return null\n\n  switch (resp[\"f_vsn\"]) {\n    case \"1.0.0\":\n      return resp\n\n    default:\n      return {\n        ...POLLING_RESPONSE_PRAGMA,\n        status: resp.status,\n        reason: resp.reason,\n        data: resp.compositeSignature || resp.data || {},\n        updates: normalizeBackChannelRpc(resp.authorizationUpdates),\n        local: normalizeFrame((resp.local || [])[0]),\n      }\n  }\n}\n","import {COMPOSITE_SIGNATURE_PRAGMA} from \"./__vsn\"\nimport {sansPrefix} from \"@onflow/util-address\"\n\n// {\n//    \"f_type\": \"CompositeSignature\",\n//    \"f_vsn\": \"1.0.0\",\n//    \"addr\": \"_____\",         // sans-prefix\n//    \"signature\": \"adfe1234\", // hex\n//    \"keyId\": 3,\n// }\nexport function normalizeCompositeSignature(resp) {\n  if (resp == null) return null\n\n  switch (resp[\"f_vsn\"]) {\n    case \"1.0.0\":\n      return resp\n\n    default:\n      return {\n        ...COMPOSITE_SIGNATURE_PRAGMA,\n        addr: sansPrefix(resp.addr || resp.address),\n        signature: resp.signature || resp.sig,\n        keyId: resp.keyId,\n      }\n  }\n}\n","import {invariant} from \"@onflow/util-invariant\"\n\nconst FRAME = \"FCL_IFRAME\"\n\nconst FRAME_STYLES = `\n  position:fixed;\n  top: 0px;\n  right: 0px;\n  bottom: 0px;\n  left: 0px;\n  height: 100vh;\n  width: 100vw;\n  display:block;\n  background:rgba(0,0,0,0.25);\n  z-index: 2147483647;\n  box-sizing: border-box;\n`\n\nexport function renderFrame(src) {\n  invariant(\n    !document.getElementById(FRAME),\n    \"Attempt at triggering multiple Frames\",\n    {src}\n  )\n\n  const $frame = document.createElement(\"iframe\")\n  $frame.src = src\n  $frame.id = FRAME\n  $frame.allow = \"usb *; hid *\"\n  $frame.frameBorder = \"0\"\n  $frame.style.cssText = FRAME_STYLES\n  document.body.append($frame)\n\n  const unmount = () => {\n    if (document.getElementById(FRAME)) {\n      document.getElementById(FRAME).remove()\n    }\n  }\n\n  return [$frame, unmount]\n}\n","import {renderFrame} from \"./render-frame\"\nimport {serviceEndpoint} from \"./service-endpoint\"\n\nconst CLOSE_EVENT = \"FCL:FRAME:CLOSE\"\nconst READY_EVENT = \"FCL:FRAME:READY\"\nconst RESPONSE_EVENT = \"FCL:FRAME:RESPONSE\"\nconst OPEN_EVENT = \"FCL:FRAME:OPEN\"\n\nconst noop = () => {}\n\nconst IGNORE = new Set([\n  \"monetizationstart\",\n  \"monetizationpending\",\n  \"monetizationprogress\",\n  \"monetizationstop\",\n])\n\nexport function frame(service, opts = {}) {\n  if (service == null) return {send: noop, close: noop}\n\n  var tab = null\n  const onClose = opts.onClose || noop\n  const onMessage = opts.onMessage || noop\n  const onReady = opts.onReady || noop\n  const onResponse = opts.onResponse || noop\n\n  window.addEventListener(\"message\", internal)\n  const [$frame, unmount] = renderFrame(serviceEndpoint(service))\n  return {send, close}\n\n  function internal(e) {\n    try {\n      if (typeof e.data !== \"object\") return\n      if (IGNORE.has(e.data.type)) return\n      if (e.data.type === CLOSE_EVENT) close()\n      if (e.data.type === READY_EVENT) onReady(e, {send, close})\n      if (e.data.type === RESPONSE_EVENT) onResponse(e, {send, close})\n      onMessage(e, {send, close})\n\n      // Backwards Compatible\n      if (e.data.type === \"FCL::CHALLENGE::RESPONSE\") {\n        onResponse(e, {send, close})\n      }\n      if (e.data.type === \"FCL::AUTHZ_READY\") onReady(e, {send, close})\n      if (e.data.type === \"FCL::CHALLENGE::CANCEL\") close()\n      if (e.data.type === \"FCL::CANCEL\") close()\n    } catch (error) {\n      console.error(\"Frame Callback Error\", error)\n      close()\n    }\n  }\n\n  function close() {\n    try {\n      window.removeEventListener(\"message\", internal)\n      if (tab != null) tab.close()\n      unmount()\n      onClose()\n    } catch (error) {\n      console.error(\"Frame Close Error\", error)\n    }\n  }\n\n  function send(msg) {\n    try {\n      $frame.contentWindow.postMessage(\n        JSON.parse(JSON.stringify(msg || {})),\n        \"*\"\n      )\n    } catch (error) {\n      console.error(\"Frame Send Error\", msg, error)\n    }\n  }\n\n  function open(msg) {\n    try {\n      tab = window.open(msg.endpoint)\n      tab.focus()\n    } catch (error) {\n      console.error(\"Frame Open Error\", msg, error)\n    }\n  }\n}\n","import {normalizePollingResponse} from \"../../../normalize/polling-response\"\nimport {serviceEndpoint} from \"./service-endpoint\"\nimport {invariant} from \"@onflow/util-invariant\"\nimport {fetchService} from \"./fetch-service\"\n\nconst OPTIONS = {\n  \"HTTP/GET\": \"GET\",\n  \"HTTP/POST\": \"POST\",\n}\n\nconst serviceMethod = service => {\n  invariant(\n    OPTIONS[service.method],\n    \"Invalid Service Method for type back-channel-rpc\",\n    {service}\n  )\n  return OPTIONS[service.method]\n}\n\nconst serviceBody = service => {\n  if (service.method === \"HTTP/GET\") return undefined\n  if (service.method === \"HTTP/POST\" && service.data != null)\n    return JSON.stringify(service.data)\n  return undefined\n}\n\nexport async function poll(service, canContinue = () => true) {\n  invariant(service, \"Missing Polling Service\", {service})\n  if (!canContinue()) throw new Error(\"Externally Halted\")\n\n  const resp = await fetchService(service, {\n    method: serviceMethod(service),\n  }).then(normalizePollingResponse)\n\n  switch (resp.status) {\n    case \"APPROVED\":\n      return resp.data\n    case \"DECLINED\":\n      throw new Error(`Declined: ${resp.reason || \"No reason supplied.\"}`)\n    default:\n      await new Promise(r => setTimeout(r, 500))\n      return poll(resp.updates, canContinue)\n  }\n}\n","import {fetchService} from \"./utils/fetch-service\"\nimport {serviceEndpoint} from \"./utils/service-endpoint\"\nimport {normalizePollingResponse} from \"../../normalize/polling-response\"\nimport {normalizeCompositeSignature} from \"../../normalize/composite-signature\"\nimport {frame} from \"./utils/frame\"\nimport {poll} from \"./utils/poll\"\n\nexport async function execHttpPost(service, signable, opts) {\n  signable.data = service.data\n  const resp = await fetchService(service, {\n    data: signable,\n  }).then(normalizePollingResponse)\n\n  if (resp.status === \"APPROVED\") {\n    return resp.data\n  } else if (resp.status === \"DECLINED\") {\n    throw new Error(`Declined: ${resp.reason || \"No reason supplied.\"}`)\n  } else if (resp.status === \"PENDING\") {\n    var canContinue = true\n    const {close: closeFrame} = frame(resp.local, {\n      onClose() {\n        canContinue = false\n      },\n    })\n\n    return poll(resp.updates, () => canContinue)\n      .then(compositeSignature => {\n        closeFrame()\n        return normalizeCompositeSignature(compositeSignature)\n      })\n      .catch(error => {\n        console.error(error)\n        closeFrame()\n        throw error\n      })\n  } else {\n    console.error(`Auto Decline: Invalid Response`, {service, resp})\n    throw new Error(`Auto Decline: Invalid Response`)\n  }\n}\n","import {execHttpPost} from \"./strategies/http-post\"\nimport {execIframeRPC} from \"./strategies/iframe-rpc\"\n\nconst STRATEGIES = {\n  \"HTTP/RPC\": execHttpPost,\n  \"HTTP/POST\": execHttpPost,\n  \"IFRAME/RPC\": execIframeRPC,\n}\n\nexport async function execService(service, msg, opts = {}) {\n  try {\n    return STRATEGIES[service.method](service, msg, opts)\n  } catch (error) {\n    console.error(\"execService(service, msg)\", error, {service, msg, opts})\n    throw error\n  }\n}\n","import {uid} from \"@onflow/util-uid\"\nimport {frame} from \"./utils/frame\"\nimport {normalizePollingResponse} from \"../../normalize/polling-response\"\nimport {normalizeCompositeSignature} from \"../../normalize/composite-signature\"\n\nexport function execIframeRPC(service, body, opts) {\n  return new Promise((resolve, reject) => {\n    const id = uid()\n    const includeOlderJsonRpcCall = opts.includeOlderJsonRpcCall\n\n    body.data = service.data\n\n    frame(service, {\n      onReady(_, {send}) {\n        try {\n          send({\n            type: \"FCL:FRAME:READY:RESPONSE\",\n            body,\n            service: {\n              params: service.params,\n              data: service.data,\n            },\n          })\n          if (includeOlderJsonRpcCall) {\n            send({\n              jsonrpc: \"2.0\",\n              id: id,\n              method: \"fcl:sign\",\n              params: [body, service.params],\n            })\n          }\n        } catch (error) {\n          throw error\n        }\n      },\n\n      onResponse(e, {send, close}) {\n        try {\n          if (typeof e.data !== \"object\") return\n          const resp = normalizePollingResponse(e.data)\n\n          switch (resp.status) {\n            case \"APPROVED\":\n              resolve(normalizeCompositeSignature(resp.data))\n              close()\n              break\n\n            case \"DECLINED\":\n              reject(`Declined: ${resp.reason || \"No reason supplied\"}`)\n              close()\n              break\n\n            default:\n              reject(`Declined: No reason supplied`)\n              close()\n              break\n          }\n        } catch (error) {\n          console.error(\"execIframeRPC onResponse error\", error)\n          throw error\n        }\n      },\n\n      onMessage(e, {close}) {\n        try {\n          if (typeof e.data !== \"object\") return\n          if (e.data.jsonrpc !== \"2.0\") return\n          if (e.data.id !== id) return\n          const resp = normalizePollingResponse(e.data.result)\n\n          switch (resp.status) {\n            case \"APPROVED\":\n              resolve(normalizeCompositeSignature(resp.data))\n              close()\n              break\n\n            case \"DECLINED\":\n              reject(`Declined: ${resp.reason || \"No reason supplied\"}`)\n              close()\n              break\n\n            default:\n              reject(`Declined: No reason supplied`)\n              close()\n              break\n          }\n        } catch (error) {\n          console.error(\"execIframeRPC onMessage error\", error)\n          throw error\n        }\n      },\n\n      onClose() {\n        reject(`Declined: Externally Halted`)\n      },\n    })\n  })\n}\n","import \"../default-config\"\nimport {account, config} from \"@onflow/sdk\"\nimport {spawn, send, INIT, SUBSCRIBE, UNSUBSCRIBE} from \"@onflow/util-actor\"\nimport {sansPrefix} from \"@onflow/util-address\"\nimport {invariant} from \"@onflow/util-invariant\"\nimport {buildUser} from \"./build-user\"\nimport {serviceOfType} from \"./service-of-type\"\nimport {execService} from \"./exec-service\"\nimport {frame} from \"./exec-service/strategies/utils/frame\"\n\nconst NAME = \"CURRENT_USER\"\nconst UPDATED = \"CURRENT_USER/UPDATED\"\nconst SNAPSHOT = \"SNAPSHOT\"\nconst SET_CURRENT_USER = \"SET_CURRENT_USER\"\nconst DEL_CURRENT_USER = \"DEL_CURRENT_USER\"\n\nconst DATA = `{\n  \"f_type\": \"User\",\n  \"f_vsn\": \"1.0.0\",\n  \"addr\":null,\n  \"cid\":null,\n  \"loggedIn\":null,\n  \"expiresAt\":null,\n  \"services\":[]\n}`\n\nconst coldStorage = {\n  get: async () => {\n    const fallback = JSON.parse(DATA)\n    const stored = JSON.parse(sessionStorage.getItem(NAME))\n    if (stored != null && fallback[\"f_vsn\"] !== stored[\"f_vsn\"]) {\n      sessionStorage.removeItem(NAME)\n      return fallback\n    }\n    return stored || fallback\n  },\n  put: async data => {\n    sessionStorage.setItem(NAME, JSON.stringify(data))\n    return data\n  },\n}\n\nconst canColdStorage = () => {\n  return config().get(\"persistSession\", true)\n}\n\nconst HANDLERS = {\n  [INIT]: async ctx => {\n    ctx.merge(JSON.parse(DATA))\n    if (await canColdStorage()) {\n      const user = await coldStorage.get()\n      if (notExpired(user)) ctx.merge(user)\n    }\n  },\n  [SUBSCRIBE]: (ctx, letter) => {\n    ctx.subscribe(letter.from)\n    ctx.send(letter.from, UPDATED, {...ctx.all()})\n  },\n  [UNSUBSCRIBE]: (ctx, letter) => {\n    ctx.unsubscribe(letter.from)\n  },\n  [SNAPSHOT]: async (ctx, letter) => {\n    letter.reply({...ctx.all()})\n  },\n  [SET_CURRENT_USER]: async (ctx, letter, data) => {\n    ctx.merge(data)\n    if (await canColdStorage()) coldStorage.put(ctx.all())\n    ctx.broadcast(UPDATED, {...ctx.all()})\n  },\n  [DEL_CURRENT_USER]: async (ctx, letter) => {\n    ctx.merge(JSON.parse(DATA))\n    if (await canColdStorage()) coldStorage.put(ctx.all())\n    ctx.broadcast(UPDATED, {...ctx.all()})\n  },\n}\n\nconst identity = v => v\nconst spawnCurrentUser = () => spawn(HANDLERS, NAME)\n\nfunction notExpired(user) {\n  return (\n    user.expiresAt == null ||\n    user.expiresAt === 0 ||\n    user.expiresAt > Date.now()\n  )\n}\n\nasync function configLens(regex) {\n  return Object.fromEntries(\n    Object.entries(await config().where(regex)).map(([key, value]) => [\n      key.replace(regex, \"\"),\n      value,\n    ])\n  )\n}\n\nasync function authenticate(opts = {}) {\n  return new Promise(async (resolve, reject) => {\n    spawnCurrentUser()\n    const user = await snapshot()\n    if (user.loggedIn && notExpired(user)) return resolve(user)\n    const serviceStrategy = opts.serviceStrategy || frame\n\n    serviceStrategy(\n      {\n        endpoint:\n          (await config().get(\"discovery.wallet\")) ||\n          (await config().get(\"challenge.handshake\")),\n      },\n      {\n        async onReady(e, {send, close}) {\n          send({\n            type: \"FCL:AUTHN:CONFIG\",\n            services: await configLens(/^service\\./),\n            app: await configLens(/^app\\.detail\\./),\n          })\n        },\n        async onClose() {\n          resolve(await snapshot())\n        },\n        async onResponse(e, {close}) {\n          send(NAME, SET_CURRENT_USER, await buildUser(e.data))\n          resolve(await snapshot())\n          close()\n        },\n      }\n    )\n  })\n}\n\nfunction unauthenticate() {\n  spawnCurrentUser()\n  send(NAME, DEL_CURRENT_USER)\n}\n\nconst normalizePreAuthzResponse = authz => ({\n  f_type: \"PreAuthzResponse\",\n  f_vsn: \"1.0.0\",\n  proposer: (authz || {}).proposer,\n  payer: (authz || {}).payer || [],\n  authorization: (authz || {}).authorization || [],\n})\n\nfunction resolvePreAuthz(authz) {\n  const resp = normalizePreAuthzResponse(authz)\n  const axs = []\n\n  if (resp.proposer != null) axs.push([\"PROPOSER\", resp.proposer])\n  for (let az of resp.payer || []) axs.push([\"PAYER\", az])\n  for (let az of resp.authorization || []) axs.push([\"AUTHORIZER\", az])\n\n  var result = axs.map(([role, az]) => ({\n    tempId: [az.identity.address, az.identity.keyId].join(\"|\"),\n    addr: az.identity.address,\n    keyId: az.identity.keyId,\n    signingFunction(signable) {\n      return execService(az, signable)\n    },\n    role: {\n      proposer: role === \"PROPOSER\",\n      payer: role === \"PAYER\",\n      authorizer: role === \"AUTHORIZER\",\n    },\n  }))\n  return result\n}\n\nasync function authorization(account) {\n  spawnCurrentUser()\n  const user = await authenticate()\n  const authz = serviceOfType(user.services, \"authz\")\n\n  const preAuthz = serviceOfType(user.services, \"pre-authz\")\n  if (preAuthz) {\n    return {\n      ...account,\n      tempId: \"CURRENT_USER\",\n      async resolve(account, preSignable) {\n        return resolvePreAuthz(await execService(preAuthz, preSignable))\n      },\n    }\n  }\n\n  return {\n    ...account,\n    tempId: \"CURRENT_USER\",\n    resolve: null,\n    addr: sansPrefix(authz.identity.address),\n    keyId: authz.identity.keyId,\n    sequenceNum: null,\n    signature: null,\n    async signingFunction(signable) {\n      return execService(authz, signable, {\n        includeOlderJsonRpcCall: true,\n      })\n    },\n  }\n}\n\nfunction subscribe(callback) {\n  spawnCurrentUser()\n  const EXIT = \"@EXIT\"\n  const self = spawn(async ctx => {\n    ctx.send(NAME, SUBSCRIBE)\n    while (1) {\n      const letter = await ctx.receive()\n      if (letter.tag === EXIT) {\n        ctx.send(NAME, UNSUBSCRIBE)\n        return\n      }\n      callback(letter.data)\n    }\n  })\n  return () => send(self, EXIT)\n}\n\nfunction snapshot() {\n  spawnCurrentUser()\n  return send(NAME, SNAPSHOT, null, {expectReply: true, timeout: 0})\n}\n\nasync function info() {\n  spawnCurrentUser()\n  const {addr} = await snapshot()\n  if (addr == null) throw new Error(\"No Flow Address for Current User\")\n  return account(addr)\n}\n\nconst makeSignable = msg => {\n  invariant(/^[0-9a-f]+$/i.test(msg), \"Message must be a hex string\")\n\n  return {\n    message: msg,\n  }\n}\n\nasync function signUserMessage(msg, opts = {}) {\n  spawnCurrentUser()\n  const user = await authenticate(opts)\n  const signingService = serviceOfType(user.services, \"user-signature\")\n\n  invariant(\n    signingService,\n    \"Current user must have authorized a signing service.\"\n  )\n\n  try {\n    return await execService(signingService, makeSignable(msg))\n  } catch (error) {\n    console.log(error)\n  }\n}\n\nexport const currentUser = () => {\n  return {\n    authenticate,\n    unauthenticate,\n    authorization,\n    signUserMessage,\n    subscribe,\n    snapshot,\n  }\n}\n","export async function fetchServices(servicesURL, code) {\n  if (servicesURL == null || code == null) return []\n\n  const url = new URL(servicesURL)\n  url.searchParams.append(\"code\", code)\n\n  const resp = await fetch(url, {\n    method: \"GET\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n    },\n  }).then(d => d.json())\n\n  if (Array.isArray(resp)) return resp\n\n  // Backwards compatibility for First-Gen Wallet Providers\n  const services = []\n\n  // Convert authorizations into authz services\n  if (Array.isArray(resp.authorizations)) {\n    for (let service of resp.authorizations) {\n      services.push({\n        type: \"authz\",\n        keyId: resp.keyId,\n        ...service,\n      })\n    }\n  }\n\n  // Convert Provider info into an authn service\n  if (resp.provider != null) {\n    services.push({\n      type: \"authn\",\n      id: \"wallet-provider#authn\",\n      ...resp.provider,\n    })\n  }\n\n  return services\n}\n","import {withPrefix} from \"@onflow/util-address\"\n\nexport function mergeServices(sx1 = [], sx2 = []) {\n  // TODO: Make this smarter\n  return [...sx1, ...sx2]\n}\n","import \"../default-config\"\nimport {\n  spawn,\n  send,\n  subscriber,\n  snapshoter,\n  UPDATED,\n  SNAPSHOT,\n  INIT,\n  SUBSCRIBE,\n  UNSUBSCRIBE,\n} from \"@onflow/util-actor\"\nimport {send as fclSend, decode, getTransactionStatus} from \"@onflow/sdk\"\n\nconst RATE = 2500\nconst POLL = \"POLL\"\n\nconst fetchTxStatus = async transactionId => {\n  return fclSend([getTransactionStatus(transactionId)]).then(decode)\n}\n\nconst isExpired = tx => tx.status === 5\nconst isSealed = tx => tx.status >= 4\nconst isExecuted = tx => tx.status >= 3\nconst isFinalized = tx => tx.status >= 2\nconst isPending = tx => tx.status >= 1\nconst isUnknown = tx => tx.status >= 0\n\nconst isDiff = (cur, next) => {\n  return JSON.stringify(cur) !== JSON.stringify(next)\n}\n\nconst HANDLERS = {\n  [INIT]: async ctx => {\n    const tx = await fetchTxStatus(ctx.self())\n    if (!isSealed(tx)) setTimeout(() => ctx.sendSelf(POLL), RATE)\n    ctx.merge(tx)\n  },\n  [SUBSCRIBE]: (ctx, letter) => {\n    ctx.subscribe(letter.from)\n    ctx.send(letter.from, UPDATED, ctx.all())\n  },\n  [UNSUBSCRIBE]: (ctx, letter) => {\n    ctx.unsubscribe(letter.from)\n  },\n  [SNAPSHOT]: async (ctx, letter) => {\n    letter.reply(ctx.all())\n  },\n  [POLL]: async ctx => {\n    const tx = await fetchTxStatus(ctx.self())\n    if (!isSealed(tx)) setTimeout(() => ctx.sendSelf(POLL), RATE)\n    if (isDiff(ctx.all(), tx)) ctx.broadcast(UPDATED, tx)\n    ctx.merge(tx)\n  },\n}\n\nconst scoped = transactionId => {\n  if (typeof transactionId === \"object\")\n    transactionId = transactionId.transactionId\n  if (transactionId == null) throw new Error(\"transactionId required\")\n  return transactionId\n}\n\nconst spawnTransaction = transactionId => {\n  return spawn(HANDLERS, scoped(transactionId))\n}\n\nexport function transaction(transactionId) {\n  function snapshot() {\n    return snapshoter(transactionId, spawnTransaction)\n  }\n\n  function subscribe(callback) {\n    return subscriber(scoped(transactionId), spawnTransaction, callback)\n  }\n\n  function once(predicate) {\n    return function innerOnce(opts = {}) {\n      const suppress = opts.suppress || false\n      return new Promise((resolve, reject) => {\n        const unsub = subscribe(txStatus => {\n          if (txStatus.statusCode && !suppress) {\n            reject(txStatus.errorMessage)\n            unsub()\n          } else if (predicate(txStatus)) {\n            resolve(txStatus)\n            unsub()\n          }\n        })\n      })\n    }\n  }\n\n  return {\n    snapshot,\n    subscribe,\n    onceFinalized: once(isFinalized),\n    onceExecuted: once(isExecuted),\n    onceSealed: once(isSealed),\n  }\n}\n\ntransaction.isUnknown = isUnknown\ntransaction.isPending = isPending\ntransaction.isFinalized = isFinalized\ntransaction.isExecuted = isExecuted\ntransaction.isSealed = isSealed\ntransaction.isExpired = isExpired\n","import {invariant} from \"@onflow/util-invariant\"\nimport * as sdk from \"@onflow/sdk\"\nimport {isRequired, isObject, isString, isFunc, isNumber} from \"./utils/is\"\nimport {normalizeArgs} from \"./utils/normalize-args\"\nimport {currentUser} from \"../current-user\"\nimport {transaction} from \"../transaction\"\n\n/** As the current user Mutate the Flow Blockchain\n *\n *  @arg {Object} opts - Mutation Options and configuration\n *  @arg {string} opts.cadence - Cadence Transaction used to mutate Flow\n *  @arg {ArgsFn} opts.args - Arguments passed to cadence transaction\n *  @arg {number} opts.limit - Compute Limit for transaction\n *  @returns {string} Transaction Id\n *\n *  Where:\n *    @callback ArgsFn\n *    @arg {ArgFn}  arg - Argument function to define a single argument\n *    @arg {Object} t   - Cadence Types object used to define the type\n *    @returns {args[]}\n *\n *    @callback ArgFn\n *    @arg {Any}  value - the value of the argument\n *    @arg {Type} type  - the cadence type of the value\n *    @returns {arg}\n *\n *  Example:\n *    fcl.mutate({\n *      cadence: `\n *        transaction(a: Int, b: Int, c: Address) {\n *          prepare(acct: AuthAccount) {\n *            log(acct)\n *            log(a)\n *            log(b)\n *            log(c)\n *          }\n *        }\n *      `,\n *      args: (arg, t) => [\n *        arg(6, t.Int),\n *        arg(7, t.Int),\n *        arg(\"0xba1132bc08f82fe2\", t.Address),\n *      ],\n *    })\n *\n *\n *  Options:\n *    type Options = {\n *      cadence: String!,\n *      args: (arg, t) => Array<Arg>,\n *      limit: Number,\n *      authz: AuthzFn, // will overload the trinity of signatory roles\n *      proposer: AuthzFn, // will overload the proposer signatory role\n *      payer: AuthzFn, // will overload the payer signatory role\n *      authorizations: [AuthzFn], // an array of authorization functions used as authorizations signatory roles\n *    }\n */\n\nconst noop = () => {}\n\nexport async function mutate(opts = {}) {\n  var txid\n  try {\n    await prepMutation(opts)\n\n    // Allow for a config to overwrite the authorization function.\n    // prettier-ignore\n    const authz = await sdk.config().get(\"fcl.authz\", currentUser().authorization)\n\n    // prettier-ignore\n    txid = sdk.send([\n      sdk.transaction(opts.cadence),\n\n      sdk.args(normalizeArgs(opts.args || [])),\n\n      opts.limit && isNumber(opts.limit) && sdk.limit(opts.limit),\n\n      // opts.proposer > opts.authz > authz\n      sdk.proposer(opts.proposer || opts.authz || authz),\n\n      // opts.payer > opts.authz > authz\n      sdk.payer(opts.payer || opts.authz || authz),\n\n      // opts.authorizations > [opts.authz > authz]\n      sdk.authorizations(opts.authorizations || [opts.authz || authz]),\n    ]).then(sdk.decode)\n\n    return txid\n  } catch (error) {\n    throw error\n  }\n}\n\nasync function prepMutation(opts) {\n  // prettier-ignore\n  invariant(isRequired(opts), \"mutate(opts) -- opts is required\")\n  // prettier-ignore\n  invariant(isObject(opts), \"mutate(opts) -- opts must be an object\")\n  // prettier-ignore\n  invariant(isRequired(opts.cadence), \"mutate({ cadence }) -- cadence is required\")\n  // prettier-ignore\n  invariant(isString(opts.cadence), \"mutate({ cadence }) -- cadence must be a string\")\n}\n","import {interaction, pipe} from \"@onflow/sdk\"\nimport {resolve as defaultResolve} from \"@onflow/sdk\"\nimport {config, createSignableVoucher} from \"@onflow/sdk\"\n\nexport const serialize = async (args = [], opts = {}) => {\n  // prettier-ignore\n  const resolveFunction = await config()\n    .get(\"sdk.resolve\", opts.resolve || defaultResolve(opts))\n\n  if (Array.isArray(args)) args = await pipe(interaction(), args)\n\n  return JSON.stringify(\n    createSignableVoucher(await resolveFunction(args)),\n    null,\n    2\n  )\n}\n","import {spawn, subscriber, SUBSCRIBE, UNSUBSCRIBE} from \"@onflow/util-actor\"\nimport {config, latestBlock} from \"@onflow/sdk\"\nexport {getEvents} from \"@onflow/sdk\"\nimport {send} from \"@onflow/sdk\"\nimport {decode} from \"@onflow/sdk\"\n\nconst RATE = 10000\nconst UPDATED = \"UPDATED\"\nconst TICK = \"TICK\"\n\nconst scheduleTick = async ctx => {\n  return setTimeout(\n    () => ctx.sendSelf(TICK),\n    await config().get(\"fcl.eventPollRate\", RATE)\n  )\n}\n\nconst HANDLERS = {\n  [TICK]: async ctx => {\n    if (!ctx.hasSubs()) return\n    let hwm = ctx.get(\"hwm\")\n    if (hwm == null) {\n      ctx.put(\"hwm\", await latestBlock())\n      ctx.put(\"tick\", await scheduleTick(ctx))\n    } else {\n      let next = await latestBlock()\n      ctx.put(\"hwm\", next)\n      const data = await send([\n        getEvents(ctx.self(), hwm.height, next.height - 1),\n      ]).then(decode)\n      for (let d of data) ctx.broadcast(UPDATED, d.data)\n      ctx.put(\"tick\", await scheduleTick(ctx))\n    }\n  },\n  [SUBSCRIBE]: async (ctx, letter) => {\n    if (!ctx.hasSubs()) {\n      ctx.put(\"tick\", await scheduleTick(ctx))\n    }\n    ctx.subscribe(letter.from)\n  },\n  [UNSUBSCRIBE]: (ctx, letter) => {\n    ctx.unsubscribe(letter.from)\n    if (!ctx.hasSubs()) {\n      clearTimeout(ctx.get(\"tick\"))\n      ctx.delete(\"tick\")\n      ctx.delete(\"hwm\")\n    }\n  },\n}\n\nconst spawnEvents = key => spawn(HANDLERS, key)\n\nexport function events(key) {\n  return {\n    subscribe: callback => subscriber(key, spawnEvents, callback),\n  }\n}\n","import \"./default-config\"\nexport {VERSION} from \"./VERSION\"\nexport {query} from \"./exec/query\"\nexport {mutate} from \"./exec/mutate\"\nexport {serialize} from \"./serialize\"\nexport {transaction as tx} from \"./transaction\"\nexport {events} from \"./events\"\n\nimport {currentUser} from \"./current-user\"\nexport {currentUser}\n\nexport const authenticate = opts => currentUser().authenticate(opts)\nexport const unauthenticate = () => currentUser().unauthenticate()\nexport const reauthenticate = () => {\n  currentUser().unauthenticate()\n  return currentUser().authenticate()\n}\nexport const signUp = opts => currentUser().authenticate()\nexport const logIn = opts => currentUser().authenticate()\n\nexport const authz = currentUser().authorization\n\nimport * as types from \"@onflow/types\"\nexport const t = types\n\nexport {config} from \"@onflow/sdk\"\nexport {send} from \"@onflow/sdk\"\nexport {decode} from \"@onflow/sdk\"\nexport {account} from \"@onflow/sdk\"\nexport {latestBlock} from \"@onflow/sdk\"\nexport {isOk, isBad, why, pipe, build} from \"@onflow/sdk\"\nexport {withPrefix, sansPrefix, display} from \"@onflow/util-address\"\nexport {template as cadence} from \"@onflow/util-template\"\nexport {template as cdc} from \"@onflow/util-template\"\nexport {createSignableVoucher} from \"@onflow/sdk\"\n\n// builders\nexport {transaction} from \"@onflow/sdk\"\nexport {script} from \"@onflow/sdk\"\nexport {ping} from \"@onflow/sdk\"\nexport {atBlockHeight} from \"@onflow/sdk\"\nexport {atBlockId} from \"@onflow/sdk\"\nexport {getAccount} from \"@onflow/sdk\"\nexport {getEvents} from \"@onflow/sdk\"\nexport {getEventsAtBlockHeightRange} from \"@onflow/sdk\"\nexport {getEventsAtBlockIds} from \"@onflow/sdk\"\nexport {getLatestBlock} from \"@onflow/sdk\"\nexport {getBlock} from \"@onflow/sdk\"\nexport {getBlockHeader} from \"@onflow/sdk\"\nexport {getBlockById} from \"@onflow/sdk\"\nexport {getBlockByHeight} from \"@onflow/sdk\"\nexport {getCollection} from \"@onflow/sdk\"\nexport {getTransactionStatus} from \"@onflow/sdk\"\nexport {getTransaction} from \"@onflow/sdk\"\nexport {authorizations, authorization} from \"@onflow/sdk\"\nexport {args, arg} from \"@onflow/sdk\"\nexport {proposer} from \"@onflow/sdk\"\nexport {payer} from \"@onflow/sdk\"\nexport {limit} from \"@onflow/sdk\"\nexport {ref} from \"@onflow/sdk\"\nexport {params, param} from \"@onflow/sdk\"\nexport {validator} from \"@onflow/sdk\"\nexport {invariant} from \"@onflow/sdk\"\n"]},"metadata":{},"sourceType":"module"}