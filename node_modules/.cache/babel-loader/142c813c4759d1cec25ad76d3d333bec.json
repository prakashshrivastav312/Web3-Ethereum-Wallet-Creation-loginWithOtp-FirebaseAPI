{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.CallBuilder = void 0;\n\nvar tslib_1 = require(\"tslib\");\n\nvar detect_node_1 = tslib_1.__importDefault(require(\"detect-node\"));\n\nvar urijs_1 = tslib_1.__importDefault(require(\"urijs\"));\n\nvar URITemplate_1 = tslib_1.__importDefault(require(\"urijs/src/URITemplate\"));\n\nvar errors_1 = require(\"./errors\");\n\nvar horizon_axios_client_1 = tslib_1.__importDefault(require(\"./horizon_axios_client\"));\n\nvar version = require(\"../package.json\").version;\n\nvar JOINABLE = [\"transaction\"];\nvar EventSource;\nvar anyGlobal = global;\n\nif (anyGlobal.EventSource) {\n  EventSource = anyGlobal.EventSource;\n} else if (detect_node_1.default) {\n  EventSource = require(\"eventsource\");\n} else {\n  EventSource = anyGlobal.window.EventSource;\n}\n\nvar CallBuilder = function () {\n  function CallBuilder(serverUrl) {\n    this.url = serverUrl.clone();\n    this.filter = [];\n    this.originalSegments = this.url.segment() || [];\n  }\n\n  CallBuilder.prototype.call = function () {\n    var _this = this;\n\n    this.checkFilter();\n    return this._sendNormalRequest(this.url).then(function (r) {\n      return _this._parseResponse(r);\n    });\n  };\n\n  CallBuilder.prototype.stream = function (options) {\n    var _this = this;\n\n    if (options === void 0) {\n      options = {};\n    }\n\n    this.checkFilter();\n    this.url.setQuery(\"X-Client-Name\", \"js-stellar-sdk\");\n    this.url.setQuery(\"X-Client-Version\", version);\n    var es;\n    var timeout;\n\n    var createTimeout = function () {\n      timeout = setTimeout(function () {\n        if (es) {\n          es.close();\n        }\n\n        es = createEventSource();\n      }, options.reconnectTimeout || 15 * 1000);\n    };\n\n    var createEventSource = function () {\n      try {\n        es = new EventSource(_this.url.toString());\n      } catch (err) {\n        if (options.onerror) {\n          options.onerror(err);\n        }\n      }\n\n      createTimeout();\n\n      if (es) {\n        var closed_1 = false;\n\n        var onClose_1 = function () {\n          if (closed_1) {\n            return;\n          }\n\n          clearTimeout(timeout);\n          es.close();\n          createEventSource();\n          closed_1 = true;\n        };\n\n        var onMessage = function (message) {\n          if (message.type === \"close\") {\n            onClose_1();\n            return;\n          }\n\n          var result = message.data ? _this._parseRecord(JSON.parse(message.data)) : message;\n\n          if (result.paging_token) {\n            _this.url.setQuery(\"cursor\", result.paging_token);\n          }\n\n          clearTimeout(timeout);\n          createTimeout();\n\n          if (typeof options.onmessage !== \"undefined\") {\n            options.onmessage(result);\n          }\n        };\n\n        var onError = function (error) {\n          if (options.onerror) {\n            options.onerror(error);\n          }\n        };\n\n        if (es.addEventListener) {\n          es.addEventListener(\"message\", onMessage.bind(_this));\n          es.addEventListener(\"error\", onError.bind(_this));\n          es.addEventListener(\"close\", onClose_1.bind(_this));\n        } else {\n          es.onmessage = onMessage.bind(_this);\n          es.onerror = onError.bind(_this);\n        }\n      }\n\n      return es;\n    };\n\n    createEventSource();\n    return function close() {\n      clearTimeout(timeout);\n\n      if (es) {\n        es.close();\n      }\n    };\n  };\n\n  CallBuilder.prototype.cursor = function (cursor) {\n    this.url.setQuery(\"cursor\", cursor);\n    return this;\n  };\n\n  CallBuilder.prototype.limit = function (recordsNumber) {\n    this.url.setQuery(\"limit\", recordsNumber.toString());\n    return this;\n  };\n\n  CallBuilder.prototype.order = function (direction) {\n    this.url.setQuery(\"order\", direction);\n    return this;\n  };\n\n  CallBuilder.prototype.join = function (include) {\n    this.url.setQuery(\"join\", include);\n    return this;\n  };\n\n  CallBuilder.prototype.checkFilter = function () {\n    if (this.filter.length >= 2) {\n      throw new errors_1.BadRequestError(\"Too many filters specified\", this.filter);\n    }\n\n    if (this.filter.length === 1) {\n      var newSegment = this.originalSegments.concat(this.filter[0]);\n      this.url.segment(newSegment);\n    }\n  };\n\n  CallBuilder.prototype._requestFnForLink = function (link) {\n    var _this = this;\n\n    return function (opts) {\n      if (opts === void 0) {\n        opts = {};\n      }\n\n      return tslib_1.__awaiter(_this, void 0, void 0, function () {\n        var uri, template, r;\n        return tslib_1.__generator(this, function (_a) {\n          switch (_a.label) {\n            case 0:\n              if (link.templated) {\n                template = URITemplate_1.default(link.href);\n                uri = urijs_1.default(template.expand(opts));\n              } else {\n                uri = urijs_1.default(link.href);\n              }\n\n              return [4, this._sendNormalRequest(uri)];\n\n            case 1:\n              r = _a.sent();\n              return [2, this._parseResponse(r)];\n          }\n        });\n      });\n    };\n  };\n\n  CallBuilder.prototype._parseRecord = function (json) {\n    var _this = this;\n\n    if (!json._links) {\n      return json;\n    }\n\n    var _loop_1 = function (key) {\n      var n = json._links[key];\n      var included = false;\n\n      if (typeof json[key] !== \"undefined\") {\n        json[key + \"_attr\"] = json[key];\n        included = true;\n      }\n\n      if (included && JOINABLE.indexOf(key) >= 0) {\n        var record_1 = this_1._parseRecord(json[key]);\n\n        json[key] = function () {\n          return tslib_1.__awaiter(_this, void 0, void 0, function () {\n            return tslib_1.__generator(this, function (_a) {\n              return [2, record_1];\n            });\n          });\n        };\n      } else {\n        json[key] = this_1._requestFnForLink(n);\n      }\n    };\n\n    var this_1 = this;\n\n    for (var _i = 0, _a = Object.keys(json._links); _i < _a.length; _i++) {\n      var key = _a[_i];\n\n      _loop_1(key);\n    }\n\n    return json;\n  };\n\n  CallBuilder.prototype._sendNormalRequest = function (initialUrl) {\n    return tslib_1.__awaiter(this, void 0, void 0, function () {\n      var url;\n      return tslib_1.__generator(this, function (_a) {\n        url = initialUrl;\n\n        if (url.authority() === \"\") {\n          url = url.authority(this.url.authority());\n        }\n\n        if (url.protocol() === \"\") {\n          url = url.protocol(this.url.protocol());\n        }\n\n        return [2, horizon_axios_client_1.default.get(url.toString()).then(function (response) {\n          return response.data;\n        }).catch(this._handleNetworkError)];\n      });\n    });\n  };\n\n  CallBuilder.prototype._parseResponse = function (json) {\n    if (json._embedded && json._embedded.records) {\n      return this._toCollectionPage(json);\n    }\n\n    return this._parseRecord(json);\n  };\n\n  CallBuilder.prototype._toCollectionPage = function (json) {\n    var _this = this;\n\n    for (var i = 0; i < json._embedded.records.length; i += 1) {\n      json._embedded.records[i] = this._parseRecord(json._embedded.records[i]);\n    }\n\n    return {\n      records: json._embedded.records,\n      next: function () {\n        return tslib_1.__awaiter(_this, void 0, void 0, function () {\n          var r;\n          return tslib_1.__generator(this, function (_a) {\n            switch (_a.label) {\n              case 0:\n                return [4, this._sendNormalRequest(urijs_1.default(json._links.next.href))];\n\n              case 1:\n                r = _a.sent();\n                return [2, this._toCollectionPage(r)];\n            }\n          });\n        });\n      },\n      prev: function () {\n        return tslib_1.__awaiter(_this, void 0, void 0, function () {\n          var r;\n          return tslib_1.__generator(this, function (_a) {\n            switch (_a.label) {\n              case 0:\n                return [4, this._sendNormalRequest(urijs_1.default(json._links.prev.href))];\n\n              case 1:\n                r = _a.sent();\n                return [2, this._toCollectionPage(r)];\n            }\n          });\n        });\n      }\n    };\n  };\n\n  CallBuilder.prototype._handleNetworkError = function (error) {\n    return tslib_1.__awaiter(this, void 0, void 0, function () {\n      return tslib_1.__generator(this, function (_a) {\n        if (error.response && error.response.status && error.response.statusText) {\n          switch (error.response.status) {\n            case 404:\n              return [2, Promise.reject(new errors_1.NotFoundError(error.response.statusText, error.response.data))];\n\n            default:\n              return [2, Promise.reject(new errors_1.NetworkError(error.response.statusText, error.response.data))];\n          }\n        } else {\n          return [2, Promise.reject(new Error(error.message))];\n        }\n\n        return [2];\n      });\n    });\n  };\n\n  return CallBuilder;\n}();\n\nexports.CallBuilder = CallBuilder;","map":{"version":3,"mappings":"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","names":["version","require","JOINABLE","EventSource","anyGlobal","global","detect_node_1","window","serverUrl","url","clone","filter","originalSegments","segment","CallBuilder","checkFilter","_sendNormalRequest","then","r","_parseResponse","options","setQuery","es","timeout","createTimeout","setTimeout","close","createEventSource","reconnectTimeout","_this","toString","err","onerror","closed_1","onClose_1","clearTimeout","onMessage","message","type","result","data","_parseRecord","JSON","parse","paging_token","onmessage","onError","error","addEventListener","bind","cursor","recordsNumber","direction","include","length","errors_1","newSegment","concat","link","opts","templated","template","URITemplate_1","href","uri","urijs_1","expand","_a","json","_links","key","n","included","indexOf","record_1","this_1","_requestFnForLink","keys","_i","initialUrl","authority","protocol","horizon_axios_client_1","get","response","catch","_handleNetworkError","_embedded","records","_toCollectionPage","i","next","prev","status","statusText","Promise","reject","Error","exports"],"sourceRoot":"","sources":["../src/call_builder.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}