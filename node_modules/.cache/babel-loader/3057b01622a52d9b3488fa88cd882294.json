{"ast":null,"code":"/*\n    Copyright 2020 The caver-js Authors\n    This file is part of the caver-js library.\n\n    The caver-js library is free software: you can redistribute it and/or modify\n    it under the terms of the GNU Lesser General Public License as published by\n    the Free Software Foundation, either version 3 of the License, or\n    (at your option) any later version.\n\n    The caver-js library is distributed in the hope that it will be useful,\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\n    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n    GNU Lesser General Public License for more details.\n\n    You should have received a copy of the GNU Lesser General Public License\n    along with the caver-js. If not, see <http://www.gnu.org/licenses/>.\n*/\nconst _ = require('lodash');\n/**\n * Representing an options for AccountKeyWeightedMultiSig.\n * This class will define threshold and weights.\n * @class\n */\n\n\nclass WeightedMultiSigOptions {\n  /**\n   * Creates an instance of WeightedMultiSigOptions.\n   *\n   * @example\n   * const options = caver.account.weightedMultiSigOptions.fromObject({ threshold: 2, weights: [1, 1] })\n   *\n   * @param {object} options - An object which defines 'threshold' and 'weights'.\n   * @return {WeightedMultiSigOptions}\n   */\n  static fromObject(options) {\n    // To support the previous options format(threshold and weight)\n    if (options.weight && !options.weights) {\n      options.weights = options.weight;\n      delete options.weight;\n    } // Returns empty WeightedMultiSigOptions if options not define threshold and weights like '{}'\n\n\n    if (options.threshold === undefined && options.weights === undefined) return new WeightedMultiSigOptions();\n    if (options.threshold === undefined || options.weights === undefined) throw new Error(`Invalid object for creating WeightedMultiSigOptions. 'threshold' and 'weights' should be defined.`);\n    return new WeightedMultiSigOptions(options.threshold, options.weights);\n  }\n  /**\n   * Creates an instance of WeightedMultiSigOptions.\n   *\n   * @example\n   * const options = new caver.account.weightedMultiSigOptions(2, [1, 1])\n   *\n   * @param {number} threshold - a threshold\n   * @param {Array.<number>} weights - an array of weight of key\n   */\n\n\n  constructor(threshold, weights) {\n    if (threshold !== undefined && weights === undefined || threshold === undefined && weights !== undefined) {\n      throw new Error(`For creating an WeightedMultiSigOptions, 'threshold' and 'weights' should be defined.`);\n    }\n\n    if (threshold !== undefined) this.threshold = threshold;\n    if (weights !== undefined) this.weights = weights;\n  }\n  /**\n   * @type {number}\n   */\n\n\n  get threshold() {\n    return this._threshold;\n  }\n\n  set threshold(th) {\n    if (!_.isNumber(th)) throw new Error(`The threshold must be number type.`);\n    if (!validateWeightedSum(th, this.weights)) throw new Error('Invalid options for AccountKeyWeightedMultiSig: The sum of weights is less than the threshold.');\n    this._threshold = th;\n  }\n  /**\n   * @type {Array.<number>}\n   */\n\n\n  get weights() {\n    return this._weights;\n  }\n\n  set weights(weightArr) {\n    if (!_.isArray(weightArr)) throw new Error(`weight should be an array that stores the weight of each public key.`);\n\n    for (const w of weightArr) {\n      if (!_.isNumber(w)) throw new Error(`The weight of each key must be number type.`);\n    }\n\n    if (!validateWeightedSum(this.threshold, weightArr)) throw new Error('Invalid options for AccountKeyWeightedMultiSig: The sum of weights is less than the threshold.');\n    this._weights = weightArr;\n  }\n  /**\n   * Returns 'true' if WeightedMultiSigOptions is empty.\n   *\n   * @example\n   * const isEmpty = options.isEmpty()\n   *\n   * @return {Boolean}\n   */\n\n\n  isEmpty() {\n    return this.threshold === undefined && this.weights === undefined;\n  }\n\n}\n/**\n * validates threshold and sum of weights.\n * @ignore\n * @param {number} threshold - The threshold of the AccountKeyWeightedMultiSig.\n * @param {Array.<number>} weights - An array of weights.\n * @return {Boolean}\n */\n\n\nfunction validateWeightedSum(threshold, weights) {\n  if (threshold === undefined || weights === undefined) return true;\n  let weightSum = 0;\n\n  for (const w of weights) weightSum += w;\n\n  if (threshold > weightSum) return false;\n  return true;\n}\n\nmodule.exports = WeightedMultiSigOptions;","map":{"version":3,"names":["_","require","WeightedMultiSigOptions","fromObject","options","weight","weights","threshold","undefined","Error","constructor","_threshold","th","isNumber","validateWeightedSum","_weights","weightArr","isArray","w","isEmpty","weightSum","module","exports"],"sources":["C:/Users/acer/node_modules/caver-js/packages/caver-account/src/accountKey/weightedMultiSigOptions.js"],"sourcesContent":["/*\n    Copyright 2020 The caver-js Authors\n    This file is part of the caver-js library.\n\n    The caver-js library is free software: you can redistribute it and/or modify\n    it under the terms of the GNU Lesser General Public License as published by\n    the Free Software Foundation, either version 3 of the License, or\n    (at your option) any later version.\n\n    The caver-js library is distributed in the hope that it will be useful,\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\n    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n    GNU Lesser General Public License for more details.\n\n    You should have received a copy of the GNU Lesser General Public License\n    along with the caver-js. If not, see <http://www.gnu.org/licenses/>.\n*/\n\nconst _ = require('lodash')\n\n/**\n * Representing an options for AccountKeyWeightedMultiSig.\n * This class will define threshold and weights.\n * @class\n */\nclass WeightedMultiSigOptions {\n    /**\n     * Creates an instance of WeightedMultiSigOptions.\n     *\n     * @example\n     * const options = caver.account.weightedMultiSigOptions.fromObject({ threshold: 2, weights: [1, 1] })\n     *\n     * @param {object} options - An object which defines 'threshold' and 'weights'.\n     * @return {WeightedMultiSigOptions}\n     */\n    static fromObject(options) {\n        // To support the previous options format(threshold and weight)\n        if (options.weight && !options.weights) {\n            options.weights = options.weight\n            delete options.weight\n        }\n\n        // Returns empty WeightedMultiSigOptions if options not define threshold and weights like '{}'\n        if (options.threshold === undefined && options.weights === undefined) return new WeightedMultiSigOptions()\n\n        if (options.threshold === undefined || options.weights === undefined)\n            throw new Error(`Invalid object for creating WeightedMultiSigOptions. 'threshold' and 'weights' should be defined.`)\n\n        return new WeightedMultiSigOptions(options.threshold, options.weights)\n    }\n\n    /**\n     * Creates an instance of WeightedMultiSigOptions.\n     *\n     * @example\n     * const options = new caver.account.weightedMultiSigOptions(2, [1, 1])\n     *\n     * @param {number} threshold - a threshold\n     * @param {Array.<number>} weights - an array of weight of key\n     */\n    constructor(threshold, weights) {\n        if ((threshold !== undefined && weights === undefined) || (threshold === undefined && weights !== undefined)) {\n            throw new Error(`For creating an WeightedMultiSigOptions, 'threshold' and 'weights' should be defined.`)\n        }\n        if (threshold !== undefined) this.threshold = threshold\n        if (weights !== undefined) this.weights = weights\n    }\n\n    /**\n     * @type {number}\n     */\n    get threshold() {\n        return this._threshold\n    }\n\n    set threshold(th) {\n        if (!_.isNumber(th)) throw new Error(`The threshold must be number type.`)\n\n        if (!validateWeightedSum(th, this.weights))\n            throw new Error('Invalid options for AccountKeyWeightedMultiSig: The sum of weights is less than the threshold.')\n\n        this._threshold = th\n    }\n\n    /**\n     * @type {Array.<number>}\n     */\n    get weights() {\n        return this._weights\n    }\n\n    set weights(weightArr) {\n        if (!_.isArray(weightArr)) throw new Error(`weight should be an array that stores the weight of each public key.`)\n        for (const w of weightArr) {\n            if (!_.isNumber(w)) throw new Error(`The weight of each key must be number type.`)\n        }\n\n        if (!validateWeightedSum(this.threshold, weightArr))\n            throw new Error('Invalid options for AccountKeyWeightedMultiSig: The sum of weights is less than the threshold.')\n\n        this._weights = weightArr\n    }\n\n    /**\n     * Returns 'true' if WeightedMultiSigOptions is empty.\n     *\n     * @example\n     * const isEmpty = options.isEmpty()\n     *\n     * @return {Boolean}\n     */\n    isEmpty() {\n        return this.threshold === undefined && this.weights === undefined\n    }\n}\n\n/**\n * validates threshold and sum of weights.\n * @ignore\n * @param {number} threshold - The threshold of the AccountKeyWeightedMultiSig.\n * @param {Array.<number>} weights - An array of weights.\n * @return {Boolean}\n */\nfunction validateWeightedSum(threshold, weights) {\n    if (threshold === undefined || weights === undefined) return true\n\n    let weightSum = 0\n\n    for (const w of weights) weightSum += w\n\n    if (threshold > weightSum) return false\n\n    return true\n}\n\nmodule.exports = WeightedMultiSigOptions\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}