{"ast":null,"code":"'use strict';\n\nvar _ = require('lodash');\n\nvar BN = require('../crypto/bn');\n\nvar buffer = require('buffer');\n\nvar bufferUtil = require('../util/buffer');\n\nvar JSUtil = require('../util/js');\n\nvar BufferWriter = require('../encoding/bufferwriter');\n\nvar Script = require('../script');\n\nvar $ = require('../util/preconditions');\n\nvar errors = require('../errors');\n\nvar MAX_SAFE_INTEGER = 0x1fffffffffffff;\n\nfunction Output(args) {\n  if (!(this instanceof Output)) {\n    return new Output(args);\n  }\n\n  if (_.isObject(args)) {\n    this.satoshis = args.satoshis;\n\n    if (bufferUtil.isBuffer(args.script)) {\n      this._scriptBuffer = args.script;\n    } else {\n      var script;\n\n      if (_.isString(args.script) && JSUtil.isHexa(args.script)) {\n        script = new buffer.Buffer(args.script, 'hex');\n      } else {\n        script = args.script;\n      }\n\n      this.setScript(script);\n    }\n  } else {\n    throw new TypeError('Unrecognized argument for Output');\n  }\n}\n\nObject.defineProperty(Output.prototype, 'script', {\n  configurable: false,\n  enumerable: true,\n  get: function () {\n    if (this._script) {\n      return this._script;\n    } else {\n      this.setScriptFromBuffer(this._scriptBuffer);\n      return this._script;\n    }\n  }\n});\nObject.defineProperty(Output.prototype, 'satoshis', {\n  configurable: false,\n  enumerable: true,\n  get: function () {\n    return this._satoshis;\n  },\n  set: function (num) {\n    if (num instanceof BN) {\n      this._satoshisBN = num;\n      this._satoshis = num.toNumber();\n    } else if (_.isString(num)) {\n      this._satoshis = parseInt(num);\n      this._satoshisBN = BN.fromNumber(this._satoshis);\n    } else {\n      $.checkArgument(JSUtil.isNaturalNumber(num), 'Output satoshis is not a natural number');\n      this._satoshisBN = BN.fromNumber(num);\n      this._satoshis = num;\n    }\n\n    $.checkState(JSUtil.isNaturalNumber(this._satoshis), 'Output satoshis is not a natural number');\n  }\n});\n\nOutput.prototype.invalidSatoshis = function () {\n  if (this._satoshis > MAX_SAFE_INTEGER) {\n    return 'transaction txout satoshis greater than max safe integer';\n  }\n\n  if (this._satoshis !== this._satoshisBN.toNumber()) {\n    return 'transaction txout satoshis has corrupted value';\n  }\n\n  if (this._satoshis < 0) {\n    return 'transaction txout negative';\n  }\n\n  return false;\n};\n\nOutput.prototype.toObject = Output.prototype.toJSON = function toObject() {\n  var obj = {\n    satoshis: this.satoshis\n  };\n  obj.script = this._scriptBuffer.toString('hex');\n  return obj;\n};\n\nOutput.fromObject = function (data) {\n  return new Output(data);\n};\n\nOutput.prototype.setScriptFromBuffer = function (buffer) {\n  this._scriptBuffer = buffer;\n\n  try {\n    this._script = Script.fromBuffer(this._scriptBuffer);\n    this._script._isOutput = true;\n  } catch (e) {\n    if (e instanceof errors.Script.InvalidBuffer) {\n      this._script = null;\n    } else {\n      throw e;\n    }\n  }\n};\n\nOutput.prototype.setScript = function (script) {\n  if (script instanceof Script) {\n    this._scriptBuffer = script.toBuffer();\n    this._script = script;\n    this._script._isOutput = true;\n  } else if (_.isString(script)) {\n    this._script = Script.fromString(script);\n    this._scriptBuffer = this._script.toBuffer();\n    this._script._isOutput = true;\n  } else if (bufferUtil.isBuffer(script)) {\n    this.setScriptFromBuffer(script);\n  } else {\n    throw new TypeError('Invalid argument type: script');\n  }\n\n  return this;\n};\n\nOutput.prototype.inspect = function () {\n  var scriptStr;\n\n  if (this.script) {\n    scriptStr = this.script.inspect();\n  } else {\n    scriptStr = this._scriptBuffer.toString('hex');\n  }\n\n  return '<Output (' + this.satoshis + ' sats) ' + scriptStr + '>';\n};\n\nOutput.fromBufferReader = function (br) {\n  var obj = {};\n  obj.satoshis = br.readUInt64LEBN();\n  var size = br.readVarintNum();\n\n  if (size !== 0) {\n    obj.script = br.read(size);\n  } else {\n    obj.script = new buffer.Buffer([]);\n  }\n\n  return new Output(obj);\n};\n\nOutput.prototype.toBufferWriter = function (writer) {\n  if (!writer) {\n    writer = new BufferWriter();\n  }\n\n  writer.writeUInt64LEBN(this._satoshisBN);\n  var script = this._scriptBuffer;\n  writer.writeVarintNum(script.length);\n  writer.write(script);\n  return writer;\n};\n\nmodule.exports = Output;","map":{"version":3,"names":["_","require","BN","buffer","bufferUtil","JSUtil","BufferWriter","Script","$","errors","MAX_SAFE_INTEGER","Output","args","isObject","satoshis","isBuffer","script","_scriptBuffer","isString","isHexa","Buffer","setScript","TypeError","Object","defineProperty","prototype","configurable","enumerable","get","_script","setScriptFromBuffer","_satoshis","set","num","_satoshisBN","toNumber","parseInt","fromNumber","checkArgument","isNaturalNumber","checkState","invalidSatoshis","toObject","toJSON","obj","toString","fromObject","data","fromBuffer","_isOutput","e","InvalidBuffer","toBuffer","fromString","inspect","scriptStr","fromBufferReader","br","readUInt64LEBN","size","readVarintNum","read","toBufferWriter","writer","writeUInt64LEBN","writeVarintNum","length","write","module","exports"],"sources":["C:/Users/acer/node_modules/bitcore-lib-doge/lib/transaction/output.js"],"sourcesContent":["'use strict';\n\nvar _ = require('lodash');\nvar BN = require('../crypto/bn');\nvar buffer = require('buffer');\nvar bufferUtil = require('../util/buffer');\nvar JSUtil = require('../util/js');\nvar BufferWriter = require('../encoding/bufferwriter');\nvar Script = require('../script');\nvar $ = require('../util/preconditions');\nvar errors = require('../errors');\n\nvar MAX_SAFE_INTEGER = 0x1fffffffffffff;\n\nfunction Output(args) {\n  if (!(this instanceof Output)) {\n    return new Output(args);\n  }\n  if (_.isObject(args)) {\n    this.satoshis = args.satoshis;\n    if (bufferUtil.isBuffer(args.script)) {\n      this._scriptBuffer = args.script;\n    } else {\n      var script;\n      if (_.isString(args.script) && JSUtil.isHexa(args.script)) {\n        script = new buffer.Buffer(args.script, 'hex');\n      } else {\n        script = args.script;\n      }\n      this.setScript(script);\n    }\n  } else {\n    throw new TypeError('Unrecognized argument for Output');\n  }\n}\n\nObject.defineProperty(Output.prototype, 'script', {\n  configurable: false,\n  enumerable: true,\n  get: function() {\n    if (this._script) {\n      return this._script;\n    } else {\n      this.setScriptFromBuffer(this._scriptBuffer);\n      return this._script;\n    }\n\n  }\n});\n\nObject.defineProperty(Output.prototype, 'satoshis', {\n  configurable: false,\n  enumerable: true,\n  get: function() {\n    return this._satoshis;\n  },\n  set: function(num) {\n    if (num instanceof BN) {\n      this._satoshisBN = num;\n      this._satoshis = num.toNumber();\n    } else if (_.isString(num)) {\n      this._satoshis = parseInt(num);\n      this._satoshisBN = BN.fromNumber(this._satoshis);\n    } else {\n      $.checkArgument(\n        JSUtil.isNaturalNumber(num),\n        'Output satoshis is not a natural number'\n      );\n      this._satoshisBN = BN.fromNumber(num);\n      this._satoshis = num;\n    }\n    $.checkState(\n      JSUtil.isNaturalNumber(this._satoshis),\n      'Output satoshis is not a natural number'\n    );\n  }\n});\n\nOutput.prototype.invalidSatoshis = function() {\n  if (this._satoshis > MAX_SAFE_INTEGER) {\n    return 'transaction txout satoshis greater than max safe integer';\n  }\n  if (this._satoshis !== this._satoshisBN.toNumber()) {\n    return 'transaction txout satoshis has corrupted value';\n  }\n  if (this._satoshis < 0) {\n    return 'transaction txout negative';\n  }\n  return false;\n};\n\nOutput.prototype.toObject = Output.prototype.toJSON = function toObject() {\n  var obj = {\n    satoshis: this.satoshis\n  };\n  obj.script = this._scriptBuffer.toString('hex');\n  return obj;\n};\n\nOutput.fromObject = function(data) {\n  return new Output(data);\n};\n\nOutput.prototype.setScriptFromBuffer = function(buffer) {\n  this._scriptBuffer = buffer;\n  try {\n    this._script = Script.fromBuffer(this._scriptBuffer);\n    this._script._isOutput = true;\n  } catch(e) {\n    if (e instanceof errors.Script.InvalidBuffer) {\n      this._script = null;\n    } else {\n      throw e;\n    }\n  }\n};\n\nOutput.prototype.setScript = function(script) {\n  if (script instanceof Script) {\n    this._scriptBuffer = script.toBuffer();\n    this._script = script;\n    this._script._isOutput = true;\n  } else if (_.isString(script)) {\n    this._script = Script.fromString(script);\n    this._scriptBuffer = this._script.toBuffer();\n    this._script._isOutput = true;\n  } else if (bufferUtil.isBuffer(script)) {\n    this.setScriptFromBuffer(script);\n  } else {\n    throw new TypeError('Invalid argument type: script');\n  }\n  return this;\n};\n\nOutput.prototype.inspect = function() {\n  var scriptStr;\n  if (this.script) {\n    scriptStr = this.script.inspect();\n  } else {\n    scriptStr = this._scriptBuffer.toString('hex');\n  }\n  return '<Output (' + this.satoshis + ' sats) ' + scriptStr + '>';\n};\n\nOutput.fromBufferReader = function(br) {\n  var obj = {};\n  obj.satoshis = br.readUInt64LEBN();\n  var size = br.readVarintNum();\n  if (size !== 0) {\n    obj.script = br.read(size);\n  } else {\n    obj.script = new buffer.Buffer([]);\n  }\n  return new Output(obj);\n};\n\nOutput.prototype.toBufferWriter = function(writer) {\n  if (!writer) {\n    writer = new BufferWriter();\n  }\n  writer.writeUInt64LEBN(this._satoshisBN);\n  var script = this._scriptBuffer;\n  writer.writeVarintNum(script.length);\n  writer.write(script);\n  return writer;\n};\n\nmodule.exports = Output;\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}