{"ast":null,"code":"'use strict';\n\nconst Client = require('../../lib/core');\n\nconst toUrlSearchParams = require('../../lib/to-url-search-params');\n/**\n * @typedef {import('../../lib/core').ClientOptions} ClientOptions\n * @typedef {import('../..').HttpOptions} HttpOptions\n * @typedef {import('ipfs-core-types/src/basic').AbortOptions} AbortOptions\n * @typedef {import('ipfs-core-types/src/pin/remote/service').API} API\n * @typedef {import('ipfs-core-types/src/pin/remote/service').Credentials} Credentials\n * @typedef {import('ipfs-core-types/src/pin/remote/service').RemotePinService} RemotePinService\n * @typedef {import('ipfs-core-types/src/pin/remote/service').RemotePinServiceWithStat} RemotePinServiceWithStat\n * @implements {API}\n */\n\n\nclass Service {\n  /**\n   * @param {ClientOptions} options\n   */\n  constructor(options) {\n    /** @private */\n    this.client = new Client(options);\n  }\n  /**\n   * @param {Client} client\n   * @param {string} name\n   * @param {Credentials & AbortOptions & HttpOptions} options\n   */\n\n\n  static async add(client, name, options) {\n    const {\n      endpoint,\n      key,\n      headers,\n      timeout,\n      signal\n    } = options;\n    await client.post('pin/remote/service/add', {\n      timeout,\n      signal,\n      searchParams: toUrlSearchParams({\n        arg: [name, Service.encodeEndpoint(endpoint), key]\n      }),\n      headers\n    });\n  }\n  /**\n   * @param {URL} url\n   */\n\n\n  static encodeEndpoint(url) {\n    const href = String(url);\n\n    if (href === 'undefined') {\n      throw Error('endpoint is required');\n    } // Workaround trailing `/` issue in go-ipfs\n    // @see https://github.com/ipfs/go-ipfs/issues/7826\n\n\n    return href[href.length - 1] === '/' ? href.slice(0, -1) : href;\n  }\n  /**\n   * @param {Client} client\n   * @param {string} name\n   * @param {AbortOptions & HttpOptions} [options]\n   */\n\n\n  static async rm(client, name) {\n    let {\n      timeout,\n      signal,\n      headers\n    } = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    await client.post('pin/remote/service/rm', {\n      timeout,\n      signal,\n      headers,\n      searchParams: toUrlSearchParams({\n        arg: name\n      })\n    });\n  }\n  /**\n   * @template {true} Stat\n   * @param {Client} client\n   * @param {{ stat?: Stat } & AbortOptions & HttpOptions} [options]\n   */\n\n\n  static async ls(client) {\n    let {\n      stat,\n      timeout,\n      signal,\n      headers\n    } = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    const response = await client.post('pin/remote/service/ls', {\n      searchParams: stat === true ? toUrlSearchParams({\n        stat\n      }) : undefined,\n      timeout,\n      signal,\n      headers\n    });\n    /** @type {{RemoteServices: Object[]}} */\n\n    const {\n      RemoteServices\n    } = await response.json();\n    /** @type {Stat extends true ? RemotePinServiceWithStat[] : RemotePinService []} */\n\n    return RemoteServices.map(Service.decodeRemoteService);\n  }\n  /**\n   * @param {Object} json\n   * @returns {RemotePinServiceWithStat}\n   */\n\n\n  static decodeRemoteService(json) {\n    return {\n      service: json.Service,\n      endpoint: new URL(json.ApiEndpoint),\n      ...(json.Stat && {\n        stat: Service.decodeStat(json.Stat)\n      })\n    };\n  }\n  /**\n   * @param {Object} json\n   * @returns {import('ipfs-core-types/src/pin/remote/service').Stat}\n   */\n\n\n  static decodeStat(json) {\n    switch (json.Status) {\n      case 'valid':\n        {\n          const {\n            Pinning,\n            Pinned,\n            Queued,\n            Failed\n          } = json.PinCount;\n          return {\n            status: 'valid',\n            pinCount: {\n              queued: Queued,\n              pinning: Pinning,\n              pinned: Pinned,\n              failed: Failed\n            }\n          };\n        }\n\n      case 'invalid':\n        {\n          return {\n            status: 'invalid'\n          };\n        }\n\n      default:\n        {\n          return {\n            status: json.Status\n          };\n        }\n    }\n  }\n  /**\n   * Registers remote pinning service with a given name. Errors if service\n   * with the given name is already registered.\n   *\n   * @param {string} name\n   * @param {Credentials & AbortOptions & HttpOptions} options\n   */\n\n\n  add(name, options) {\n    return Service.add(this.client, name, options);\n  }\n  /**\n   * Unregisteres remote pinning service with a given name. If service with such\n   * name isn't registerede this is a noop.\n   *\n   * @param {string} name\n   * @param {AbortOptions & HttpOptions} [options]\n   */\n\n\n  rm(name, options) {\n    return Service.rm(this.client, name, options);\n  }\n  /**\n   * List registered remote pinning services.\n   *\n   * @param {{ stat?: true } & AbortOptions & HttpOptions} [options]\n   */\n\n\n  ls(options) {\n    return Service.ls(this.client, options);\n  }\n\n}\n\nmodule.exports = Service;","map":{"version":3,"names":["Client","require","toUrlSearchParams","Service","constructor","options","client","add","name","endpoint","key","headers","timeout","signal","post","searchParams","arg","encodeEndpoint","url","href","String","Error","length","slice","rm","ls","stat","response","undefined","RemoteServices","json","map","decodeRemoteService","service","URL","ApiEndpoint","Stat","decodeStat","Status","Pinning","Pinned","Queued","Failed","PinCount","status","pinCount","queued","pinning","pinned","failed","module","exports"],"sources":["C:/Users/acer/node_modules/ipfs-http-client/src/pin/remote/service.js"],"sourcesContent":["'use strict'\n\nconst Client = require('../../lib/core')\nconst toUrlSearchParams = require('../../lib/to-url-search-params')\n\n/**\n * @typedef {import('../../lib/core').ClientOptions} ClientOptions\n * @typedef {import('../..').HttpOptions} HttpOptions\n * @typedef {import('ipfs-core-types/src/basic').AbortOptions} AbortOptions\n * @typedef {import('ipfs-core-types/src/pin/remote/service').API} API\n * @typedef {import('ipfs-core-types/src/pin/remote/service').Credentials} Credentials\n * @typedef {import('ipfs-core-types/src/pin/remote/service').RemotePinService} RemotePinService\n * @typedef {import('ipfs-core-types/src/pin/remote/service').RemotePinServiceWithStat} RemotePinServiceWithStat\n * @implements {API}\n */\nclass Service {\n  /**\n   * @param {ClientOptions} options\n   */\n  constructor (options) {\n    /** @private */\n    this.client = new Client(options)\n  }\n\n  /**\n   * @param {Client} client\n   * @param {string} name\n   * @param {Credentials & AbortOptions & HttpOptions} options\n   */\n  static async add (client, name, options) {\n    const { endpoint, key, headers, timeout, signal } = options\n    await client.post('pin/remote/service/add', {\n      timeout,\n      signal,\n      searchParams: toUrlSearchParams({\n        arg: [name, Service.encodeEndpoint(endpoint), key]\n      }),\n      headers\n    })\n  }\n\n  /**\n   * @param {URL} url\n   */\n  static encodeEndpoint (url) {\n    const href = String(url)\n    if (href === 'undefined') {\n      throw Error('endpoint is required')\n    }\n    // Workaround trailing `/` issue in go-ipfs\n    // @see https://github.com/ipfs/go-ipfs/issues/7826\n    return href[href.length - 1] === '/' ? href.slice(0, -1) : href\n  }\n\n  /**\n   * @param {Client} client\n   * @param {string} name\n   * @param {AbortOptions & HttpOptions} [options]\n   */\n  static async rm (client, name, { timeout, signal, headers } = {}) {\n    await client.post('pin/remote/service/rm', {\n      timeout,\n      signal,\n      headers,\n      searchParams: toUrlSearchParams({\n        arg: name\n      })\n    })\n  }\n\n  /**\n   * @template {true} Stat\n   * @param {Client} client\n   * @param {{ stat?: Stat } & AbortOptions & HttpOptions} [options]\n   */\n  static async ls (client, { stat, timeout, signal, headers } = {}) {\n    const response = await client.post('pin/remote/service/ls', {\n      searchParams: stat === true ? toUrlSearchParams({ stat }) : undefined,\n      timeout,\n      signal,\n      headers\n    })\n\n    /** @type {{RemoteServices: Object[]}} */\n    const { RemoteServices } = await response.json()\n\n    /** @type {Stat extends true ? RemotePinServiceWithStat[] : RemotePinService []} */\n    return (RemoteServices.map(Service.decodeRemoteService))\n  }\n\n  /**\n   * @param {Object} json\n   * @returns {RemotePinServiceWithStat}\n   */\n  static decodeRemoteService (json) {\n    return {\n      service: json.Service,\n      endpoint: new URL(json.ApiEndpoint),\n      ...(json.Stat && { stat: Service.decodeStat(json.Stat) })\n    }\n  }\n\n  /**\n   * @param {Object} json\n   * @returns {import('ipfs-core-types/src/pin/remote/service').Stat}\n   */\n  static decodeStat (json) {\n    switch (json.Status) {\n      case 'valid': {\n        const { Pinning, Pinned, Queued, Failed } = json.PinCount\n        return {\n          status: 'valid',\n          pinCount: {\n            queued: Queued,\n            pinning: Pinning,\n            pinned: Pinned,\n            failed: Failed\n          }\n        }\n      }\n      case 'invalid': {\n        return { status: 'invalid' }\n      }\n      default: {\n        return { status: json.Status }\n      }\n    }\n  }\n\n  /**\n   * Registers remote pinning service with a given name. Errors if service\n   * with the given name is already registered.\n   *\n   * @param {string} name\n   * @param {Credentials & AbortOptions & HttpOptions} options\n   */\n  add (name, options) {\n    return Service.add(this.client, name, options)\n  }\n\n  /**\n   * Unregisteres remote pinning service with a given name. If service with such\n   * name isn't registerede this is a noop.\n   *\n   * @param {string} name\n   * @param {AbortOptions & HttpOptions} [options]\n   */\n  rm (name, options) {\n    return Service.rm(this.client, name, options)\n  }\n\n  /**\n   * List registered remote pinning services.\n   *\n   * @param {{ stat?: true } & AbortOptions & HttpOptions} [options]\n   */\n  ls (options) {\n    return Service.ls(this.client, options)\n  }\n}\n\nmodule.exports = Service\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}