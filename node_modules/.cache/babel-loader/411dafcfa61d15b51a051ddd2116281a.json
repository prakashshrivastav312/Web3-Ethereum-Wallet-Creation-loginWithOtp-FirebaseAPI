{"ast":null,"code":"\"use strict\";\n\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Mint721BuiltInPrivateKeyValidator = void 0;\n\nconst class_validator_1 = require(\"class-validator\");\n\nconst request_1 = require(\"../request\");\n\nconst SignatureIdValidator_1 = require(\"./SignatureIdValidator\");\n\nlet Mint721BuiltInPrivateKeyValidator = class Mint721BuiltInPrivateKeyValidator {\n  constructor() {\n    this.message = null;\n  }\n\n  defaultMessage(validationArguments) {\n    if (this.message) {\n      return this.message;\n    }\n\n    return 'If you fill signatureId or privateKey/secret/fromPrivateKey, then tokenId, contractAddress must be present.';\n  }\n\n  validate(value, validationArguments) {\n    const data = validationArguments === null || validationArguments === void 0 ? void 0 : validationArguments.object;\n    const chains = [request_1.Currency.BSC, request_1.Currency.ETH, request_1.Currency.CELO, request_1.Currency.ONE, request_1.Currency.MATIC, request_1.Currency.KLAY, request_1.Currency.ALGO, request_1.Currency.SOL];\n    const isAllowedChain = chains.includes(data.chain);\n\n    if (data.minter) {\n      if (data.fromPrivateKey || data.signatureId) {\n        this.message = `If minter is present, no private key or signatureId must be entered. Minter is available only on these chains - ${chains}`;\n        return false;\n      }\n\n      if (!this.validateRequiredFields(data)) {\n        return false;\n      }\n    }\n\n    if (!data.fromPrivateKey && !data.signatureId) {\n      if (isAllowedChain) {\n        return true;\n      } else {\n        if (!this.validateNonBuiltInPrivateKey(data, validationArguments)) {\n          return false;\n        }\n      }\n    } else {\n      if (!this.validateNonBuiltInPrivateKey(data, validationArguments)) {\n        return false;\n      }\n    }\n\n    return true;\n  }\n\n  validateNonBuiltInPrivateKey(data, validationArguments) {\n    if (!this.validateRequiredFields(data)) {\n      return false;\n    }\n\n    if (!data.fromPrivateKey && !data.signatureId) {\n      this.message = 'Field fromPrivateKey or signatureId must be filled.';\n      return false;\n    }\n\n    const signatureIdValidation = new SignatureIdValidator_1.SignatureIdValidator();\n    return signatureIdValidation.validate(data, validationArguments);\n  }\n\n  validateRequiredFields(data) {\n    if (data.chain === request_1.Currency.SOL) {\n      return true;\n    }\n\n    if (data.chain === request_1.Currency.CELO && (!data.feeCurrency || ![request_1.Currency.CELO, request_1.Currency.CUSD, request_1.Currency.CEUR].includes(data.feeCurrency))) {\n      this.message = 'CELO chain must have assigned feeCurrency field.';\n      return false;\n    }\n\n    if (!data.tokenId && data.chain !== request_1.Currency.ALGO) {\n      this.message = 'Field tokenId must be present.';\n      return false;\n    }\n\n    if (!data.contractAddress && data.chain !== request_1.Currency.ALGO) {\n      this.message = 'Field contractAddress must be present.';\n      return false;\n    }\n\n    return true;\n  }\n\n};\nMint721BuiltInPrivateKeyValidator = __decorate([class_validator_1.ValidatorConstraint({\n  name: 'builtInPrivateKey',\n  async: false\n})], Mint721BuiltInPrivateKeyValidator);\nexports.Mint721BuiltInPrivateKeyValidator = Mint721BuiltInPrivateKeyValidator;","map":{"version":3,"mappings":"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","names":["Mint721BuiltInPrivateKeyValidator","constructor","defaultMessage","validationArguments","message","validate","value","data","object","chains","request_1","BSC","ETH","CELO","ONE","MATIC","KLAY","ALGO","SOL","isAllowedChain","includes","chain","minter","fromPrivateKey","signatureId","validateRequiredFields","validateNonBuiltInPrivateKey","signatureIdValidation","SignatureIdValidator_1","feeCurrency","CUSD","CEUR","tokenId","contractAddress","class_validator_1","name","async","exports"],"sourceRoot":"","sources":["../../../../src/model/validation/Mint721BuiltInPrivateKeyValidator.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}