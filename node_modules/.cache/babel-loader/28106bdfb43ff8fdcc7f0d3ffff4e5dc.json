{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.TradeAggregationCallBuilder = void 0;\n\nvar tslib_1 = require(\"tslib\");\n\nvar call_builder_1 = require(\"./call_builder\");\n\nvar errors_1 = require(\"./errors\");\n\nvar allowedResolutions = [60000, 300000, 900000, 3600000, 86400000, 604800000];\n\nvar TradeAggregationCallBuilder = function (_super) {\n  tslib_1.__extends(TradeAggregationCallBuilder, _super);\n\n  function TradeAggregationCallBuilder(serverUrl, base, counter, start_time, end_time, resolution, offset) {\n    var _this = _super.call(this, serverUrl) || this;\n\n    _this.url.segment(\"trade_aggregations\");\n\n    if (!base.isNative()) {\n      _this.url.setQuery(\"base_asset_type\", base.getAssetType());\n\n      _this.url.setQuery(\"base_asset_code\", base.getCode());\n\n      _this.url.setQuery(\"base_asset_issuer\", base.getIssuer());\n    } else {\n      _this.url.setQuery(\"base_asset_type\", \"native\");\n    }\n\n    if (!counter.isNative()) {\n      _this.url.setQuery(\"counter_asset_type\", counter.getAssetType());\n\n      _this.url.setQuery(\"counter_asset_code\", counter.getCode());\n\n      _this.url.setQuery(\"counter_asset_issuer\", counter.getIssuer());\n    } else {\n      _this.url.setQuery(\"counter_asset_type\", \"native\");\n    }\n\n    if (typeof start_time !== \"number\" || typeof end_time !== \"number\") {\n      throw new errors_1.BadRequestError(\"Invalid time bounds\", [start_time, end_time]);\n    } else {\n      _this.url.setQuery(\"start_time\", start_time.toString());\n\n      _this.url.setQuery(\"end_time\", end_time.toString());\n    }\n\n    if (!_this.isValidResolution(resolution)) {\n      throw new errors_1.BadRequestError(\"Invalid resolution\", resolution);\n    } else {\n      _this.url.setQuery(\"resolution\", resolution.toString());\n    }\n\n    if (!_this.isValidOffset(offset, resolution)) {\n      throw new errors_1.BadRequestError(\"Invalid offset\", offset);\n    } else {\n      _this.url.setQuery(\"offset\", offset.toString());\n    }\n\n    return _this;\n  }\n\n  TradeAggregationCallBuilder.prototype.isValidResolution = function (resolution) {\n    for (var _i = 0, allowedResolutions_1 = allowedResolutions; _i < allowedResolutions_1.length; _i++) {\n      var allowed = allowedResolutions_1[_i];\n\n      if (allowed === resolution) {\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  TradeAggregationCallBuilder.prototype.isValidOffset = function (offset, resolution) {\n    var hour = 3600000;\n    return !(offset > resolution || offset >= 24 * hour || offset % hour !== 0);\n  };\n\n  return TradeAggregationCallBuilder;\n}(call_builder_1.CallBuilder);\n\nexports.TradeAggregationCallBuilder = TradeAggregationCallBuilder;","map":{"version":3,"mappings":"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","names":["allowedResolutions","tslib_1","serverUrl","base","counter","start_time","end_time","resolution","offset","_super","_this","url","segment","isNative","setQuery","getAssetType","getCode","getIssuer","errors_1","toString","isValidResolution","isValidOffset","TradeAggregationCallBuilder","_i","allowed","hour","call_builder_1","exports"],"sourceRoot":"","sources":["../src/trade_aggregation_call_builder.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}