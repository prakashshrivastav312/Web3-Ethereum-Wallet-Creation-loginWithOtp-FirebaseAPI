{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.ExponentialBackoff = void 0;\n\nclass ExponentialBackoff {\n  constructor() {\n    let opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    this.factor = 2;\n    this.jitter = 0;\n    this.attempts = 0;\n    this.ms = opts.min || 100;\n    this.max = opts.max || 10000;\n  }\n\n  duration() {\n    var ms = this.ms * Math.pow(this.factor, this.attempts++);\n\n    if (this.jitter) {\n      var rand = Math.random();\n      var deviation = Math.floor(rand * this.jitter * ms);\n      ms = (Math.floor(rand * 10) & 1) == 0 ? ms - deviation : ms + deviation;\n    }\n\n    return Math.min(ms, this.max) | 0;\n  }\n\n  reset() {\n    this.attempts = 0;\n  }\n\n}\n\nexports.ExponentialBackoff = ExponentialBackoff;","map":{"version":3,"mappings":";;;;;;;AAYA,MAAaA,kBAAb,CAA+B;EAO7BC,cAAmD;IAAA,IAAvCC,IAAuC,uEAAF,EAAE;IAJlC,cAAiB,CAAjB;IACA,cAAiB,CAAjB;IACjB,gBAAmB,CAAnB;IAGE,KAAKC,EAAL,GAAUD,IAAI,CAACE,GAAL,IAAY,GAAtB;IACA,KAAKC,GAAL,GAAWH,IAAI,CAACG,GAAL,IAAY,KAAvB;EACD;;EAKDC,QAAQ;IACN,IAAIH,EAAE,GAAG,KAAKA,EAAL,GAAUI,IAAI,CAACC,GAAL,CAAS,KAAKC,MAAd,EAAsB,KAAKC,QAAL,EAAtB,CAAnB;;IACA,IAAI,KAAKC,MAAT,EAAiB;MACf,IAAIC,IAAI,GAAGL,IAAI,CAACM,MAAL,EAAX;MACA,IAAIC,SAAS,GAAGP,IAAI,CAACQ,KAAL,CAAWH,IAAI,GAAG,KAAKD,MAAZ,GAAqBR,EAAhC,CAAhB;MACAA,EAAE,GAAG,CAACI,IAAI,CAACQ,KAAL,CAAWH,IAAI,GAAG,EAAlB,IAAwB,CAAzB,KAA+B,CAA/B,GAAmCT,EAAE,GAAGW,SAAxC,GAAoDX,EAAE,GAAGW,SAA9D;IACD;;IACD,OAAOP,IAAI,CAACH,GAAL,CAASD,EAAT,EAAa,KAAKE,GAAlB,IAAyB,CAAhC;EACD;;EAKDW,KAAK;IACH,KAAKN,QAAL,GAAgB,CAAhB;EACD;;AA9B4B;;AAA/BO","names":["ExponentialBackoff","constructor","opts","ms","min","max","duration","Math","pow","factor","attempts","jitter","rand","random","deviation","floor","reset","exports"],"sourceRoot":"","sources":["../../../src/common/backoff.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}