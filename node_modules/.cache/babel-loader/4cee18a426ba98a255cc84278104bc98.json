{"ast":null,"code":"'use strict';\n\nvar _ = require('lodash');\n\nvar URL = require('url');\n\nvar Address = require('./address');\n\nvar Unit = require('./unit');\n/**\n * Bitcore URI\n *\n * Instantiate an URI from a bitcoin URI String or an Object. An URI instance\n * can be created with a bitcoin uri string or an object. All instances of\n * URI are valid, the static method isValid allows checking before instantiation.\n *\n * All standard parameters can be found as members of the class, the address\n * is represented using an {Address} instance and the amount is represented in\n * satoshis. Any other non-standard parameters can be found under the extra member.\n *\n * @example\n * ```javascript\n *\n * var uri = new URI('bitcoin:12A1MyfXbW6RhdRAZEqofac5jCQQjwEPBu?amount=1.2');\n * console.log(uri.address, uri.amount);\n * ```\n *\n * @param {string|Object} data - A bitcoin URI string or an Object\n * @param {Array.<string>=} knownParams - Required non-standard params\n * @throws {TypeError} Invalid bitcoin address\n * @throws {TypeError} Invalid amount\n * @throws {Error} Unknown required argument\n * @returns {URI} A new valid and frozen instance of URI\n * @constructor\n */\n\n\nvar URI = function (data, knownParams) {\n  if (!(this instanceof URI)) {\n    return new URI(data, knownParams);\n  }\n\n  this.extras = {};\n  this.knownParams = knownParams || [];\n  this.address = this.network = this.amount = this.message = null;\n\n  if (typeof data === 'string') {\n    var params = URI.parse(data);\n\n    if (params.amount) {\n      params.amount = this._parseAmount(params.amount);\n    }\n\n    this._fromObject(params);\n  } else if (typeof data === 'object') {\n    this._fromObject(data);\n  } else {\n    throw new TypeError('Unrecognized data format.');\n  }\n};\n/**\n * Instantiate a URI from a String\n *\n * @param {string} str - JSON string or object of the URI\n * @returns {URI} A new instance of a URI\n */\n\n\nURI.fromString = function fromString(str) {\n  if (typeof str !== 'string') {\n    throw new TypeError('Expected a string');\n  }\n\n  return new URI(str);\n};\n/**\n * Instantiate a URI from an Object\n *\n * @param {Object} data - object of the URI\n * @returns {URI} A new instance of a URI\n */\n\n\nURI.fromObject = function fromObject(json) {\n  return new URI(json);\n};\n/**\n * Check if an bitcoin URI string is valid\n *\n * @example\n * ```javascript\n *\n * var valid = URI.isValid('bitcoin:12A1MyfXbW6RhdRAZEqofac5jCQQjwEPBu');\n * // true\n * ```\n *\n * @param {string|Object} data - A bitcoin URI string or an Object\n * @param {Array.<string>=} knownParams - Required non-standard params\n * @returns {boolean} Result of uri validation\n */\n\n\nURI.isValid = function (arg, knownParams) {\n  try {\n    new URI(arg, knownParams);\n  } catch (err) {\n    return false;\n  }\n\n  return true;\n};\n/**\n * Convert a bitcoin URI string into a simple object.\n *\n * @param {string} uri - A bitcoin URI string\n * @throws {TypeError} Invalid bitcoin URI\n * @returns {Object} An object with the parsed params\n */\n\n\nURI.parse = function (uri) {\n  var info = URL.parse(uri, true);\n\n  if (info.protocol !== 'bitcoin:') {\n    throw new TypeError('Invalid bitcoin URI');\n  } // workaround to host insensitiveness\n\n\n  var group = /[^:]*:\\/?\\/?([^?]*)/.exec(uri);\n  info.query.address = group && group[1] || undefined;\n  return info.query;\n};\n\nURI.Members = ['address', 'amount', 'message', 'label', 'r'];\n/**\n * Internal function to load the URI instance with an object.\n *\n * @param {Object} obj - Object with the information\n * @throws {TypeError} Invalid bitcoin address\n * @throws {TypeError} Invalid amount\n * @throws {Error} Unknown required argument\n */\n\nURI.prototype._fromObject = function (obj) {\n  /* jshint maxcomplexity: 10 */\n  if (!Address.isValid(obj.address)) {\n    throw new TypeError('Invalid bitcoin address');\n  }\n\n  this.address = new Address(obj.address);\n  this.network = this.address.network;\n  this.amount = obj.amount;\n\n  for (var key in obj) {\n    if (key === 'address' || key === 'amount') {\n      continue;\n    }\n\n    if (/^req-/.exec(key) && this.knownParams.indexOf(key) === -1) {\n      throw Error('Unknown required argument ' + key);\n    }\n\n    var destination = URI.Members.indexOf(key) > -1 ? this : this.extras;\n    destination[key] = obj[key];\n  }\n};\n/**\n * Internal function to transform a BTC string amount into satoshis\n *\n * @param {string} amount - Amount BTC string\n * @throws {TypeError} Invalid amount\n * @returns {Object} Amount represented in satoshis\n */\n\n\nURI.prototype._parseAmount = function (amount) {\n  amount = Number(amount);\n\n  if (isNaN(amount)) {\n    throw new TypeError('Invalid amount');\n  }\n\n  return Unit.fromBTC(amount).toSatoshis();\n};\n\nURI.prototype.toObject = URI.prototype.toJSON = function toObject() {\n  var json = {};\n\n  for (var i = 0; i < URI.Members.length; i++) {\n    var m = URI.Members[i];\n\n    if (this.hasOwnProperty(m) && typeof this[m] !== 'undefined') {\n      json[m] = this[m].toString();\n    }\n  }\n\n  _.extend(json, this.extras);\n\n  return json;\n};\n/**\n * Will return a the string representation of the URI\n *\n * @returns {string} Bitcoin URI string\n */\n\n\nURI.prototype.toString = function () {\n  var query = {};\n\n  if (this.amount) {\n    query.amount = Unit.fromSatoshis(this.amount).toBTC();\n  }\n\n  if (this.message) {\n    query.message = this.message;\n  }\n\n  if (this.label) {\n    query.label = this.label;\n  }\n\n  if (this.r) {\n    query.r = this.r;\n  }\n\n  _.extend(query, this.extras);\n\n  return URL.format({\n    protocol: 'bitcoin:',\n    host: this.address,\n    query: query\n  });\n};\n/**\n * Will return a string formatted for the console\n *\n * @returns {string} Bitcoin URI\n */\n\n\nURI.prototype.inspect = function () {\n  return '<URI: ' + this.toString() + '>';\n};\n\nmodule.exports = URI;","map":{"version":3,"names":["_","require","URL","Address","Unit","URI","data","knownParams","extras","address","network","amount","message","params","parse","_parseAmount","_fromObject","TypeError","fromString","str","fromObject","json","isValid","arg","err","uri","info","protocol","group","exec","query","undefined","Members","prototype","obj","key","indexOf","Error","destination","Number","isNaN","fromBTC","toSatoshis","toObject","toJSON","i","length","m","hasOwnProperty","toString","extend","fromSatoshis","toBTC","label","r","format","host","inspect","module","exports"],"sources":["C:/Users/acer/node_modules/bitcore-lib/lib/uri.js"],"sourcesContent":["'use strict';\n\nvar _ = require('lodash');\nvar URL = require('url');\n\nvar Address = require('./address');\nvar Unit = require('./unit');\n\n/**\n * Bitcore URI\n *\n * Instantiate an URI from a bitcoin URI String or an Object. An URI instance\n * can be created with a bitcoin uri string or an object. All instances of\n * URI are valid, the static method isValid allows checking before instantiation.\n *\n * All standard parameters can be found as members of the class, the address\n * is represented using an {Address} instance and the amount is represented in\n * satoshis. Any other non-standard parameters can be found under the extra member.\n *\n * @example\n * ```javascript\n *\n * var uri = new URI('bitcoin:12A1MyfXbW6RhdRAZEqofac5jCQQjwEPBu?amount=1.2');\n * console.log(uri.address, uri.amount);\n * ```\n *\n * @param {string|Object} data - A bitcoin URI string or an Object\n * @param {Array.<string>=} knownParams - Required non-standard params\n * @throws {TypeError} Invalid bitcoin address\n * @throws {TypeError} Invalid amount\n * @throws {Error} Unknown required argument\n * @returns {URI} A new valid and frozen instance of URI\n * @constructor\n */\nvar URI = function(data, knownParams) {\n  if (!(this instanceof URI)) {\n    return new URI(data, knownParams);\n  }\n\n  this.extras = {};\n  this.knownParams = knownParams || [];\n  this.address = this.network = this.amount = this.message = null;\n\n  if (typeof(data) === 'string') {\n    var params = URI.parse(data);\n    if (params.amount) {\n      params.amount = this._parseAmount(params.amount);\n    }\n    this._fromObject(params);\n  } else if (typeof(data) === 'object') {\n    this._fromObject(data);\n  } else {\n    throw new TypeError('Unrecognized data format.');\n  }\n};\n\n/**\n * Instantiate a URI from a String\n *\n * @param {string} str - JSON string or object of the URI\n * @returns {URI} A new instance of a URI\n */\nURI.fromString = function fromString(str) {\n  if (typeof(str) !== 'string') {\n    throw new TypeError('Expected a string');\n  }\n  return new URI(str);\n};\n\n/**\n * Instantiate a URI from an Object\n *\n * @param {Object} data - object of the URI\n * @returns {URI} A new instance of a URI\n */\nURI.fromObject = function fromObject(json) {\n  return new URI(json);\n};\n\n/**\n * Check if an bitcoin URI string is valid\n *\n * @example\n * ```javascript\n *\n * var valid = URI.isValid('bitcoin:12A1MyfXbW6RhdRAZEqofac5jCQQjwEPBu');\n * // true\n * ```\n *\n * @param {string|Object} data - A bitcoin URI string or an Object\n * @param {Array.<string>=} knownParams - Required non-standard params\n * @returns {boolean} Result of uri validation\n */\nURI.isValid = function(arg, knownParams) {\n  try {\n    new URI(arg, knownParams);\n  } catch (err) {\n    return false;\n  }\n  return true;\n};\n\n/**\n * Convert a bitcoin URI string into a simple object.\n *\n * @param {string} uri - A bitcoin URI string\n * @throws {TypeError} Invalid bitcoin URI\n * @returns {Object} An object with the parsed params\n */\nURI.parse = function(uri) {\n  var info = URL.parse(uri, true);\n\n  if (info.protocol !== 'bitcoin:') {\n    throw new TypeError('Invalid bitcoin URI');\n  }\n\n  // workaround to host insensitiveness\n  var group = /[^:]*:\\/?\\/?([^?]*)/.exec(uri);\n  info.query.address = group && group[1] || undefined;\n\n  return info.query;\n};\n\nURI.Members = ['address', 'amount', 'message', 'label', 'r'];\n\n/**\n * Internal function to load the URI instance with an object.\n *\n * @param {Object} obj - Object with the information\n * @throws {TypeError} Invalid bitcoin address\n * @throws {TypeError} Invalid amount\n * @throws {Error} Unknown required argument\n */\nURI.prototype._fromObject = function(obj) {\n  /* jshint maxcomplexity: 10 */\n\n  if (!Address.isValid(obj.address)) {\n    throw new TypeError('Invalid bitcoin address');\n  }\n\n  this.address = new Address(obj.address);\n  this.network = this.address.network;\n  this.amount = obj.amount;\n\n  for (var key in obj) {\n    if (key === 'address' || key === 'amount') {\n      continue;\n    }\n\n    if (/^req-/.exec(key) && this.knownParams.indexOf(key) === -1) {\n      throw Error('Unknown required argument ' + key);\n    }\n\n    var destination = URI.Members.indexOf(key) > -1 ? this : this.extras;\n    destination[key] = obj[key];\n  }\n};\n\n/**\n * Internal function to transform a BTC string amount into satoshis\n *\n * @param {string} amount - Amount BTC string\n * @throws {TypeError} Invalid amount\n * @returns {Object} Amount represented in satoshis\n */\nURI.prototype._parseAmount = function(amount) {\n  amount = Number(amount);\n  if (isNaN(amount)) {\n    throw new TypeError('Invalid amount');\n  }\n  return Unit.fromBTC(amount).toSatoshis();\n};\n\nURI.prototype.toObject = URI.prototype.toJSON = function toObject() {\n  var json = {};\n  for (var i = 0; i < URI.Members.length; i++) {\n    var m = URI.Members[i];\n    if (this.hasOwnProperty(m) && typeof(this[m]) !== 'undefined') {\n      json[m] = this[m].toString();\n    }\n  }\n  _.extend(json, this.extras);\n  return json;\n};\n\n/**\n * Will return a the string representation of the URI\n *\n * @returns {string} Bitcoin URI string\n */\nURI.prototype.toString = function() {\n  var query = {};\n  if (this.amount) {\n    query.amount = Unit.fromSatoshis(this.amount).toBTC();\n  }\n  if (this.message) {\n    query.message = this.message;\n  }\n  if (this.label) {\n    query.label = this.label;\n  }\n  if (this.r) {\n    query.r = this.r;\n  }\n  _.extend(query, this.extras);\n\n  return URL.format({\n    protocol: 'bitcoin:',\n    host: this.address,\n    query: query\n  });\n};\n\n/**\n * Will return a string formatted for the console\n *\n * @returns {string} Bitcoin URI\n */\nURI.prototype.inspect = function() {\n  return '<URI: ' + this.toString() + '>';\n};\n\nmodule.exports = URI;\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}