{"ast":null,"code":"'use strict';\n\nvar _ = require('lodash');\n\nvar BlockHeader = require('./blockheader');\n\nvar BN = require('../crypto/bn');\n\nvar BufferUtil = require('../util/buffer');\n\nvar BufferReader = require('../encoding/bufferreader');\n\nvar BufferWriter = require('../encoding/bufferwriter');\n\nvar Hash = require('../crypto/hash');\n\nvar Transaction = require('../transaction');\n\nvar $ = require('../util/preconditions');\n\nconst Networks = require('../networks');\n/**\n * Instantiate a Block from a Buffer, JSON object, or Object with\n * the properties of the Block\n *\n * @param {*} - A Buffer, JSON string, or Object\n * @returns {Block}\n * @constructor\n */\n\n\nfunction Block(arg) {\n  if (!(this instanceof Block)) {\n    return new Block(arg);\n  }\n\n  _.extend(this, Block._from(arg));\n\n  return this;\n} // https://github.com/bitcoin/bitcoin/blob/b5fa132329f0377d787a4a21c1686609c2bfaece/src/primitives/block.h#L14\n\n\nBlock.MAX_BLOCK_SIZE = 1000000;\n/**\n * @param {*} - A Buffer, JSON string or Object\n * @returns {Object} - An object representing block data\n * @throws {TypeError} - If the argument was not recognized\n * @private\n */\n\nBlock._from = function _from(arg) {\n  var info = {};\n\n  if (BufferUtil.isBuffer(arg)) {\n    info = Block._fromBufferReader(BufferReader(arg));\n  } else if (_.isObject(arg)) {\n    info = Block._fromObject(arg);\n  } else {\n    throw new TypeError('Unrecognized argument for Block');\n  }\n\n  return info;\n};\n/**\n * @param {Object} - A plain JavaScript object\n * @returns {Object} - An object representing block data\n * @private\n */\n\n\nBlock._fromObject = function _fromObject(data) {\n  var transactions = [];\n  data.transactions.forEach(function (tx) {\n    if (tx instanceof Transaction) {\n      transactions.push(tx);\n    } else {\n      transactions.push(Transaction().fromObject(tx));\n    }\n  });\n  var info = {\n    header: BlockHeader.fromObject(data.header),\n    transactions: transactions\n  };\n  return info;\n};\n/**\n * @param {Object} - A plain JavaScript object\n * @returns {Block} - An instance of block\n */\n\n\nBlock.fromObject = function fromObject(obj) {\n  var info = Block._fromObject(obj);\n\n  return new Block(info);\n};\n/**\n * @param {BufferReader} - Block data\n * @returns {Object} - An object representing the block data\n * @private\n */\n\n\nBlock._fromBufferReader = function _fromBufferReader(br) {\n  var info = {};\n  $.checkState(!br.finished(), 'No block data received');\n  info.header = BlockHeader.fromBufferReader(br);\n  var transactions = br.readVarintNum();\n  info.transactions = [];\n\n  for (var i = 0; i < transactions; i++) {\n    info.transactions.push(Transaction().fromBufferReader(br));\n  }\n\n  return info;\n};\n/**\n * @param {BufferReader} - A buffer reader of the block\n * @returns {Block} - An instance of block\n */\n\n\nBlock.fromBufferReader = function fromBufferReader(br) {\n  $.checkArgument(br, 'br is required');\n\n  var info = Block._fromBufferReader(br);\n\n  return new Block(info);\n};\n/**\n * @param {Buffer} - A buffer of the block\n * @returns {Block} - An instance of block\n */\n\n\nBlock.fromBuffer = function fromBuffer(buf) {\n  return Block.fromBufferReader(new BufferReader(buf));\n};\n/**\n * @param {string} - str - A hex encoded string of the block\n * @returns {Block} - A hex encoded string of the block\n */\n\n\nBlock.fromString = function fromString(str) {\n  var buf = Buffer.from(str, 'hex');\n  return Block.fromBuffer(buf);\n};\n/**\n * Method to decode blocks read directly from the .dat block files\n * @param {Binary} - Raw block binary data or buffer\n * @param {Boolean} - (optional. Default = false) Verify block decoding\n * @returns {Block} - An instance of block\n */\n\n\nBlock.fromRawBlock = function fromRawBlock(data) {\n  let verify = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n\n  if (!BufferUtil.isBuffer(data)) {\n    data = Buffer.from(data, 'binary');\n  }\n\n  const br = BufferReader(data);\n  let magic, size;\n\n  if (!verify) {\n    br.pos = Block.Values.START_OF_BLOCK;\n  } else {\n    magic = br.readUInt32BE();\n    size = br.readUInt32LE();\n    $.checkState(Networks.get(magic), 'Invalid network');\n  }\n\n  const info = Block._fromBufferReader(br);\n\n  const block = new Block(info);\n  $.checkState(!verify || block.toBuffer().length === size, 'Decoding of block failed. Expected block size of ' + size);\n  return block;\n};\n/**\n * @returns {Object} - A plain object with the block properties\n */\n\n\nBlock.prototype.toObject = Block.prototype.toJSON = function toObject() {\n  var transactions = [];\n  this.transactions.forEach(function (tx) {\n    transactions.push(tx.toObject());\n  });\n  return {\n    header: this.header.toObject(),\n    transactions: transactions\n  };\n};\n/**\n * @returns {Buffer} - A buffer of the block\n */\n\n\nBlock.prototype.toBuffer = function toBuffer() {\n  return this.toBufferWriter().concat();\n};\n/**\n * @returns {string} - A hex encoded string of the block\n */\n\n\nBlock.prototype.toString = function toString() {\n  return this.toBuffer().toString('hex');\n};\n/**\n * @param {BufferWriter} - An existing instance of BufferWriter\n * @returns {BufferWriter} - An instance of BufferWriter representation of the Block\n */\n\n\nBlock.prototype.toBufferWriter = function toBufferWriter(bw) {\n  if (!bw) {\n    bw = new BufferWriter();\n  }\n\n  bw.write(this.header.toBuffer());\n  bw.writeVarintNum(this.transactions.length);\n\n  for (var i = 0; i < this.transactions.length; i++) {\n    this.transactions[i].toBufferWriter(bw);\n  }\n\n  return bw;\n};\n/**\n * Will iterate through each transaction and return an array of hashes\n * @returns {Array} - An array with transaction hashes\n */\n\n\nBlock.prototype.getTransactionHashes = function getTransactionHashes() {\n  var hashes = [];\n\n  if (this.transactions.length === 0) {\n    return [Block.Values.NULL_HASH];\n  }\n\n  for (var t = 0; t < this.transactions.length; t++) {\n    hashes.push(this.transactions[t]._getHash());\n  }\n\n  return hashes;\n};\n/**\n * Will build a merkle tree of all the transactions, ultimately arriving at\n * a single point, the merkle root.\n * @link https://en.bitcoin.it/wiki/Protocol_specification#Merkle_Trees\n * @returns {Array} - An array with each level of the tree after the other.\n */\n\n\nBlock.prototype.getMerkleTree = function getMerkleTree() {\n  var tree = this.getTransactionHashes();\n  var j = 0;\n\n  for (var size = this.transactions.length; size > 1; size = Math.floor((size + 1) / 2)) {\n    for (var i = 0; i < size; i += 2) {\n      var i2 = Math.min(i + 1, size - 1);\n      var buf = Buffer.concat([tree[j + i], tree[j + i2]]);\n      tree.push(Hash.sha256sha256(buf));\n    }\n\n    j += size;\n  }\n\n  return tree;\n};\n/**\n * Calculates the merkleRoot from the transactions.\n * @returns {Buffer} - A buffer of the merkle root hash\n */\n\n\nBlock.prototype.getMerkleRoot = function getMerkleRoot() {\n  var tree = this.getMerkleTree();\n  return tree[tree.length - 1];\n};\n/**\n * Verifies that the transactions in the block match the header merkle root\n * @returns {Boolean} - If the merkle roots match\n */\n\n\nBlock.prototype.validMerkleRoot = function validMerkleRoot() {\n  var h = new BN(this.header.merkleRoot.toString('hex'), 'hex');\n  var c = new BN(this.getMerkleRoot().toString('hex'), 'hex');\n\n  if (h.cmp(c) !== 0) {\n    return false;\n  }\n\n  return true;\n};\n/**\n * @returns {Buffer} - The little endian hash buffer of the header\n */\n\n\nBlock.prototype._getHash = function () {\n  return this.header._getHash();\n};\n\nvar idProperty = {\n  configurable: false,\n  enumerable: true,\n\n  /**\n   * @returns {string} - The big endian hash buffer of the header\n   */\n  get: function () {\n    if (!this._id) {\n      this._id = this.header.id;\n    }\n\n    return this._id;\n  },\n  set: _.noop\n};\nObject.defineProperty(Block.prototype, 'id', idProperty);\nObject.defineProperty(Block.prototype, 'hash', idProperty);\n/**\n * @returns {string} - A string formatted for the console\n */\n\nBlock.prototype.inspect = function inspect() {\n  return '<Block ' + this.id + '>';\n};\n\nBlock.Values = {\n  START_OF_BLOCK: 8,\n  // Start buffer position in raw block data. (network magic (4 bytes BE) + block size (4 bytes LE))\n  NULL_HASH: Buffer.from('0000000000000000000000000000000000000000000000000000000000000000', 'hex')\n};\nmodule.exports = Block;","map":{"version":3,"names":["_","require","BlockHeader","BN","BufferUtil","BufferReader","BufferWriter","Hash","Transaction","$","Networks","Block","arg","extend","_from","MAX_BLOCK_SIZE","info","isBuffer","_fromBufferReader","isObject","_fromObject","TypeError","data","transactions","forEach","tx","push","fromObject","header","obj","br","checkState","finished","fromBufferReader","readVarintNum","i","checkArgument","fromBuffer","buf","fromString","str","Buffer","from","fromRawBlock","verify","magic","size","pos","Values","START_OF_BLOCK","readUInt32BE","readUInt32LE","get","block","toBuffer","length","prototype","toObject","toJSON","toBufferWriter","concat","toString","bw","write","writeVarintNum","getTransactionHashes","hashes","NULL_HASH","t","_getHash","getMerkleTree","tree","j","Math","floor","i2","min","sha256sha256","getMerkleRoot","validMerkleRoot","h","merkleRoot","c","cmp","idProperty","configurable","enumerable","_id","id","set","noop","Object","defineProperty","inspect","module","exports"],"sources":["C:/Users/acer/node_modules/bitcore-lib-ltc/lib/block/block.js"],"sourcesContent":["'use strict';\n\nvar _ = require('lodash');\nvar BlockHeader = require('./blockheader');\nvar BN = require('../crypto/bn');\nvar BufferUtil = require('../util/buffer');\nvar BufferReader = require('../encoding/bufferreader');\nvar BufferWriter = require('../encoding/bufferwriter');\nvar Hash = require('../crypto/hash');\nvar Transaction = require('../transaction');\nvar $ = require('../util/preconditions');\nconst Networks = require('../networks');\n\n/**\n * Instantiate a Block from a Buffer, JSON object, or Object with\n * the properties of the Block\n *\n * @param {*} - A Buffer, JSON string, or Object\n * @returns {Block}\n * @constructor\n */\nfunction Block(arg) {\n  if (!(this instanceof Block)) {\n    return new Block(arg);\n  }\n  _.extend(this, Block._from(arg));\n  return this;\n}\n\n// https://github.com/bitcoin/bitcoin/blob/b5fa132329f0377d787a4a21c1686609c2bfaece/src/primitives/block.h#L14\nBlock.MAX_BLOCK_SIZE = 1000000;\n\n/**\n * @param {*} - A Buffer, JSON string or Object\n * @returns {Object} - An object representing block data\n * @throws {TypeError} - If the argument was not recognized\n * @private\n */\nBlock._from = function _from(arg) {\n  var info = {};\n  if (BufferUtil.isBuffer(arg)) {\n    info = Block._fromBufferReader(BufferReader(arg));\n  } else if (_.isObject(arg)) {\n    info = Block._fromObject(arg);\n  } else {\n    throw new TypeError('Unrecognized argument for Block');\n  }\n  return info;\n};\n\n/**\n * @param {Object} - A plain JavaScript object\n * @returns {Object} - An object representing block data\n * @private\n */\nBlock._fromObject = function _fromObject(data) {\n  var transactions = [];\n  data.transactions.forEach(function(tx) {\n    if (tx instanceof Transaction) {\n      transactions.push(tx);\n    } else {\n      transactions.push(Transaction().fromObject(tx));\n    }\n  });\n  var info = {\n    header: BlockHeader.fromObject(data.header),\n    transactions: transactions\n  };\n  return info;\n};\n\n/**\n * @param {Object} - A plain JavaScript object\n * @returns {Block} - An instance of block\n */\nBlock.fromObject = function fromObject(obj) {\n  var info = Block._fromObject(obj);\n  return new Block(info);\n};\n\n/**\n * @param {BufferReader} - Block data\n * @returns {Object} - An object representing the block data\n * @private\n */\nBlock._fromBufferReader = function _fromBufferReader(br) {\n  var info = {};\n  $.checkState(!br.finished(), 'No block data received');\n  info.header = BlockHeader.fromBufferReader(br);\n  var transactions = br.readVarintNum();\n  info.transactions = [];\n  for (var i = 0; i < transactions; i++) {\n    info.transactions.push(Transaction().fromBufferReader(br));\n  }\n  return info;\n};\n\n/**\n * @param {BufferReader} - A buffer reader of the block\n * @returns {Block} - An instance of block\n */\nBlock.fromBufferReader = function fromBufferReader(br) {\n  $.checkArgument(br, 'br is required');\n  var info = Block._fromBufferReader(br);\n  return new Block(info);\n};\n\n/**\n * @param {Buffer} - A buffer of the block\n * @returns {Block} - An instance of block\n */\nBlock.fromBuffer = function fromBuffer(buf) {\n  return Block.fromBufferReader(new BufferReader(buf));\n};\n\n/**\n * @param {string} - str - A hex encoded string of the block\n * @returns {Block} - A hex encoded string of the block\n */\nBlock.fromString = function fromString(str) {\n  var buf = Buffer.from(str, 'hex');\n  return Block.fromBuffer(buf);\n};\n\n/**\n * Method to decode blocks read directly from the .dat block files\n * @param {Binary} - Raw block binary data or buffer\n * @param {Boolean} - (optional. Default = false) Verify block decoding\n * @returns {Block} - An instance of block\n */\nBlock.fromRawBlock = function fromRawBlock(data, verify = false) {\n  if (!BufferUtil.isBuffer(data)) {\n    data = Buffer.from(data, 'binary');\n  }\n\n  const br = BufferReader(data);\n  let magic, size;\n\n  if (!verify) {\n    br.pos = Block.Values.START_OF_BLOCK;\n  } else {\n    magic = br.readUInt32BE();\n    size = br.readUInt32LE();\n    $.checkState(Networks.get(magic), 'Invalid network');\n  }\n\n  const info = Block._fromBufferReader(br);\n  const block = new Block(info);\n\n  $.checkState(!verify || block.toBuffer().length === size, 'Decoding of block failed. Expected block size of ' + size);\n  return block;\n};\n\n/**\n * @returns {Object} - A plain object with the block properties\n */\nBlock.prototype.toObject = Block.prototype.toJSON = function toObject() {\n  var transactions = [];\n  this.transactions.forEach(function(tx) {\n    transactions.push(tx.toObject());\n  });\n  return {\n    header: this.header.toObject(),\n    transactions: transactions\n  };\n};\n\n/**\n * @returns {Buffer} - A buffer of the block\n */\nBlock.prototype.toBuffer = function toBuffer() {\n  return this.toBufferWriter().concat();\n};\n\n/**\n * @returns {string} - A hex encoded string of the block\n */\nBlock.prototype.toString = function toString() {\n  return this.toBuffer().toString('hex');\n};\n\n/**\n * @param {BufferWriter} - An existing instance of BufferWriter\n * @returns {BufferWriter} - An instance of BufferWriter representation of the Block\n */\nBlock.prototype.toBufferWriter = function toBufferWriter(bw) {\n  if (!bw) {\n    bw = new BufferWriter();\n  }\n  bw.write(this.header.toBuffer());\n  bw.writeVarintNum(this.transactions.length);\n  for (var i = 0; i < this.transactions.length; i++) {\n    this.transactions[i].toBufferWriter(bw);\n  }\n  return bw;\n};\n\n/**\n * Will iterate through each transaction and return an array of hashes\n * @returns {Array} - An array with transaction hashes\n */\nBlock.prototype.getTransactionHashes = function getTransactionHashes() {\n  var hashes = [];\n  if (this.transactions.length === 0) {\n    return [Block.Values.NULL_HASH];\n  }\n  for (var t = 0; t < this.transactions.length; t++) {\n    hashes.push(this.transactions[t]._getHash());\n  }\n  return hashes;\n};\n\n/**\n * Will build a merkle tree of all the transactions, ultimately arriving at\n * a single point, the merkle root.\n * @link https://en.bitcoin.it/wiki/Protocol_specification#Merkle_Trees\n * @returns {Array} - An array with each level of the tree after the other.\n */\nBlock.prototype.getMerkleTree = function getMerkleTree() {\n\n  var tree = this.getTransactionHashes();\n\n  var j = 0;\n  for (var size = this.transactions.length; size > 1; size = Math.floor((size + 1) / 2)) {\n    for (var i = 0; i < size; i += 2) {\n      var i2 = Math.min(i + 1, size - 1);\n      var buf = Buffer.concat([tree[j + i], tree[j + i2]]);\n      tree.push(Hash.sha256sha256(buf));\n    }\n    j += size;\n  }\n\n  return tree;\n};\n\n/**\n * Calculates the merkleRoot from the transactions.\n * @returns {Buffer} - A buffer of the merkle root hash\n */\nBlock.prototype.getMerkleRoot = function getMerkleRoot() {\n  var tree = this.getMerkleTree();\n  return tree[tree.length - 1];\n};\n\n/**\n * Verifies that the transactions in the block match the header merkle root\n * @returns {Boolean} - If the merkle roots match\n */\nBlock.prototype.validMerkleRoot = function validMerkleRoot() {\n\n  var h = new BN(this.header.merkleRoot.toString('hex'), 'hex');\n  var c = new BN(this.getMerkleRoot().toString('hex'), 'hex');\n\n  if (h.cmp(c) !== 0) {\n    return false;\n  }\n\n  return true;\n};\n\n/**\n * @returns {Buffer} - The little endian hash buffer of the header\n */\nBlock.prototype._getHash = function() {\n  return this.header._getHash();\n};\n\nvar idProperty = {\n  configurable: false,\n  enumerable: true,\n  /**\n   * @returns {string} - The big endian hash buffer of the header\n   */\n  get: function() {\n    if (!this._id) {\n      this._id = this.header.id;\n    }\n    return this._id;\n  },\n  set: _.noop\n};\nObject.defineProperty(Block.prototype, 'id', idProperty);\nObject.defineProperty(Block.prototype, 'hash', idProperty);\n\n/**\n * @returns {string} - A string formatted for the console\n */\nBlock.prototype.inspect = function inspect() {\n  return '<Block ' + this.id + '>';\n};\n\nBlock.Values = {\n  START_OF_BLOCK: 8, // Start buffer position in raw block data. (network magic (4 bytes BE) + block size (4 bytes LE))\n  NULL_HASH: Buffer.from('0000000000000000000000000000000000000000000000000000000000000000', 'hex')\n};\n\nmodule.exports = Block;\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}